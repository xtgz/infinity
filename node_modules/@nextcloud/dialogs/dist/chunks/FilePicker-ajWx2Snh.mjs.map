{"version":3,"file":"FilePicker-ajWx2Snh.mjs","sources":["../../node_modules/vue-material-design-icons/File.vue","../../lib/composables/filesSettings.ts","../../node_modules/vue-material-design-icons/MenuUp.vue","../../node_modules/vue-material-design-icons/MenuDown.vue","../../lib/utils/imagePreload.ts","../../lib/composables/preview.ts","../../node_modules/vue-material-design-icons/Folder.vue","../../lib/components/FilePicker/FilePreview.vue","../../lib/components/FilePicker/FileListRow.vue","../../lib/components/FilePicker/FileList.vue","../../node_modules/vue-material-design-icons/Home.vue","../../node_modules/vue-material-design-icons/Plus.vue","../../lib/components/FilePicker/FilePickerBreadcrumbs.vue","../../node_modules/vue-material-design-icons/Close.vue","../../node_modules/vue-material-design-icons/Magnify.vue","../../lib/composables/views.ts","../../lib/components/FilePicker/FilePickerNavigation.vue","../../lib/composables/dav.ts","../../lib/composables/mime.ts","../../lib/components/FilePicker/FilePicker.vue"],"sourcesContent":["<template>\n  <span v-bind=\"$attrs\"\n        :aria-hidden=\"title ? null : true\"\n        :aria-label=\"title\"\n        class=\"material-design-icon file-icon\"\n        role=\"img\"\n        @click=\"$emit('click', $event)\">\n    <svg :fill=\"fillColor\"\n         class=\"material-design-icon__svg\"\n         :width=\"size\"\n         :height=\"size\"\n         viewBox=\"0 0 24 24\">\n      <path d=\"M13,9V3.5L18.5,9M6,2C4.89,2 4,2.89 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2H6Z\">\n        <title v-if=\"title\">{{ title }}</title>\n      </path>\n    </svg>\n  </span>\n</template>\n\n<script>\nexport default {\n  name: \"FileIcon\",\n  emits: ['click'],\n  props: {\n    title: {\n      type: String,\n    },\n    fillColor: {\n      type: String,\n      default: \"currentColor\"\n    },\n    size: {\n      type: Number,\n      default: 24\n    }\n  }\n}\n</script>","/**\n * SPDX-FileCopyrightText: 2023 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\n\nimport type { ComputedRef, Ref } from 'vue'\n\nimport { loadState } from '@nextcloud/initial-state'\nimport { generateUrl } from '@nextcloud/router'\nimport { isPublicShare } from '@nextcloud/sharing/public'\nimport { toValue } from '@vueuse/core'\nimport { computed, onMounted, ref } from 'vue'\n\nimport axios from '@nextcloud/axios'\n\nimport { t } from '../utils/l10n'\nimport { showError } from '../toast'\n\ninterface OCAFilesUserConfig {\n\tshow_hidden: boolean\n\tcrop_image_previews: boolean\n\tsort_favorites_first: boolean\n}\n\ninterface OCAFilesView {\n\tsorting_direction: 'asc'|'desc'\n\tsorting_mode: 'basename'|'size'|'mtime'\n}\n\ninterface OCAFilesViewConfig {\n\t[view: string]: OCAFilesView\n}\n\ninterface ViewConfig {\n\tsortBy: 'basename'|'size'|'mtime'\n\torder: 'ascending'|'descending'|'none'\n}\n\nexport type FileListViews = 'files'|'recent'|'favorites'\n\n/**\n * Composable to get the files app settings\n * (show hidden files, sort favorites, crop previews)\n */\nexport const useFilesSettings = () => {\n\tconst filesUserState = loadState<OCAFilesUserConfig|null>('files', 'config', null)\n\n\tconst showHiddenFiles = ref(filesUserState?.show_hidden ?? true)\n\tconst sortFavoritesFirst = ref(filesUserState?.sort_favorites_first ?? true)\n\tconst cropImagePreviews = ref(filesUserState?.crop_image_previews ?? true)\n\n\tonMounted(async () => {\n\t\tif (!isPublicShare()) {\n\t\t\ttry {\n\t\t\t\tconst { data } = await axios.get(generateUrl('/apps/files/api/v1/configs'))\n\n\t\t\t\tshowHiddenFiles.value = data?.data?.show_hidden ?? false\n\t\t\t\tsortFavoritesFirst.value = data?.data?.sort_favorites_first ?? true\n\t\t\t\tcropImagePreviews.value = data?.data?.crop_image_previews ?? true\n\t\t\t} catch (error) {\n\t\t\t\tconsole.error('Could not load files settings', error)\n\t\t\t\tshowError(t('Could not load files settings'))\n\t\t\t}\n\t\t} else {\n\t\t\tconsole.debug('Skip loading files settings - currently on public share')\n\t\t}\n\t})\n\n\treturn {\n\t\tshowHiddenFiles,\n\t\tsortFavoritesFirst,\n\t\tcropImagePreviews,\n\t}\n}\n\n/**\n * Composable to get the files app view configs for sorting the files list\n * @param currentView the currently active view\n */\nexport const useFilesViews = (currentView?: FileListViews|Ref<FileListViews>|ComputedRef<FileListViews>) => {\n\tconst convertOrder = (order?: string) => order === 'asc' ? 'ascending' : (order === 'desc' ? 'descending' : 'none')\n\n\tconst filesViewsState = loadState<OCAFilesViewConfig|null>('files', 'viewConfigs', null)\n\n\tconst filesViewConfig = ref<ViewConfig>({\n\t\tsortBy: filesViewsState?.files?.sorting_mode ?? 'basename',\n\t\torder: convertOrder(filesViewsState?.files?.sorting_direction ?? 'asc'),\n\t})\n\tconst recentViewConfig = ref<ViewConfig>({\n\t\tsortBy: filesViewsState?.recent?.sorting_mode ?? 'basename',\n\t\torder: convertOrder(filesViewsState?.recent?.sorting_direction ?? 'asc'),\n\t})\n\tconst favoritesViewConfig = ref<ViewConfig>({\n\t\tsortBy: filesViewsState?.favorites?.sorting_mode ?? 'basename',\n\t\torder: convertOrder(filesViewsState?.favorites?.sorting_direction ?? 'asc'),\n\t})\n\n\tonMounted(async () => {\n\t\tif (!isPublicShare()) {\n\t\t\ttry {\n\t\t\t\tconst { data } = await axios.get(generateUrl('/apps/files/api/v1/views'))\n\t\t\t\tfilesViewConfig.value = {\n\t\t\t\t\tsortBy: data?.data?.files?.sorting_mode ?? 'basename',\n\t\t\t\t\torder: convertOrder(data?.data?.files?.sorting_direction),\n\t\t\t\t}\n\t\t\t\tfavoritesViewConfig.value = {\n\t\t\t\t\tsortBy: data?.data?.favorites?.sorting_mode ?? 'basename',\n\t\t\t\t\torder: convertOrder(data?.data?.favorites?.sorting_direction),\n\t\t\t\t}\n\t\t\t\trecentViewConfig.value = {\n\t\t\t\t\tsortBy: data?.data?.recent?.sorting_mode ?? 'basename',\n\t\t\t\t\torder: convertOrder(data?.data?.recent?.sorting_direction),\n\t\t\t\t}\n\t\t\t} catch (error) {\n\t\t\t\tconsole.error('Could not load files views', error)\n\t\t\t\tshowError(t('Could not load files views'))\n\t\t\t}\n\t\t} else {\n\t\t\tconsole.debug('Skip loading files views - currently on public share')\n\t\t}\n\t})\n\n\tconst currentConfig = computed(() => toValue(currentView || 'files') === 'files' ? filesViewConfig.value : (toValue(currentView) === 'recent' ? recentViewConfig.value : favoritesViewConfig.value))\n\tconst sortBy = computed(() => currentConfig.value.sortBy)\n\tconst order = computed(() => currentConfig.value.order)\n\n\treturn {\n\t\tfilesViewConfig,\n\t\tfavoritesViewConfig,\n\t\trecentViewConfig,\n\t\tcurrentConfig,\n\t\tsortBy,\n\t\torder,\n\t}\n}\n","<template>\n  <span v-bind=\"$attrs\"\n        :aria-hidden=\"title ? null : true\"\n        :aria-label=\"title\"\n        class=\"material-design-icon menu-up-icon\"\n        role=\"img\"\n        @click=\"$emit('click', $event)\">\n    <svg :fill=\"fillColor\"\n         class=\"material-design-icon__svg\"\n         :width=\"size\"\n         :height=\"size\"\n         viewBox=\"0 0 24 24\">\n      <path d=\"M7,15L12,10L17,15H7Z\">\n        <title v-if=\"title\">{{ title }}</title>\n      </path>\n    </svg>\n  </span>\n</template>\n\n<script>\nexport default {\n  name: \"MenuUpIcon\",\n  emits: ['click'],\n  props: {\n    title: {\n      type: String,\n    },\n    fillColor: {\n      type: String,\n      default: \"currentColor\"\n    },\n    size: {\n      type: Number,\n      default: 24\n    }\n  }\n}\n</script>","<template>\n  <span v-bind=\"$attrs\"\n        :aria-hidden=\"title ? null : true\"\n        :aria-label=\"title\"\n        class=\"material-design-icon menu-down-icon\"\n        role=\"img\"\n        @click=\"$emit('click', $event)\">\n    <svg :fill=\"fillColor\"\n         class=\"material-design-icon__svg\"\n         :width=\"size\"\n         :height=\"size\"\n         viewBox=\"0 0 24 24\">\n      <path d=\"M7,10L12,15L17,10H7Z\">\n        <title v-if=\"title\">{{ title }}</title>\n      </path>\n    </svg>\n  </span>\n</template>\n\n<script>\nexport default {\n  name: \"MenuDownIcon\",\n  emits: ['click'],\n  props: {\n    title: {\n      type: String,\n    },\n    fillColor: {\n      type: String,\n      default: \"currentColor\"\n    },\n    size: {\n      type: Number,\n      default: 24\n    }\n  }\n}\n</script>","/**\n * SPDX-FileCopyrightText: 2024 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\n\nimport PQueue from 'p-queue'\n\nconst queue = new PQueue({ concurrency: 5 })\n\n/**\n * Preload an image URL\n * @param url URL of the image\n */\nexport function preloadImage(url: string): Promise<boolean> {\n\tconst { resolve, promise } = Promise.withResolvers<boolean>()\n\tqueue.add(() => {\n\t\tconst image = new Image()\n\t\timage.onerror = () => resolve(false)\n\t\timage.onload = () => resolve(true)\n\t\timage.src = url\n\t\treturn promise\n\t})\n\n\treturn promise\n}\n","/**\n * SPDX-FileCopyrightText: 2023 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\n\nimport type { Node } from '@nextcloud/files'\nimport type { MaybeRef } from '@vueuse/core'\nimport type { Ref } from 'vue'\n\nimport { generateUrl } from '@nextcloud/router'\nimport { toValue } from '@vueuse/core'\nimport { ref, watchEffect } from 'vue'\nimport { preloadImage } from '../utils/imagePreload'\n\ninterface PreviewOptions {\n\t/**\n\t * Size of the previews in px\n\t * @default 32\n\t */\n\tsize?: number\n\t/**\n\t * Should the preview fall back to the mime type icon\n\t * @default true\n\t */\n\tmimeFallback?: boolean\n\t/**\n\t * Should the preview be cropped or fitted\n\t * @default false (meaning it gets fitted)\n\t */\n\tcropPreview?: boolean\n}\n\n/**\n * Generate the preview URL of a file node\n *\n * @param node The node to generate the preview for\n * @param options Preview options\n */\nexport function getPreviewURL(node: Node, options: PreviewOptions = {}) {\n\toptions = { size: 32, cropPreview: false, mimeFallback: true, ...options }\n\n\ttry {\n\t\tconst previewUrl = node.attributes?.previewUrl\n\t\t\t|| generateUrl('/core/preview?fileId={fileid}', {\n\t\t\t\tfileid: node.fileid,\n\t\t\t})\n\n\t\tlet url\n\t\ttry {\n\t\t\turl = new URL(previewUrl)\n\t\t} catch (e) {\n\t\t\turl = new URL(previewUrl, window.location.origin)\n\t\t}\n\n\t\t// Request preview with params\n\t\turl.searchParams.set('x', `${options.size}`)\n\t\turl.searchParams.set('y', `${options.size}`)\n\t\turl.searchParams.set('mimeFallback', `${options.mimeFallback}`)\n\n\t\t// Handle cropping\n\t\turl.searchParams.set('a', options.cropPreview === true ? '0' : '1')\n\n\t\t// cache busting\n\t\turl.searchParams.set('c', `${node.attributes.etag}`)\n\t\treturn url\n\t} catch (e) {\n\t\treturn null\n\t}\n}\n\nexport const usePreviewURL = (node: Node | Ref<Node>, options?: MaybeRef<PreviewOptions>) => {\n\tconst previewURL = ref<URL|null>(null)\n\tconst previewLoaded = ref(false)\n\n\twatchEffect(() => {\n\t\tpreviewLoaded.value = false\n\t\tpreviewURL.value = getPreviewURL(toValue(node), toValue(options || {}))\n\t\tif (previewURL.value) {\n\t\t\tpreloadImage(previewURL.value.href).then((success: boolean) => {\n\t\t\t\tpreviewLoaded.value = success\n\t\t\t})\n\t\t}\n\t})\n\n\treturn {\n\t\tpreviewURL,\n\t\tpreviewLoaded,\n\t}\n}\n","<template>\n  <span v-bind=\"$attrs\"\n        :aria-hidden=\"title ? null : true\"\n        :aria-label=\"title\"\n        class=\"material-design-icon folder-icon\"\n        role=\"img\"\n        @click=\"$emit('click', $event)\">\n    <svg :fill=\"fillColor\"\n         class=\"material-design-icon__svg\"\n         :width=\"size\"\n         :height=\"size\"\n         viewBox=\"0 0 24 24\">\n      <path d=\"M10,4H4C2.89,4 2,4.89 2,6V18A2,2 0 0,0 4,20H20A2,2 0 0,0 22,18V8C22,6.89 21.1,6 20,6H12L10,4Z\">\n        <title v-if=\"title\">{{ title }}</title>\n      </path>\n    </svg>\n  </span>\n</template>\n\n<script>\nexport default {\n  name: \"FolderIcon\",\n  emits: ['click'],\n  props: {\n    title: {\n      type: String,\n    },\n    fillColor: {\n      type: String,\n      default: \"currentColor\"\n    },\n    size: {\n      type: Number,\n      default: 24\n    }\n  }\n}\n</script>","<!--\n  - SPDX-FileCopyrightText: 2023-2024 Nextcloud GmbH and Nextcloud contributors\n  - SPDX-License-Identifier: AGPL-3.0-or-later\n-->\n<template>\n\t<div :style=\"previewLoaded ? { backgroundImage: `url(${previewURL})`} : undefined\"\n\t\t:class=\"fileListIconStyles['file-picker__file-icon']\">\n\t\t<template v-if=\"!previewLoaded\">\n\t\t\t<IconFile v-if=\"isFile\" :size=\"20\" />\n\t\t\t<IconFolder v-else :size=\"20\" />\n\t\t</template>\n\t</div>\n</template>\n\n<script setup lang=\"ts\">\nimport { FileType, type Node } from '@nextcloud/files'\nimport { computed, ref, toRef } from 'vue'\nimport { usePreviewURL } from '../../composables/preview'\n\nimport IconFile from 'vue-material-design-icons/File.vue'\nimport IconFolder from 'vue-material-design-icons/Folder.vue'\n\n// CSS modules\nimport fileListIconStylesModule from './FileListIcon.module.scss'\n\n// workaround for vue2.7 bug, can be removed with vue3\nconst fileListIconStyles = ref(fileListIconStylesModule)\n\nconst props = defineProps<{\n\tnode: Node\n\tcropImagePreviews: boolean\n}>()\n\nconst {\n\tpreviewURL,\n\tpreviewLoaded,\n} = usePreviewURL(toRef(props, 'node'), computed(() => ({ cropPreview: props.cropImagePreviews })))\n\nconst isFile = computed(() => props.node.type === FileType.File)\n</script>\n\n<script lang=\"ts\">\nexport default {\n\tname: 'FilePreview',\n}\n</script>\n","<!--\n  - SPDX-FileCopyrightText: 2023-2024 Nextcloud GmbH and Nextcloud contributors\n  - SPDX-License-Identifier: AGPL-3.0-or-later\n-->\n<template>\n\t<tr :tabindex=\"(showCheckbox && !isDirectory) ? undefined : 0\"\n\t\t:aria-selected=\"!isPickable ? undefined : selected\"\n\t\t:class=\"['file-picker__row', {\n\t\t\t'file-picker__row--selected': selected && !showCheckbox\n\t\t}]\"\n\t\t:data-filename=\"node.basename\"\n\t\tdata-testid=\"file-list-row\"\n\t\tv-on=\"{\n\t\t\tclick: handleClick,\n\t\t\t/* same as tabindex -> if we hide the checkbox or this is a directory we need keyboard access to enter the directory or select the node */\n\t\t\t...(!showCheckbox || isDirectory ? { keydown: handleKeyDown } : {}),\n\t\t}\">\n\t\t<td v-if=\"showCheckbox\" class=\"row-checkbox\" @click.stop=\"() => {/* Stop the click event */}\">\n\t\t\t<NcCheckboxRadioSwitch :aria-label=\"t('Select the row for {nodename}', { nodename: displayName })\"\n\t\t\t\t:checked=\"selected\"\n\t\t\t\t:disabled=\"!isPickable\"\n\t\t\t\tdata-testid=\"row-checkbox\"\n\t\t\t\t@update:checked=\"toggleSelected\" />\n\t\t</td>\n\t\t<td class=\"row-name\">\n\t\t\t<div class=\"file-picker__name-container\" data-testid=\"row-name\">\n\t\t\t\t<FilePreview :node=\"node\" :crop-image-previews=\"cropImagePreviews\" />\n\t\t\t\t<div class=\"file-picker__file-name\" :title=\"displayName\" v-text=\"displayName\" />\n\t\t\t\t<div class=\"file-picker__file-extension\" v-text=\"fileExtension\" />\n\t\t\t</div>\n\t\t</td>\n\t\t<td class=\"row-size\">\n\t\t\t{{ formatFileSize(node.size || 0) }}\n\t\t</td>\n\t\t<td class=\"row-modified\">\n\t\t\t<NcDateTime :timestamp=\"node.mtime\" :ignore-seconds=\"true\" />\n\t\t</td>\n\t</tr>\n</template>\n<script setup lang=\"ts\">\nimport type { Node } from '@nextcloud/files'\n\nimport { formatFileSize, FileType } from '@nextcloud/files'\nimport { NcCheckboxRadioSwitch, NcDateTime } from '@nextcloud/vue'\nimport { computed } from 'vue'\nimport { t } from '../../utils/l10n'\n\nimport FilePreview from './FilePreview.vue'\n\nconst props = defineProps<{\n\t/** Can directories be picked */\n\tallowPickDirectory: boolean\n\t/** Is this node currently selected */\n\tselected: boolean\n\t/** Whether to show the checkbox in first column */\n\tshowCheckbox: boolean\n\t/** Whether the node can be picked */\n\tcanPick: boolean\n\t/** The current node */\n\tnode: Node\n\t/** Whether the preview should be cropped */\n\tcropImagePreviews: boolean\n}>()\n\nconst emit = defineEmits<{\n\t/** Emitted when the selected state is changed */\n\t(e: 'update:selected', v: boolean): void\n\t/** Emitted when a directory was not selected but entered */\n\t(e: 'enter-directory', node: Node): void\n}>()\n\n/**\n * The displayname of the current node (excluding file extension)\n */\nconst displayName = computed(() => props.node.attributes?.displayName || props.node.basename.slice(0, props.node.extension ? -props.node.extension.length : undefined))\n\n/**\n * The file extension of the file\n */\nconst fileExtension = computed(() => props.node.extension)\n\n/**\n * Check if the node is a directory\n */\nconst isDirectory = computed(() => props.node.type === FileType.Folder)\n\n/**\n * If this node can be picked, basically just check if picking a directory is allowed\n */\nconst isPickable = computed(() => props.canPick && (props.allowPickDirectory || !isDirectory.value))\n\n/**\n * Toggle the selection state\n */\nfunction toggleSelected() {\n\temit('update:selected', !props.selected)\n}\n\n/**\n * Handle clicking the table row, if it is a directory it is opened, else selected\n */\nfunction handleClick() {\n\tif (isDirectory.value) {\n\t\temit('enter-directory', props.node)\n\t} else {\n\t\ttoggleSelected()\n\t}\n}\n\n/**\n * Handle keydown on the table row, pressing the enter key will be similar to clicking for keyboard navigation\n * @param event The Keydown event\n */\nfunction handleKeyDown(event: KeyboardEvent) {\n\tif (event.key === 'Enter') {\n\t\thandleClick()\n\t}\n}\n</script>\n\n<style scoped lang=\"scss\">\n@use './FileList.scss';\n\n.file-picker {\n\t&__row {\n\t\t&--selected {\n\t\t\tbackground-color: var(--color-background-dark);\n\t\t}\n\t\t&:hover {\n\t\t\tbackground-color: var(--color-background-hover);\n\t\t}\n\t}\n\n\t&__name-container {\n\t\tdisplay: flex;\n\t\tjustify-content: start;\n\t\talign-items: center;\n\t\theight: 100%;\n\t}\n\n\t&__file-name {\n\t\tpadding-inline-start: 6px;\n\t\tmin-width: 0;\n\t\toverflow: hidden;\n\t\ttext-overflow: ellipsis;\n\t}\n\n\t&__file-extension {\n\t\tcolor: var(--color-text-maxcontrast);\n\t\tmin-width: fit-content;\n\t}\n}\n</style>\n","<!--\n  - SPDX-FileCopyrightText: 2020-2024 Nextcloud GmbH and Nextcloud contributors\n  - SPDX-License-Identifier: AGPL-3.0-or-later\n-->\n<template>\n\t<div ref=\"fileContainer\" class=\"file-picker__files\">\n\t\t<table>\n\t\t\t<thead>\n\t\t\t\t<tr>\n\t\t\t\t\t<th v-if=\"multiselect\" class=\"row-checkbox\">\n\t\t\t\t\t\t<span class=\"hidden-visually\">\n\t\t\t\t\t\t\t{{ t('Select entry') }}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<NcCheckboxRadioSwitch v-if=\"multiselect\"\n\t\t\t\t\t\t\t:aria-label=\"t('Select all entries')\"\n\t\t\t\t\t\t\t:checked=\"allSelected\"\n\t\t\t\t\t\t\tdata-testid=\"select-all-checkbox\"\n\t\t\t\t\t\t\t@update:checked=\"onSelectAll\" />\n\t\t\t\t\t</th>\n\t\t\t\t\t<th :aria-sort=\"sortByName\" class=\"row-name\">\n\t\t\t\t\t\t<div class=\"header-wrapper\">\n\t\t\t\t\t\t\t<span class=\"file-picker__header-preview\" />\n\t\t\t\t\t\t\t<NcButton :wide=\"true\"\n\t\t\t\t\t\t\t\ttype=\"tertiary\"\n\t\t\t\t\t\t\t\tdata-test=\"file-picker_sort-name\"\n\t\t\t\t\t\t\t\t@click=\"toggleSorting('basename')\">\n\t\t\t\t\t\t\t\t<template #icon>\n\t\t\t\t\t\t\t\t\t<IconSortAscending v-if=\"sortByName === 'ascending'\" :size=\"20\" />\n\t\t\t\t\t\t\t\t\t<IconSortDescending v-else-if=\"sortByName === 'descending'\" :size=\"20\" />\n\t\t\t\t\t\t\t\t\t<span v-else style=\"width: 44px\" />\n\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t{{ t('Name') }}\n\t\t\t\t\t\t\t</NcButton>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</th>\n\t\t\t\t\t<th :aria-sort=\"sortBySize\" class=\"row-size\">\n\t\t\t\t\t\t<NcButton :wide=\"true\" type=\"tertiary\" @click=\"toggleSorting('size')\">\n\t\t\t\t\t\t\t<template #icon>\n\t\t\t\t\t\t\t\t<IconSortAscending v-if=\"sortBySize === 'ascending'\" :size=\"20\" />\n\t\t\t\t\t\t\t\t<IconSortDescending v-else-if=\"sortBySize === 'descending'\" :size=\"20\" />\n\t\t\t\t\t\t\t\t<span v-else style=\"width: 44px\" />\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t{{ t('Size') }}\n\t\t\t\t\t\t</NcButton>\n\t\t\t\t\t</th>\n\t\t\t\t\t<th :aria-sort=\"sortByModified\" class=\"row-modified\">\n\t\t\t\t\t\t<NcButton :wide=\"true\" type=\"tertiary\" @click=\"toggleSorting('mtime')\">\n\t\t\t\t\t\t\t<template #icon>\n\t\t\t\t\t\t\t\t<IconSortAscending v-if=\"sortByModified === 'ascending'\" :size=\"20\" />\n\t\t\t\t\t\t\t\t<IconSortDescending v-else-if=\"sortByModified === 'descending'\" :size=\"20\" />\n\t\t\t\t\t\t\t\t<span v-else style=\"width: 44px\" />\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t{{ t('Modified') }}\n\t\t\t\t\t\t</NcButton>\n\t\t\t\t\t</th>\n\t\t\t\t</tr>\n\t\t\t</thead>\n\t\t\t<tbody>\n\t\t\t\t<template v-if=\"loading\">\n\t\t\t\t\t<LoadingTableRow v-for=\"index in skeletonNumber\" :key=\"index\" :show-checkbox=\"multiselect\" />\n\t\t\t\t</template>\n\t\t\t\t<template v-else>\n\t\t\t\t\t<FileListRow v-for=\"file of sortedFiles\"\n\t\t\t\t\t\t:key=\"file.fileid || file.path\"\n\t\t\t\t\t\t:allow-pick-directory=\"allowPickDirectory\"\n\t\t\t\t\t\t:show-checkbox=\"multiselect\"\n\t\t\t\t\t\t:can-pick=\"multiselect || selectedFiles.length === 0 || selectedFiles.includes(file)\"\n\t\t\t\t\t\t:selected=\"selectedFiles.includes(file)\"\n\t\t\t\t\t\t:node=\"file\"\n\t\t\t\t\t\t:crop-image-previews=\"cropImagePreviews\"\n\t\t\t\t\t\t@update:selected=\"onNodeSelected(file)\"\n\t\t\t\t\t\t@enter-directory=\"onChangeDirectory\" />\n\t\t\t\t</template>\n\t\t\t</tbody>\n\t\t</table>\n\t</div>\n</template>\n\n<script setup lang=\"ts\">\nimport type { Node } from '@nextcloud/files'\nimport type { FileListViews } from '../../composables/filesSettings'\n\nimport { FileType, FilesSortingMode, sortNodes } from '@nextcloud/files'\nimport { NcButton, NcCheckboxRadioSwitch } from '@nextcloud/vue'\nimport { computed, nextTick, onMounted, onUnmounted, ref } from 'vue'\nimport { useFilesSettings, useFilesViews } from '../../composables/filesSettings'\nimport { t } from '../../utils/l10n'\n\nimport IconSortAscending from 'vue-material-design-icons/MenuUp.vue'\nimport IconSortDescending from 'vue-material-design-icons/MenuDown.vue'\nimport LoadingTableRow from './LoadingTableRow.vue'\nimport FileListRow from './FileListRow.vue'\n\nconst props = defineProps<{\n\tcurrentView: FileListViews,\n\tmultiselect: boolean\n\tallowPickDirectory: boolean\n\tloading: boolean\n\tfiles: Node[]\n\tselectedFiles: Node[]\n\tpath: string\n}>()\n\nconst emit = defineEmits<{\n\t(e: 'update:path', path: string): void\n\t(e: 'update:selectedFiles', nodes: Node[]): void\n}>()\n\n/// sorting related stuff\n\ntype ISortingAttributes = 'basename' | 'size' | 'mtime'\ntype ISortingOrder = 'ascending' | 'descending' | 'none'\n\n/** Override files app sorting */\nconst customSortingConfig = ref<{ sortBy: ISortingAttributes, order: ISortingOrder }>()\n/** The current sorting of the files app */\nconst { currentConfig: filesAppSorting } = useFilesViews(props.currentView)\n/** Wrapper that uses custom sorting, but fallsback to the files app */\nconst sortingConfig = computed(() => customSortingConfig.value ?? filesAppSorting.value)\n\n// Some helpers for the template\nconst sortByName = computed(() => sortingConfig.value.sortBy === 'basename' ? (sortingConfig.value.order === 'none' ? undefined : sortingConfig.value.order) : undefined)\nconst sortBySize = computed(() => sortingConfig.value.sortBy === 'size' ? (sortingConfig.value.order === 'none' ? undefined : sortingConfig.value.order) : undefined)\nconst sortByModified = computed(() => sortingConfig.value.sortBy === 'mtime' ? (sortingConfig.value.order === 'none' ? undefined : sortingConfig.value.order) : undefined)\n\nconst toggleSorting = (sortBy: ISortingAttributes) => {\n\tif (sortingConfig.value.sortBy === sortBy) {\n\t\tif (sortingConfig.value.order === 'ascending') {\n\t\t\tcustomSortingConfig.value = { sortBy: sortingConfig.value.sortBy, order: 'descending' }\n\t\t} else {\n\t\t\tcustomSortingConfig.value = { sortBy: sortingConfig.value.sortBy, order: 'ascending' }\n\t\t}\n\t} else {\n\t\tcustomSortingConfig.value = { sortBy, order: 'ascending' }\n\t}\n}\n\nconst { sortFavoritesFirst, cropImagePreviews } = useFilesSettings()\n\n/**\n * Files sorted by columns\n */\nconst sortedFiles = computed(() => {\n\treturn sortNodes(props.files, {\n\t\tsortFoldersFirst: true,\n\t\tsortFavoritesFirst: sortFavoritesFirst.value,\n\t\tsortingOrder: sortingConfig.value.order === 'descending' ? 'desc' : 'asc',\n\t\tsortingMode: sortingConfig.value.sortBy as FilesSortingMode,\n\t})\n})\n\n/**\n * Contains the selectable files, filtering out directories if `allowPickDirectory` is not set\n */\nconst selectableFiles = computed(() => props.files.filter((file) => props.allowPickDirectory || file.type !== FileType.Folder))\n\n/**\n * Whether all selectable files are currently selected\n */\nconst allSelected = computed(() => !props.loading && props.selectedFiles.length > 0 && props.selectedFiles.length >= selectableFiles.value.length)\n\n/**\n * Handle the \"select all\" checkbox\n */\nfunction onSelectAll() {\n\tif (props.selectedFiles.length < selectableFiles.value.length) {\n\t\t// If not all selected, select all\n\t\temit('update:selectedFiles', selectableFiles.value)\n\t} else {\n\t\t// If already all selected, deselect all\n\t\temit('update:selectedFiles', [])\n\t}\n}\n\n/**\n * Handle selecting a node on the files list\n * @param file the selected node\n */\nfunction onNodeSelected(file: Node) {\n\tif (props.selectedFiles.includes(file)) {\n\t\temit('update:selectedFiles', props.selectedFiles.filter((f) => f.path !== file.path))\n\t} else {\n\t\tif (props.multiselect) {\n\t\t\temit('update:selectedFiles', [...props.selectedFiles, file])\n\t\t} else {\n\t\t\t// no multi select so only this file is selected\n\t\t\temit('update:selectedFiles', [file])\n\t\t}\n\t}\n}\n\n/**\n * Emit the new current path\n * @param dir The directory that is entered\n */\nfunction onChangeDirectory(dir: Node) {\n\temit('update:path', dir.path)\n}\n\n/**\n * Number of loading skeletons to use to fill the filepicker\n */\nconst skeletonNumber = ref(4)\nconst fileContainer = ref<HTMLDivElement>()\n{\n\tconst resize = () => nextTick(() => {\n\t\tconst nodes = fileContainer.value?.parentElement?.children || []\n\t\tlet height = fileContainer.value?.parentElement?.clientHeight || 450\n\t\tfor (let index = 0; index < nodes.length; index++) {\n\t\t\tif (!fileContainer.value?.isSameNode(nodes[index])) {\n\t\t\t\theight -= nodes[index].clientHeight\n\t\t\t}\n\t\t}\n\t\t// container height - 50px table header / row height of 50px\n\t\tskeletonNumber.value = Math.max(1, Math.floor((height - 50) / 50))\n\t})\n\tonMounted(() => {\n\t\twindow.addEventListener('resize', resize)\n\t\tresize()\n\t})\n\tonUnmounted(() => {\n\t\twindow.removeEventListener('resize', resize)\n\t})\n}\n</script>\n\n<style scoped lang=\"scss\">\n.file-picker {\n\t&__header-preview {\n\t\twidth: 22px; // 32px - 16px padding of button + 6px padding in file list rows\n\t\theight: 32px;\n\t\tflex: 0 0 auto; // do not shrink or grow\n\t}\n\n\t&__files {\n\t\t// ensure focus outlines are visible\n\t\tmargin: 2px;\n\t\tmargin-inline-start: 12px; // align with bread crumbs\n\t\toverflow: scroll auto;\n\n\t\ttable {\n\t\t\twidth: 100%;\n\t\t\tmax-height: 100%;\n\t\t\ttable-layout: fixed;\n\t\t}\n\t\tth {\n\t\t\tposition: sticky;\n\t\t\tz-index: 1; // show on top of scrolled content rows\n\t\t\ttop: 0;\n\t\t\tbackground-color: var(--color-main-background);\n\t\t\t// ensure focus outline of buttons is visible\n\t\t\tpadding: 2px;\n\n\t\t\t.header-wrapper {\n\t\t\t\tdisplay: flex;\n\t\t\t}\n\n\t\t\t&.row-checkbox {\n\t\t\t\twidth: 44px;\n\t\t\t}\n\t\t\t&.row-name {\n\t\t\t\twidth: 230px;\n\t\t\t}\n\t\t\t&.row-size {\n\t\t\t\twidth: 100px;\n\t\t\t}\n\t\t\t&.row-modified {\n\t\t\t\twidth: 120px;\n\t\t\t}\n\t\t}\n\n\t\t// >> begin of hacks for table header sorting buttons\n\t\t// TODO: Remove this hack after ... is available\n\t\tth:not(.row-size) {\n\t\t\t:deep(.button-vue__wrapper) {\n\t\t\t\tjustify-content: start;\n\t\t\t\tflex-direction: row-reverse;\n\t\t\t}\n\t\t\t:deep(.button-vue) {\n\t\t\t\tpadding-inline: 16px 4px;\n\t\t\t}\n\t\t}\n\t\tth.row-size :deep(.button-vue__wrapper) {\n\t\t\tjustify-content: end;\n\t\t}\n\t\tth :deep(.button-vue__wrapper) {\n\t\t\tcolor: var(--color-text-maxcontrast);\n\n\t\t\t.button-vue__text {\n\t\t\t\tfont-weight: normal;\n\t\t\t}\n\t\t}\n\t\t// << end of hacks\n\t}\n}\n</style>\n","<template>\n  <span v-bind=\"$attrs\"\n        :aria-hidden=\"title ? null : true\"\n        :aria-label=\"title\"\n        class=\"material-design-icon home-icon\"\n        role=\"img\"\n        @click=\"$emit('click', $event)\">\n    <svg :fill=\"fillColor\"\n         class=\"material-design-icon__svg\"\n         :width=\"size\"\n         :height=\"size\"\n         viewBox=\"0 0 24 24\">\n      <path d=\"M10,20V14H14V20H19V12H22L12,3L2,12H5V20H10Z\">\n        <title v-if=\"title\">{{ title }}</title>\n      </path>\n    </svg>\n  </span>\n</template>\n\n<script>\nexport default {\n  name: \"HomeIcon\",\n  emits: ['click'],\n  props: {\n    title: {\n      type: String,\n    },\n    fillColor: {\n      type: String,\n      default: \"currentColor\"\n    },\n    size: {\n      type: Number,\n      default: 24\n    }\n  }\n}\n</script>","<template>\n  <span v-bind=\"$attrs\"\n        :aria-hidden=\"title ? null : true\"\n        :aria-label=\"title\"\n        class=\"material-design-icon plus-icon\"\n        role=\"img\"\n        @click=\"$emit('click', $event)\">\n    <svg :fill=\"fillColor\"\n         class=\"material-design-icon__svg\"\n         :width=\"size\"\n         :height=\"size\"\n         viewBox=\"0 0 24 24\">\n      <path d=\"M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z\">\n        <title v-if=\"title\">{{ title }}</title>\n      </path>\n    </svg>\n  </span>\n</template>\n\n<script>\nexport default {\n  name: \"PlusIcon\",\n  emits: ['click'],\n  props: {\n    title: {\n      type: String,\n    },\n    fillColor: {\n      type: String,\n      default: \"currentColor\"\n    },\n    size: {\n      type: Number,\n      default: 24\n    }\n  }\n}\n</script>","<!--\n  - SPDX-FileCopyrightText: 2023-2024 Nextcloud GmbH and Nextcloud contributors\n  - SPDX-License-Identifier: AGPL-3.0-or-later\n-->\n<template>\n\t<NcBreadcrumbs class=\"file-picker__breadcrumbs\">\n\t\t<template #default>\n\t\t\t<NcBreadcrumb :name=\"t('All files')\"\n\t\t\t\t:title=\"t('Home')\"\n\t\t\t\t@click=\"emit('update:path', '/')\">\n\t\t\t\t<template #icon>\n\t\t\t\t\t<IconHome :size=\"20\" />\n\t\t\t\t</template>\n\t\t\t</NcBreadcrumb>\n\t\t\t<NcBreadcrumb v-for=\"dir in pathElements\"\n\t\t\t\t:key=\"dir.path\"\n\t\t\t\t:name=\"dir.name\"\n\t\t\t\t:title=\"dir.path\"\n\t\t\t\t@click=\"emit('update:path', dir.path)\" />\n\t\t</template>\n\t\t<template v-if=\"showMenu\" #actions>\n\t\t\t<NcActions :aria-label=\"t('Create directory')\"\n\t\t\t\t:force-menu=\"true\"\n\t\t\t\t:force-name=\"true\"\n\t\t\t\t:menu-name=\"t('New')\"\n\t\t\t\t:open.sync=\"actionsOpen\"\n\t\t\t\ttype=\"secondary\"\n\t\t\t\t@close=\"newNodeName = ''\">\n\t\t\t\t<template #icon>\n\t\t\t\t\t<IconPlus :size=\"20\" />\n\t\t\t\t</template>\n\t\t\t\t<NcActionInput ref=\"nameInput\"\n\t\t\t\t\t:value.sync=\"newNodeName\"\n\t\t\t\t\t:label=\"t('New folder')\"\n\t\t\t\t\t:placeholder=\"t('New folder name')\"\n\t\t\t\t\t@submit=\"onSubmit\"\n\t\t\t\t\t@input=\"validateInput\">\n\t\t\t\t\t<template #icon>\n\t\t\t\t\t\t<IconFolder :size=\"20\" />\n\t\t\t\t\t</template>\n\t\t\t\t</NcActionInput>\n\t\t\t</NcActions>\n\t\t</template>\n\t</NcBreadcrumbs>\n</template>\n\n<script setup lang=\"ts\">\nimport type Vue from 'vue'\n\nimport IconFolder from 'vue-material-design-icons/Folder.vue'\nimport IconHome from 'vue-material-design-icons/Home.vue'\nimport IconPlus from 'vue-material-design-icons/Plus.vue'\n\nimport { NcActions, NcActionInput, NcBreadcrumbs, NcBreadcrumb } from '@nextcloud/vue'\nimport { computed, ref } from 'vue'\nimport { t } from '../../utils/l10n'\n\nconst props = defineProps<{\n\t/** Current path to display */\n\tpath: string\n\t/** Whether to show the \"new node\" menu or not */\n\tshowMenu: boolean\n}>()\n\nconst emit = defineEmits<{\n\t/**\n\t * Triggered when the path was changed by using the breadcrumbs\n\t */\n\t(e: 'update:path', path: string): void\n\t/**\n\t * Triggered when a new directory on the current path should be created\n\t */\n\t(e: 'create-node', name: string): void\n}>()\n\nconst actionsOpen = ref(false)\n\n/**\n * Input on the \"new node\" menu\n */\nconst newNodeName = ref('')\n\nconst nameInput = ref<Vue>()\n\n/**\n * Validate user folder name input\n */\nfunction validateInput() {\n\tconst name = newNodeName.value.trim()\n\tconst input = nameInput.value?.$el?.querySelector('input')\n\n\tlet validity = ''\n\tif (name.length === 0) {\n\t\tvalidity = t('Folder name cannot be empty.')\n\t} else if (name.includes('/')) {\n\t\tvalidity = t('\"/\" is not allowed inside a folder name.')\n\t} else if (['..', '.'].includes(name)) {\n\t\tvalidity = t('\"{name}\" is an invalid folder name.', { name })\n\t} else if (window.OC.config?.blacklist_files_regex && name.match(window.OC.config?.blacklist_files_regex)) {\n\t\tvalidity = t('\"{name}\" is not an allowed folder name', { name })\n\t}\n\tif (input) {\n\t\tinput.setCustomValidity(validity)\n\t}\n\treturn validity === ''\n}\n/**\n * Handle creating a new node\n */\nconst onSubmit = function() {\n\tconst name = newNodeName.value.trim()\n\n\tif (validateInput()) {\n\t\tactionsOpen.value = false\n\t\temit('create-node', name)\n\t\tnewNodeName.value = ''\n\t}\n}\n\n/**\n * Split current path and provide the path and the basename\n */\nconst pathElements = computed(() => props.path.split('/')\n\t.filter((v) => v !== '')\n\t.map((v, i, elements) => ({\n\t\tname: v,\n\t\tpath: '/' + elements.slice(0, i + 1).join('/'),\n\t})),\n)\n</script>\n\n<style scoped lang=\"scss\">\n.file-picker {\n\t&__breadcrumbs {\n\t\t// ensure the breadcrumbs have a static height\n\t\tflex-grow: 0 !important;\n\t}\n}\n</style>\n","<template>\n  <span v-bind=\"$attrs\"\n        :aria-hidden=\"title ? null : true\"\n        :aria-label=\"title\"\n        class=\"material-design-icon close-icon\"\n        role=\"img\"\n        @click=\"$emit('click', $event)\">\n    <svg :fill=\"fillColor\"\n         class=\"material-design-icon__svg\"\n         :width=\"size\"\n         :height=\"size\"\n         viewBox=\"0 0 24 24\">\n      <path d=\"M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z\">\n        <title v-if=\"title\">{{ title }}</title>\n      </path>\n    </svg>\n  </span>\n</template>\n\n<script>\nexport default {\n  name: \"CloseIcon\",\n  emits: ['click'],\n  props: {\n    title: {\n      type: String,\n    },\n    fillColor: {\n      type: String,\n      default: \"currentColor\"\n    },\n    size: {\n      type: Number,\n      default: 24\n    }\n  }\n}\n</script>","<template>\n  <span v-bind=\"$attrs\"\n        :aria-hidden=\"title ? null : true\"\n        :aria-label=\"title\"\n        class=\"material-design-icon magnify-icon\"\n        role=\"img\"\n        @click=\"$emit('click', $event)\">\n    <svg :fill=\"fillColor\"\n         class=\"material-design-icon__svg\"\n         :width=\"size\"\n         :height=\"size\"\n         viewBox=\"0 0 24 24\">\n      <path d=\"M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z\">\n        <title v-if=\"title\">{{ title }}</title>\n      </path>\n    </svg>\n  </span>\n</template>\n\n<script>\nexport default {\n  name: \"MagnifyIcon\",\n  emits: ['click'],\n  props: {\n    title: {\n      type: String,\n    },\n    fillColor: {\n      type: String,\n      default: \"currentColor\"\n    },\n    size: {\n      type: Number,\n      default: 24\n    }\n  }\n}\n</script>","/**\n * SPDX-FileCopyrightText: 2024 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\n\nimport type { ComputedRef, Ref } from 'vue'\n\nimport { mdiClock, mdiFolder, mdiStar } from '@mdi/js'\nimport { t } from '../utils/l10n'\n\nexport type IFilesViewId = 'files' | 'favorites' | 'recent'\n\nexport interface IFilesView {\n\t/**\n\t * Unique ID of the view\n\t */\n\tid: IFilesViewId\n\t/**\n\t * Localized name of the view\n\t */\n\tlabel: string\n\t/**\n\t * The SVG icon paths\n\t */\n\ticon: string\n}\n\n/**\n * Get available file views\n */\nexport const useViews = (isAnonymous: Ref<boolean> | ComputedRef<boolean>) => {\n\n\t/**\n\t * All defined views\n\t */\n\tconst allViews = [\n\t\t{\n\t\t\tid: 'files',\n\t\t\tlabel: t('All files'),\n\t\t\ticon: mdiFolder,\n\t\t},\n\t\t{\n\t\t\tid: 'recent',\n\t\t\tlabel: t('Recent'),\n\t\t\ticon: mdiClock,\n\t\t},\n\t\t{\n\t\t\tid: 'favorites',\n\t\t\tlabel: t('Favorites'),\n\t\t\ticon: mdiStar,\n\t\t},\n\t] as IFilesView[]\n\n\t/**\n\t * Views which are available for the current user\n\t */\n\tconst availableViews = isAnonymous.value ? allViews.filter(({ id }) => id === 'files') : allViews\n\n\treturn {\n\t\tallViews,\n\t\tavailableViews,\n\t}\n}\n","<!--\n  - SPDX-FileCopyrightText: 2023-2024 Nextcloud GmbH and Nextcloud contributors\n  - SPDX-License-Identifier: AGPL-3.0-or-later\n-->\n<template>\n\t<Fragment>\n\t\t<!-- Filter for the file list -->\n\t\t<NcTextField class=\"file-picker__filter-input\"\n\t\t\t:value=\"filterString\"\n\t\t\t:label=\"t('Filter file list')\"\n\t\t\t:show-trailing-button=\"!!filterString\"\n\t\t\t@update:value=\"updateFilterValue\"\n\t\t\t@trailing-button-click=\"updateFilterValue('')\">\n\t\t\t<IconMagnify :size=\"16\" />\n\t\t\t<template #trailing-button-icon>\n\t\t\t\t<IconClose :size=\"16\" />\n\t\t\t</template>\n\t\t</NcTextField>\n\t\t<template v-if=\"availableViews.length > 1 && !disabledNavigation\">\n\t\t\t<!-- On non collapsed dialogs show the tablist, otherwise a dropdown is shown -->\n\t\t\t<ul v-if=\"!isCollapsed\"\n\t\t\t\tclass=\"file-picker__side\">\n\t\t\t\t<li v-for=\"view in availableViews\" :key=\"view.id\">\n\t\t\t\t\t<NcButton :type=\"currentView === view.id ? 'primary' : 'tertiary'\"\n\t\t\t\t\t\t:wide=\"true\"\n\t\t\t\t\t\t@click=\"$emit('update:currentView', view.id)\">\n\t\t\t\t\t\t<template #icon>\n\t\t\t\t\t\t\t<NcIconSvgWrapper :path=\"view.icon\" :size=\"20\" />\n\t\t\t\t\t\t</template>\n\t\t\t\t\t\t{{ view.label }}\n\t\t\t\t\t</NcButton>\n\t\t\t\t</li>\n\t\t\t</ul>\n\t\t\t<NcSelect v-else\n\t\t\t\t:aria-label=\"t('Current view selector')\"\n\t\t\t\t:clearable=\"false\"\n\t\t\t\t:searchable=\"false\"\n\t\t\t\t:options=\"availableViews\"\n\t\t\t\t:value=\"currentViewObject\"\n\t\t\t\t@input=\"(v) => emit('update:currentView', v.id)\" />\n\t\t</template>\n\t</Fragment>\n</template>\n\n<script setup lang=\"ts\">\nimport IconClose from 'vue-material-design-icons/Close.vue'\nimport IconMagnify from 'vue-material-design-icons/Magnify.vue'\n\nimport { getCurrentUser } from '@nextcloud/auth'\nimport { NcButton, NcIconSvgWrapper, NcSelect, NcTextField } from '@nextcloud/vue'\nimport { computed, ref } from 'vue'\nimport { Fragment } from 'vue-frag'\nimport { t } from '../../utils/l10n'\nimport { useViews } from '../../composables/views'\n\nconst props = defineProps<{\n\tcurrentView: 'files' | 'recent' | 'favorites',\n\tfilterString: string,\n\tisCollapsed: boolean,\n\tdisabledNavigation: boolean,\n}>()\n\ninterface INavigationEvents {\n\t(e: 'update:currentView', v: typeof props.currentView): void\n\t(e: 'update:filterString', v: string): void\n}\nconst emit = defineEmits<INavigationEvents>()\n\nconst { availableViews } = useViews(ref(getCurrentUser() === null))\n\n/**\n * The currently active view object\n */\nconst currentViewObject = computed(() => availableViews.filter(v => v.id === props.currentView)[0] ?? availableViews[0])\n\n/**\n * Propagate current filter value to paren\n *\n * @param value The new filter value\n */\nconst updateFilterValue = (value: string) => emit('update:filterString', value)\n</script>\n\n<style scoped lang=\"scss\">\n.file-picker {\n\t&__side {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\talign-items: stretch;\n\t\tgap: 0.5rem;\n\t\tmin-width: 200px;\n\t\t// ensure focus outline is visible\n\t\tpadding: 2px;\n\t\t// align with input\n\t\tmargin-block-start: 7px;\n\t\t// make only the navigation scroll\n\t\toverflow: auto;\n\n\t\t:deep(.button-vue__wrapper) {\n\t\t\tjustify-content: start;\n\t\t}\n\t}\n\n\t&__filter-input {\n\t\t// Align with view title and breadcrumbs\n\t\tmargin-block: 7px; // 36px height + 2x 7px => 50px\n\n\t\tmax-width: 260px;\n\t}\n}\n\n// Ensure filepicker works on mobile\n@media (max-width: 736px) {\n\t.file-picker {\n\t\t&__side {\n\t\t\tflex-direction: row;\n\t\t\tmin-width: unset;\n\t\t}\n\t}\n}\n@media (max-width: 512px) {\n\t.file-picker {\n\t\t&__side {\n\t\t\tflex-direction: row;\n\t\t\tmin-width: unset;\n\n\t\t}\n\t\t&__filter-input {\n\t\t\tmax-width: unset;\n\t\t}\n\t}\n}\n</style>\n\n<style lang=\"scss\">\n/* Ensure focus outline is visible */\n.file-picker__navigation {\n\tpadding-inline: 8px 2px;\n\t&, * {\n\t\tbox-sizing: border-box;\n\t}\n\n\t.v-select.select {\n\t\tmin-width: 220px;\n\t}\n}\n\n@media (min-width: 513px) and (max-width: 736px) {\n\t.file-picker__navigation {\n\t\tgap: 11px;\n\t}\n}\n\n@media (max-width: 512px) {\n\t.file-picker__navigation {\n\t\tflex-direction: column-reverse!important;\n\t}\n}\n</style>\n","/**\n * SPDX-FileCopyrightText: 2023 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\nimport type { ContentsWithRoot, Folder, Node } from '@nextcloud/files'\nimport type { ComputedRef, Ref } from 'vue'\nimport type { FileStat, ResponseDataDetailed, SearchResult } from 'webdav'\n\nimport { davGetClient, davGetDefaultPropfind, davGetRecentSearch, davRemoteURL, davResultToNode, davRootPath, getFavoriteNodes } from '@nextcloud/files'\nimport { generateRemoteUrl } from '@nextcloud/router'\nimport { isPublicShare } from '@nextcloud/sharing/public'\nimport { join } from 'node:path'\nimport { computed, onMounted, ref, shallowRef, watch } from 'vue'\nimport { CancelablePromise } from 'cancelable-promise'\n\n/**\n * Handle file loading using WebDAV\n *\n * @param currentView Reference to the current files view\n * @param currentPath Reference to the current files path\n */\nexport const useDAVFiles = function(\n\tcurrentView: Ref<'files'|'recent'|'favorites'> | ComputedRef<'files'|'recent'|'favorites'>,\n\tcurrentPath: Ref<string> | ComputedRef<string>,\n) {\n\n\tconst isPublicEndpoint = isPublicShare()\n\n\tconst defaultRootPath = isPublicEndpoint ? '/' : davRootPath\n\n\tconst defaultRemoteUrl = computed(() => {\n\t\tif (isPublicEndpoint) {\n\t\t\treturn generateRemoteUrl('webdav').replace('/remote.php', '/public.php')\n\t\t}\n\t\treturn davRemoteURL\n\t})\n\n\t/**\n\t * The WebDAV client\n\t */\n\tconst client = computed(() => {\n\t\tif (isPublicEndpoint) {\n\t\t\tconst token = (document.getElementById('sharingToken')! as HTMLInputElement).value\n\t\t\tconst authorization = btoa(`${token}:null`)\n\n\t\t\treturn davGetClient(defaultRemoteUrl.value, {\n\t\t\t\tAuthorization: `Basic ${authorization}`,\n\t\t\t})\n\t\t}\n\n\t\treturn davGetClient()\n\t})\n\n\tconst resultToNode = (result: FileStat) => davResultToNode(result, defaultRootPath, defaultRemoteUrl.value)\n\n\tconst getRecentNodes = (): CancelablePromise<Node[]> => {\n\t\tconst controller = new AbortController()\n\t\t// unix timestamp in seconds, two weeks ago\n\t\tconst lastTwoWeek = Math.round(Date.now() / 1000) - (60 * 60 * 24 * 14)\n\t\treturn new CancelablePromise(async (resolve, reject, onCancel) => {\n\t\t\tonCancel(() => controller.abort())\n\t\t\ttry {\n\t\t\t\tconst { data } = await client.value.search('/', {\n\t\t\t\t\tsignal: controller.signal,\n\t\t\t\t\tdetails: true,\n\t\t\t\t\tdata: davGetRecentSearch(lastTwoWeek),\n\t\t\t\t}) as ResponseDataDetailed<SearchResult>\n\t\t\t\tconst nodes = data.results.map(resultToNode)\n\t\t\t\tresolve(nodes)\n\t\t\t} catch (error) {\n\t\t\t\treject(error)\n\t\t\t}\n\t\t})\n\t}\n\n\tconst getNodes = (): CancelablePromise<ContentsWithRoot> => {\n\t\tconst controller = new AbortController()\n\t\treturn new CancelablePromise(async (resolve, reject, onCancel) => {\n\t\t\tonCancel(() => controller.abort())\n\t\t\ttry {\n\t\t\t\tconst results = await client.value.getDirectoryContents(`${defaultRootPath}${currentPath.value}`, {\n\t\t\t\t\tsignal: controller.signal,\n\t\t\t\t\tdetails: true,\n\t\t\t\t\tincludeSelf: true,\n\t\t\t\t\tdata: davGetDefaultPropfind(),\n\t\t\t\t}) as ResponseDataDetailed<FileStat[]>\n\t\t\t\tconst nodes = results.data.map(resultToNode)\n\t\t\t\tresolve({\n\t\t\t\t\tfolder: nodes.find((file) => file.path === currentPath.value) as Folder,\n\t\t\t\t\tcontents: nodes.filter((file) => file.path !== currentPath.value),\n\t\t\t\t})\n\t\t\t} catch (error) {\n\t\t\t\treject(error)\n\t\t\t}\n\t\t})\n\t}\n\n\t/**\n\t * All files in current view and path\n\t */\n\tconst files = shallowRef<Node[]>([] as Node[]) as Ref<Node[]>\n\n\t/**\n\t * The current folder\n\t */\n\tconst folder = shallowRef<Folder|null>(null)\n\n\t/**\n\t * Loading state of the files\n\t */\n\tconst isLoading = ref(true)\n\n\t/**\n\t * The cancelable promise used internally to cancel on fast navigation\n\t */\n\tconst promise = ref<null | CancelablePromise<Node[] | ContentsWithRoot>>(null)\n\n\t/**\n\t * Create a new directory in the current path\n\t * The directory will be added to the current file list\n\t * @param name Name of the new directory\n\t * @return The created directory\n\t */\n\tasync function createDirectory(name: string): Promise<Folder> {\n\t\tconst path = join(currentPath.value, name)\n\n\t\tawait client.value.createDirectory(join(defaultRootPath, path))\n\t\tconst directory = await getFile(path) as Folder\n\t\tfiles.value = [...files.value, directory]\n\t\treturn directory\n\t}\n\n\t/**\n\t * Get information for one file\n\t *\n\t * @param path The path of the file or folder\n\t * @param rootPath DAV root path, defaults to '/files/USERID'\n\t */\n\tasync function getFile(path: string, rootPath: string|undefined = undefined) {\n\t\trootPath = rootPath ?? defaultRootPath\n\n\t\tconst { data } = await client.value.stat(`${rootPath}${path}`, {\n\t\t\tdetails: true,\n\t\t\tdata: davGetDefaultPropfind(),\n\t\t}) as ResponseDataDetailed<FileStat>\n\t\treturn resultToNode(data)\n\t}\n\n\t/**\n\t * Force reload files using the DAV client\n\t */\n\tasync function loadDAVFiles() {\n\t\tif (promise.value) {\n\t\t\tpromise.value.cancel()\n\t\t}\n\t\tisLoading.value = true\n\n\t\tif (currentView.value === 'favorites') {\n\t\t\tpromise.value = getFavoriteNodes(client.value, currentPath.value, defaultRootPath)\n\t\t} else if (currentView.value === 'recent') {\n\t\t\tpromise.value = getRecentNodes()\n\t\t} else {\n\t\t\tpromise.value = getNodes()\n\t\t}\n\t\tconst content = await promise.value\n\t\tif ('folder' in content) {\n\t\t\tfolder.value = content.folder\n\t\t\tfiles.value = content.contents\n\t\t} else {\n\t\t\tfolder.value = null\n\t\t\tfiles.value = content\n\t\t}\n\n\t\tpromise.value = null\n\t\tisLoading.value = false\n\t}\n\n\t/**\n\t * Watch for ref changes\n\t */\n\twatch([currentView, currentPath], () => loadDAVFiles())\n\n\t/**\n\t * Initial loading of nodes\n\t */\n\tonMounted(() => loadDAVFiles())\n\n\treturn {\n\t\tisLoading,\n\t\tfiles,\n\t\tfolder,\n\t\tloadFiles: loadDAVFiles,\n\t\tcreateDirectory,\n\t}\n}\n","/**\n * SPDX-FileCopyrightText: 2023 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\nimport type { ComputedRef, Ref } from 'vue'\nimport { computed } from 'vue'\n\n/**\n * Create a filter function for MIME types\n * The filter function supports MIME type filters with wildcards\n *\n * @param allowedMIMETypes Reference to allowed MIME types\n */\nexport const useMimeFilter = function(allowedMIMETypes: Ref<readonly string[]> | ComputedRef<readonly string[]>) {\n\t// Cache splitted MIME types\n\tconst splittedTypes = computed(() => allowedMIMETypes.value.map((filter) => filter.split('/')))\n\n\t/**\n\t * Check if a given MIME type string is supported by the MIME filter values\n\t * @param mime MIME type string to check\n\t * @return True if mime is allowed by MIME filter values, false otherwise\n\t */\n\tconst isSupportedMimeType = (mime: string): boolean => {\n\t\tconst mimeTypeArray = mime.split('/')\n\t\treturn splittedTypes.value.some(\n\t\t\t([type, subtype]) =>\n\t\t\t\t// check mime type matches or is wildcard\n\t\t\t\t(mimeTypeArray[0] === type || type === '*')\n\t\t\t\t// check mime subtype matches or is wildcard\n\t\t\t\t&& (mimeTypeArray[1] === subtype || subtype === '*'),\n\t\t)\n\t}\n\n\treturn {\n\t\tisSupportedMimeType,\n\t}\n}\n","<!--\n  - SPDX-FileCopyrightText: 2023-2024 Nextcloud GmbH and Nextcloud contributors\n  - SPDX-License-Identifier: AGPL-3.0-or-later\n-->\n<template>\n\t<NcDialog :container=\"container\"\n\t\t:buttons=\"dialogButtons\"\n\t\t:name=\"name\"\n\t\tsize=\"large\"\n\t\tcontent-classes=\"file-picker__content\"\n\t\tdialog-classes=\"file-picker\"\n\t\tnavigation-classes=\"file-picker__navigation\"\n\t\t:open.sync=\"isOpen\"\n\t\t@update:open=\"handleClose\">\n\t\t<template #navigation=\"{ isCollapsed }\">\n\t\t\t<FilePickerNavigation :is-collapsed=\"isCollapsed\"\n\t\t\t\t:current-view.sync=\"currentView\"\n\t\t\t\t:filter-string.sync=\"filterString\"\n\t\t\t\t:disabled-navigation=\"disabledNavigation\" />\n\t\t</template>\n\n\t\t<div class=\"file-picker__main\">\n\t\t\t<!-- Header title / file list breadcrumbs -->\n\t\t\t<FilePickerBreadcrumbs v-if=\"currentView === 'files'\"\n\t\t\t\t:path.sync=\"currentPath\"\n\t\t\t\t:show-menu=\"allowPickDirectory\"\n\t\t\t\t@create-node=\"onCreateFolder\" />\n\t\t\t<div v-else class=\"file-picker__view\">\n\t\t\t\t<h3>{{ viewHeadline }}</h3>\n\t\t\t</div>\n\n\t\t\t<!-- File list -->\n\t\t\t<!-- If loading or files found show file list, otherwise show empty content-->\n\t\t\t<FileList v-if=\"isLoading || filteredFiles.length > 0\"\n\t\t\t\t:allow-pick-directory=\"allowPickDirectory\"\n\t\t\t\t:current-view=\"currentView\"\n\t\t\t\t:files=\"filteredFiles\"\n\t\t\t\t:multiselect=\"multiselect\"\n\t\t\t\t:loading=\"isLoading\"\n\t\t\t\t:path.sync=\"currentPath\"\n\t\t\t\t:selected-files.sync=\"selectedFiles\"\n\t\t\t\t:name=\"viewHeadline\"\n\t\t\t\t@update:path=\"currentView = 'files'\" />\n\t\t\t<NcEmptyContent v-else-if=\"filterString\"\n\t\t\t\t:name=\"t('No matching files')\"\n\t\t\t\t:description=\"t('No files matching your filter were found.')\">\n\t\t\t\t<template #icon>\n\t\t\t\t\t<IconFile />\n\t\t\t\t</template>\n\t\t\t</NcEmptyContent>\n\t\t\t<NcEmptyContent v-else\n\t\t\t\t:name=\"t('No files in here')\"\n\t\t\t\t:description=\"noFilesDescription\">\n\t\t\t\t<template #icon>\n\t\t\t\t\t<IconFile />\n\t\t\t\t</template>\n\t\t\t</NcEmptyContent>\n\t\t</div>\n\t</NcDialog>\n</template>\n\n<script setup lang=\"ts\">\nimport type { Node } from '@nextcloud/files'\nimport type { IFilePickerButton, IFilePickerButtonFactory, IFilePickerFilter } from '../types.ts'\nimport type { IFilesViewId } from '../../composables/views.ts'\n\nimport IconFile from 'vue-material-design-icons/File.vue'\nimport FileList from './FileList.vue'\nimport FilePickerBreadcrumbs from './FilePickerBreadcrumbs.vue'\nimport FilePickerNavigation from './FilePickerNavigation.vue'\n\nimport { emit as emitOnEventBus } from '@nextcloud/event-bus'\nimport { NcDialog, NcEmptyContent } from '@nextcloud/vue'\nimport { computed, onMounted, ref, shallowRef, toRef, watch } from 'vue'\nimport { showError } from '../../toast'\nimport { useDAVFiles } from '../../composables/dav'\nimport { useMimeFilter } from '../../composables/mime'\nimport { useFilesSettings } from '../../composables/filesSettings'\nimport { t } from '../../utils/l10n'\n\nconst props = withDefaults(defineProps<{\n\t/** Buttons to be displayed */\n\tbuttons: IFilePickerButton[] | IFilePickerButtonFactory\n\n\t/** The name of file picker dialog (heading) */\n\tname: string\n\n\t/**\n\t * Can directories be picked\n\t * @default false\n\t */\n\tallowPickDirectory?: boolean\n\n\t/**\n\t * Is the navigation disabled\n\t */\n\t disabledNavigation?: boolean\n\n\t/**\n\t * Where to mount the dialog\n\t * @default 'body'\n\t */\n\tcontainer?: string\n\n\t/**\n\t * Custom filter function used to filter pickable files\n\t */\n\tfilterFn?: IFilePickerFilter\n\n\t/**\n\t * List of allowed mime types\n\t * You can use placeholders for e.g. allowing all subtypes of images `['image/*']`.\n\t * Note that if unset all files are allowed, which is the same as passing `['*∕*']`\n\t * @default []\n\t */\n\tmimetypeFilter?: string[]\n\n\t/**\n\t * Is it allowed to pick multiple files\n\t * @default true\n\t */\n\tmultiselect?: boolean\n\n\t/**\n\t * The initial path of the file picker\n\t * @default '/'\n\t */\n\t path?: string\n}>(), {\n\tallowPickDirectory: false,\n\tdisabledNavigation: false,\n\tcontainer: 'body',\n\tfilterFn: undefined,\n\tmimetypeFilter: () => [],\n\tmultiselect: true,\n\tpath: undefined,\n})\n\nconst emit = defineEmits<{\n\t(e: 'close', v?: Node[]): void\n}>()\n\nconst isOpen = ref(true)\n\n/**\n * Map buttons to Dialog buttons by wrapping the callback function to pass the selected files\n */\nconst dialogButtons = computed(() => {\n\tconst nodes = selectedFiles.value.length === 0\n\t\t&& props.allowPickDirectory\n\t\t&& currentFolder.value\n\t\t? [currentFolder.value]\n\t\t: selectedFiles.value\n\n\tconst buttons = typeof props.buttons === 'function'\n\t\t? props.buttons(nodes, currentPath.value, currentView.value)\n\t\t: props.buttons\n\n\treturn buttons.map((button) => ({\n\t\t...button,\n\t\tdisabled: button.disabled || isLoading.value,\n\t\tcallback: () => {\n\t\t\t// lock default close handling\n\t\t\tisHandlingCallback = true\n\t\t\thandleButtonClick(button.callback, nodes)\n\t\t},\n\t} as IFilePickerButton))\n})\n\n/**\n * Flag that is set when a button was clicked to prevent the default close event to be emitted\n * This is needed as `handleButtonClick` is async and thus might execute after NcDialog already closed\n */\nlet isHandlingCallback = false\n\nconst handleButtonClick = async (callback: IFilePickerButton['callback'], nodes: Node[]) => {\n\tcallback(nodes)\n\temit('close', nodes)\n\t// Unlock close\n\tisHandlingCallback = false\n}\n\n/**\n * Name of the currently active view\n */\nconst currentView = ref<IFilesViewId>('files')\n\n/**\n * Headline to be used on the current view\n */\nconst viewHeadline = computed(() => currentView.value === 'favorites' ? t('Favorites') : (currentView.value === 'recent' ? t('Recent') : ''))\n\n/**\n * All currently selected files\n */\nconst selectedFiles = shallowRef<Node[]>([])\n\n/**\n * Last path navigated to using the file picker\n * (required as sessionStorage is not reactive)\n */\nconst savedPath = ref(window?.sessionStorage.getItem('NC.FilePicker.LastPath') || '/')\n\n/**\n * The path the user manually navigated to using this filepicker instance\n */\nconst navigatedPath = ref('')\n// Save the navigated path to the session storage on change\nwatch([navigatedPath], () => {\n\tif (props.path === undefined && navigatedPath.value) {\n\t\twindow.sessionStorage.setItem('NC.FilePicker.LastPath', navigatedPath.value)\n\t}\n\t// Reset selected files\n\tselectedFiles.value = []\n})\n\n/**\n * The current path that should be picked from\n */\nconst currentPath = computed({\n\tget: () => {\n\t\t// Only use the path for the files view as favorites and recent only works on the root\n\t\treturn currentView.value === 'files' ? navigatedPath.value || props.path || savedPath.value : '/'\n\t},\n\tset: (path: string) => {\n\t\t// forward setting the current path to the navigated path\n\t\tnavigatedPath.value = path\n\t},\n})\n\n/**\n * A string used to filter files in current view\n */\nconst filterString = ref('')\n\nconst { isSupportedMimeType } = useMimeFilter(toRef(props, 'mimetypeFilter')) // vue 3.3 will allow cleaner syntax of toRef(() => props.mimetypeFilter)\n\nconst {\n\tfiles,\n\tfolder: currentFolder,\n\tisLoading,\n\tloadFiles,\n\tcreateDirectory,\n} = useDAVFiles(currentView, currentPath)\n\nonMounted(() => loadFiles())\n\nconst { showHiddenFiles } = useFilesSettings()\n\n/**\n * The files list filtered by the current value of the filter input\n */\nconst filteredFiles = computed(() => {\n\tlet filtered = files.value\n\n\tif (!showHiddenFiles.value) {\n\t\t// Hide hidden files if not configured otherwise\n\t\tfiltered = filtered.filter((file) => !file.basename.startsWith('.'))\n\t}\n\tif (props.mimetypeFilter.length > 0) {\n\t\t// filter by mime type but always include folders to navigate\n\t\tfiltered = filtered.filter(file => file.type === 'folder' || (file.mime && isSupportedMimeType(file.mime)))\n\t}\n\tif (filterString.value) {\n\t\tfiltered = filtered.filter((file) => file.basename.toLowerCase().includes(filterString.value.toLowerCase()))\n\t}\n\tif (props.filterFn) {\n\t\tfiltered = filtered.filter((f) => props.filterFn!(f as Node))\n\t}\n\treturn filtered\n})\n\n/**\n * If no files are found in the current view this message will be shown in the EmptyContent\n */\nconst noFilesDescription = computed(() => {\n\tif (currentView.value === 'files') {\n\t\treturn t('Upload some content or sync with your devices!')\n\t} else if (currentView.value === 'recent') {\n\t\treturn t('Files and folders you recently modified will show up here.')\n\t} else {\n\t\treturn t('Files and folders you mark as favorite will show up here.')\n\t}\n})\n\n/**\n * Handle creating new folder (breadcrumb menu)\n * This will create the folder using WebDAV, reload the directory content and signal the directory creation to fhe files app\n *\n * @param name The new folder name\n */\nconst onCreateFolder = async (name: string) => {\n\ttry {\n\t\tconst folder = await createDirectory(name)\n\t\tnavigatedPath.value = folder.path\n\t\t// emit event bus to force files app to reload that file if needed\n\t\temitOnEventBus('files:node:created', files.value.filter((file) => file.basename === name)[0])\n\t} catch (error) {\n\t\tconsole.warn('Could not create new folder', { name, error })\n\t\t// show error to user\n\t\tshowError(t('Could not create the new folder'))\n\t}\n}\n\n/**\n * Handle closing the file picker\n * @param open If the dialog is open\n */\nconst handleClose = (open: boolean) => {\n\tif (!open && !isHandlingCallback) {\n\t\temit('close')\n\t}\n}\n</script>\n\n<script lang=\"ts\">\nexport default {\n\tname: 'FilePicker',\n}\n</script>\n\n<style scoped lang=\"scss\">\n.file-picker {\n\t&__view {\n\t\theight: 50px; // align with breadcrumbs\n\t\tdisplay: flex;\n\t\tjustify-content: start;\n\t\talign-items: center;\n\n\t\th3 {\n\t\t\tfont-weight: bold;\n\t\t\theight: fit-content;\n\t\t\tmargin: 0;\n\t\t}\n\t}\n\n\t&__main {\n\t\tbox-sizing: border-box;\n\t\twidth: 100%;\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\t// Auto fit height\n\t\tmin-height: 0;\n\t\tflex: 1;\n\t\t// align with navigation on smaller screens\n\t\tpadding-inline: 2px;\n\n\t\t* {\n\t\t\tbox-sizing: border-box;\n\t\t}\n\t}\n}\n\n:deep(.file-picker) {\n\t// Dialog is max. 900px wide so the best looking height seems to be 800px\n\theight: min(80vh, 800px)!important;\n}\n\n@media (max-width: 512px) {\n\t:deep(.file-picker) {\n\t\t// below 512px the modal is fullscreen so we use 100% height - margin of heading (4px + 12px) - height of heading (default-clickable-area)\n\t\theight: calc(100% - 16px - var(--default-clickable-area))!important;\n\t}\n}\n\n:deep(.file-picker__content) {\n\tdisplay: flex;\n\tflex-direction: column;\n\toverflow: hidden;\n}\n</style>\n"],"names":["_sfc_main","_a","_b","_c","order","_d","_e","_f","_g","_h","_i","_j","_k","_l","__default__","emit","emitOnEventBus"],"mappings":"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","x_google_ignoreList":[0,2,3,6,10,11,13,14]}