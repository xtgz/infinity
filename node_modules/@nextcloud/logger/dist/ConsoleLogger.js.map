{"version":3,"file":"ConsoleLogger.js","names":["_contracts","require","_typeof","o","Symbol","iterator","constructor","prototype","_classCallCheck","instance","Constructor","TypeError","_defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","_toPropertyKey","key","_createClass","protoProps","staticProps","_defineProperty","obj","value","arg","_toPrimitive","String","input","hint","prim","toPrimitive","undefined","res","call","Number","ConsoleLogger","context","formatMessage","message","level","msg","LogLevel","toUpperCase","app","concat","name","Debug","stack","log","_this$context","_this$context2","error","console","debug","Info","info","Warn","warn","Error","Fatal","assign","fatal","exports","buildConsoleLogger"],"sources":["../lib/ConsoleLogger.ts"],"sourcesContent":["import { IContext, ILogger, LogLevel } from './contracts'\n\nexport class ConsoleLogger implements ILogger {\n\n\tprivate context: IContext\n\n\tconstructor(context?: IContext) {\n\t\tthis.context = context || {}\n\t}\n\n\tprivate formatMessage(message: string|Error, level: LogLevel, context?: IContext): string {\n\t\tlet msg = '[' + LogLevel[level].toUpperCase() + '] '\n\n\t\tif (context && context.app) {\n\t\t\tmsg += context.app + ': '\n\t\t}\n\n\t\tif (typeof message === 'string') return msg + message\n\n\t\t// basic error formatting\n\t\tmsg += `Unexpected ${message.name}`\n\t\tif (message.message) msg += ` \"${message.message}\"`\n\t\t// only add stack trace when debugging\n\t\tif (level === LogLevel.Debug && message.stack) msg += `\\n\\nStack trace:\\n${message.stack}`\n\n\t\treturn msg\n\t}\n\n\tlog(level: LogLevel, message: string|Error, context: IContext) {\n\t\t// Skip if level is configured and this is below the level\n\t\tif (typeof this.context?.level === 'number' && level < this.context?.level) {\n\t\t\treturn\n\t\t}\n\n\t\t// Add error object to context\n\t\tif (typeof message === 'object' && context?.error === undefined) {\n\t\t\tcontext.error = message\n\t\t}\n\n\t\tswitch (level) {\n\t\tcase LogLevel.Debug:\n\t\t\tconsole.debug(this.formatMessage(message, LogLevel.Debug, context), context)\n\t\t\tbreak\n\t\tcase LogLevel.Info:\n\t\t\tconsole.info(this.formatMessage(message, LogLevel.Info, context), context)\n\t\t\tbreak\n\t\tcase LogLevel.Warn:\n\t\t\tconsole.warn(this.formatMessage(message, LogLevel.Warn, context), context)\n\t\t\tbreak\n\t\tcase LogLevel.Error:\n\t\t\tconsole.error(this.formatMessage(message, LogLevel.Error, context), context)\n\t\t\tbreak\n\t\tcase LogLevel.Fatal:\n\t\tdefault:\n\t\t\tconsole.error(this.formatMessage(message, LogLevel.Fatal, context), context)\n\t\t\tbreak\n\t\t}\n\t}\n\n\tdebug(message: string|Error, context?: IContext): void {\n\t\tthis.log(LogLevel.Debug, message, Object.assign({}, this.context, context))\n\t}\n\n\tinfo(message: string|Error, context?: IContext): void {\n\t\tthis.log(LogLevel.Info, message, Object.assign({}, this.context, context))\n\t}\n\n\twarn(message: string|Error, context?: IContext): void {\n\t\tthis.log(LogLevel.Warn, message, Object.assign({}, this.context, context))\n\t}\n\n\terror(message: string|Error, context?: IContext): void {\n\t\tthis.log(LogLevel.Error, message, Object.assign({}, this.context, context))\n\t}\n\n\tfatal(message: string|Error, context?: IContext): void {\n\t\tthis.log(LogLevel.Fatal, message, Object.assign({}, this.context, context))\n\t}\n\n}\n\n/**\n * Create a new console logger\n *\n * @param context Optional global context which should be included for all logging messages\n */\nexport function buildConsoleLogger(context?: IContext): ILogger {\n\treturn new ConsoleLogger(context)\n}\n"],"mappings":"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"}