{"version":3,"file":"index.es.mjs","sources":["../src/parsers/abstractParser.js","../src/errors/modificationNotAllowedError.js","../src/traits/lockable.js","../src/errors/expectedICalJSError.js","../src/helpers/stringHelper.js","../src/config.js","../src/factories/icalFactory.js","../src/traits/observer.js","../src/parameters/parameter.js","../src/values/abstractValue.js","../src/values/binaryValue.js","../src/values/durationValue.js","../src/values/dateTimeValue.js","../src/values/periodValue.js","../src/values/recurValue.js","../src/values/utcOffsetValue.js","../src/errors/unknownICALTypeError.js","../src/values/index.js","../src/properties/property.js","../src/properties/attachmentProperty.js","../src/properties/attendeeProperty.js","../src/properties/conferenceProperty.js","../src/properties/freeBusyProperty.js","../src/properties/geoProperty.js","../src/properties/imageProperty.js","../src/properties/relationProperty.js","../src/properties/requestStatusProperty.js","../src/properties/textProperty.js","../src/properties/triggerProperty.js","../src/properties/index.js","../src/components/abstractComponent.js","../src/factories/dateFactory.js","../src/errors/recurringWithoutDtStartError.js","../src/recurrence/recurrenceManager.js","../src/timezones/timezone.js","../src/components/nested/alarmComponent.js","../src/components/nested/index.js","../src/components/root/abstractRecurringComponent.js","../src/helpers/birthdayHelper.js","../src/components/root/eventComponent.js","../src/components/root/freeBusyComponent.js","../src/components/root/journalComponent.js","../src/components/root/timezoneComponent.js","../src/components/root/toDoComponent.js","../src/components/root/index.js","../src/components/calendarComponent.js","../src/parsers/repairsteps/abstractRepairStep.js","../src/parsers/repairsteps/icalendar/icalendarAddMissingUIDRepairStep.js","../src/parsers/repairsteps/icalendar/icalendarAddMissingValueDateDoubleColonRepairStep.js","../src/parsers/repairsteps/icalendar/icalendarAddMissingValueDateRepairStep.js","../src/parsers/repairsteps/icalendar/icalendarEmptyTriggerRepairStep.js","../src/parsers/repairsteps/icalendar/icalendarIllegalCreatedRepairStep.js","../src/parsers/repairsteps/icalendar/icalendarMultipleVCalendarBlocksRepairStep.js","../src/parsers/repairsteps/icalendar/icalendarRemoveXNCGroupIdRepairStep.js","../src/parsers/repairsteps/icalendar/index.js","../src/timezones/timezoneManager.js","../src/parsers/icalendarParser.js","../src/parsers/parserManager.js","../src/timezones/timezoneAdapter.js","../src/errors/illegalValueError.js","../src/timezones/utils.js","../src/index.js"],"sourcesContent":["/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\n/**\n * @class AbstractParser\n * @classdesc\n */\nexport default class AbstractParser {\n\n\t/**\n\t * @class\n\t *\n\t * @param {object=} options Object of options\n\t * @param {boolean=} options.extractGlobalProperties Whether or not to preserve properties from the VCALENDAR component (defaults to false)\n\t * @param {boolean=} options.removeRSVPForAttendees Whether or not to remove RSVP from attendees (defaults to false)\n\t * @param {boolean=} options.includeTimezones Whether or not to include timezones (defaults to false)\n\t * @param {boolean=} options.preserveMethod Whether or not to preserve the iCalendar method (defaults to false)\n\t * @param {boolean=} options.processFreeBusy Whether or not to process VFreeBusy components (defaults to false)\n\t */\n\tconstructor(options = {}) {\n\t\tif (new.target === AbstractParser) {\n\t\t\tthrow new TypeError('Cannot instantiate abstract class AbstractParser')\n\t\t}\n\n\t\t/**\n\t\t * Options for the parser\n\t\t *\n\t\t * @type {{removeRSVPForAttendees: boolean}}\n\t\t * @private\n\t\t */\n\t\tthis._options = Object.assign({}, options)\n\n\t\t/**\n\t\t * A name extracted from the calendar-data\n\t\t *\n\t\t * @type {string | null}\n\t\t * @protected\n\t\t */\n\t\tthis._name = null\n\n\t\t/**\n\t\t * A color extracted from the calendar-data\n\t\t *\n\t\t * @type {string | null}\n\t\t * @protected\n\t\t */\n\t\tthis._color = null\n\n\t\t/**\n\t\t * Gets the url that this icalendar file can be updated from\n\t\t *\n\t\t * @type {string}\n\t\t * @protected\n\t\t */\n\t\tthis._sourceURL = null\n\n\t\t/**\n\t\t * Gets the update interval if this icalendar file can be updated from a source\n\t\t *\n\t\t * @type {string}\n\t\t * @protected\n\t\t */\n\t\tthis._refreshInterval = null\n\n\t\t/**\n\t\t * Gets the default timezone of this calendar\n\t\t *\n\t\t * @type {string}\n\t\t * @protected\n\t\t */\n\t\tthis._calendarTimezone = null\n\n\t\t/**\n\t\t * Error count during parsing\n\t\t *\n\t\t * @type {Array}\n\t\t * @protected\n\t\t */\n\t\tthis._errors = []\n\t}\n\n\t/**\n\t * Gets the name extracted from the calendar-data\n\t *\n\t * @return {string | null}\n\t */\n\tgetName() {\n\t\treturn this._name\n\t}\n\n\t/**\n\t * Gets the color extracted from the calendar-data\n\t *\n\t * @return {string | null}\n\t */\n\tgetColor() {\n\t\treturn this._color\n\t}\n\n\t/**\n\t * Gets whether this import can be converted into a webcal subscription\n\t *\n\t * @return {boolean}\n\t */\n\toffersWebcalFeed() {\n\t\treturn this._sourceURL !== null\n\t}\n\n\t/**\n\t * Gets the url pointing to the webcal source\n\t *\n\t * @return {string | null}\n\t */\n\tgetSourceURL() {\n\t\treturn this._sourceURL\n\t}\n\n\t/**\n\t * Gets the recommended refresh rate to update this subscription\n\t *\n\t * @return {string | null}\n\t */\n\tgetRefreshInterval() {\n\t\treturn this._refreshInterval\n\t}\n\n\t/**\n\t * Gets the default timezone of this calendar\n\t *\n\t * @return {string}\n\t */\n\tgetCalendarTimezone() {\n\t\treturn this._calendarTimezone\n\t}\n\n\t/**\n\t * {String|Object} data\n\t *\n\t * @param {any} data The data to parse\n\t * @throws TypeError\n\t */\n\tparse(data) {\n\t\tthrow new TypeError('Abstract method not implemented by subclass')\n\t}\n\n\t/**\n\t * Returns one CalendarComponent at a time\n\t */\n\t* getItemIterator() { // eslint-disable-line require-yield\n\t\tthrow new TypeError('Abstract method not implemented by subclass')\n\t}\n\n\t/**\n\t * Get an array of all items\n\t *\n\t * @return {CalendarComponent[]}\n\t */\n\tgetAllItems() {\n\t\treturn Array.from(this.getItemIterator())\n\t}\n\n\t/**\n\t * Returns a boolean whether or not the parsed data contains vevents\n\t *\n\t * @return {boolean}\n\t */\n\tcontainsVEvents() {\n\t\treturn false\n\t}\n\n\t/**\n\t * Returns a boolean whether or not the parsed data contains vjournals\n\t *\n\t * @return {boolean}\n\t */\n\tcontainsVJournals() {\n\t\treturn false\n\t}\n\n\t/**\n\t * Returns a boolean whether or not the parsed data contains vtodos\n\t *\n\t * @return {boolean}\n\t */\n\tcontainsVTodos() {\n\t\treturn false\n\t}\n\n\t/**\n\t * Returns a boolean whether or not the parsed data contains vfreebusys\n\t *\n\t * @return {boolean}\n\t */\n\tcontainsVFreeBusy() {\n\t\treturn false\n\t}\n\n\t/**\n\t * Returns a boolean whether\n\t *\n\t * @return {boolean}\n\t */\n\thasErrors() {\n\t\treturn this._errors.length !== 0\n\t}\n\n\t/**\n\t * Get a list of all errors that occurred\n\t *\n\t * @return {*[]}\n\t */\n\tgetErrorList() {\n\t\treturn this._errors.slice()\n\t}\n\n\t/**\n\t * Returns the number of calendar-objects in parser\n\t *\n\t * @return {number}\n\t */\n\tgetItemCount() {\n\t\treturn 0\n\t}\n\n\t/**\n\t * Gets an option provided\n\t *\n\t * @param {string} name The name of the option to get\n\t * @param {*} defaultValue The default value to return if option not provided\n\t * @return {any}\n\t * @protected\n\t */\n\t_getOption(name, defaultValue) {\n\t\treturn Object.prototype.hasOwnProperty.call(this._options, name)\n\t\t\t? this._options[name]\n\t\t\t: defaultValue\n\t}\n\n\t/**\n\t * Return list of supported mime types\n\t *\n\t * @static\n\t */\n\tstatic getMimeTypes() {\n\t\tthrow new TypeError('Abstract method not implemented by subclass')\n\t}\n\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nexport default class ModificationNotAllowedError extends Error {}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport ModificationNotAllowedError from '../errors/modificationNotAllowedError.js'\n\n/**\n *\n * @param baseClass\n */\nexport default function lockableTrait(baseClass) {\n\n\t/**\n\t * @class LockableTrait\n\t */\n\treturn class extends baseClass {\n\n\t\t/**\n\t\t * Constructor\n\t\t *\n\t\t * @param {...any} args\n\t\t */\n\t\tconstructor(...args) {\n\t\t\tsuper(...args)\n\n\t\t\t/**\n\t\t\t * Indicator whether this value was locked for changes\n\t\t\t *\n\t\t\t * @type {boolean}\n\t\t\t * @private\n\t\t\t */\n\t\t\tthis._mutable = true\n\t\t}\n\n\t\t/**\n\t\t * Returns whether or not this object is locked\n\t\t *\n\t\t * @return {boolean}\n\t\t */\n\t\tisLocked() {\n\t\t\treturn !this._mutable\n\t\t}\n\n\t\t/**\n\t\t * Marks this object is immutable\n\t\t * locks it against further modification\n\t\t */\n\t\tlock() {\n\t\t\tthis._mutable = false\n\t\t}\n\n\t\t/**\n\t\t * Marks this object as mutable\n\t\t * allowing further modification\n\t\t */\n\t\tunlock() {\n\t\t\tthis._mutable = true\n\t\t}\n\n\t\t/**\n\t\t * Check if modifications are allowed\n\t\t *\n\t\t * @throws {ModificationNotAllowedError} if this object is locked for modification\n\t\t * @protected\n\t\t */\n\t\t_modify() {\n\t\t\tif (!this._mutable) {\n\t\t\t\tthrow new ModificationNotAllowedError()\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * Check if modification of content is allowed\n\t\t *\n\t\t * @throws {ModificationNotAllowedError} if this object is locked for modification\n\t\t * @protected\n\t\t */\n\t\t_modifyContent() {\n\t\t\tthis._modify()\n\t\t}\n\n\t}\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nexport default class ExpectedICalJSError extends Error {}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\n/**\n * Turns the entire string lowercase\n *\n * @param {string} str The string to turn lowercase\n * @return {string}\n */\nexport function lc(str) {\n\treturn str.toLowerCase()\n}\n\n/**\n * Compares two strings, It is case-insensitive.\n *\n * @param {string} str1 String 1 to compare\n * @param {string} str2 String 2 to compare\n * @return {boolean}\n */\nexport function strcasecmp(str1, str2) {\n\treturn uc(str1) === uc(str2)\n}\n\n/**\n * Turns the entire string uppercase\n *\n * @param {string} str The string to turn uppercase\n * @return {string}\n */\nexport function uc(str) {\n\treturn str.toUpperCase()\n}\n\n/**\n * Capitalizes the string\n *\n * @param {string} str The string of which the first character will be turned uppercase\n * @return {string}\n */\nexport function ucFirst(str) {\n\treturn str.charAt(0).toUpperCase() + str.slice(1)\n}\n\n/**\n * Makes sure that a string starts with a certain other string\n * This is mostly used in the attendeeProperty to assure the uri starts with mailto:\n *\n * @param {string} str The string to check for the prefix and prepend if necessary\n * @param {string} startWith The prefix to be added if necessary\n * @return {string}\n */\nexport function startStringWith(str, startWith) {\n\tif (!str.startsWith(startWith)) {\n\t\tstr = startWith + str\n\t}\n\n\treturn str\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\n/**\n * @type {Map<string, *>}\n */\nconst GLOBAL_CONFIG = new Map()\n\n/**\n * Sets a new config key\n *\n * @param {string} key The config-key to set\n * @param {*} value The value to set for given config-key\n */\nexport function setConfig(key, value) {\n\tGLOBAL_CONFIG.set(key, value)\n}\n\n/**\n * Checks if a config for a certain key is present\n *\n * @param {string} key The config-key to check\n * @return {boolean}\n */\nexport function hasConfig(key) {\n\treturn GLOBAL_CONFIG.has(key)\n}\n\n/**\n * gets value of a config key\n *\n * @param {string} key The config-key to get\n * @param {*} defaultValue Default value of config does not exist\n * @return {*}\n */\nexport function getConfig(key, defaultValue) {\n\treturn GLOBAL_CONFIG.get(key) || defaultValue\n}\n\n/**\n * deletes a config key\n *\n * @param {string} key The config-key to delete\n */\nexport function deleteConfig(key) {\n\tGLOBAL_CONFIG.delete(key)\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nimport { lc } from '../helpers/stringHelper.js'\nimport { getConfig } from '../config.js'\nimport ICAL from 'ical.js'\n\n/**\n * creates a new ICAL.Component object\n *\n * @param {string} componentName The name of the component to create\n * @return {ICAL.Component}\n */\nexport function createComponent(componentName) {\n\treturn new ICAL.Component(lc(componentName))\n}\n\n/**\n * creates a new ICAL.Property object\n *\n * @param {string} propertyName The name of the property to create\n * @return {ICAL.Property}\n */\nexport function createProperty(propertyName) {\n\treturn new ICAL.Property(lc(propertyName))\n}\n\n/**\n * creates a new calendar component\n *\n * @param {string=} method Name of the method to include in VCALENDAR component\n * @return {ICAL.Component}\n */\nexport function createCalendarComponent(method = null) {\n\tconst calendarComp = createComponent('VCALENDAR')\n\n\tcalendarComp.addPropertyWithValue('prodid', getConfig('PRODID', '-//IDN georgehrke.com//calendar-js//EN'))\n\tcalendarComp.addPropertyWithValue('calscale', 'GREGORIAN')\n\tcalendarComp.addPropertyWithValue('version', '2.0')\n\n\tif (method) {\n\t\tcalendarComp.addPropertyWithValue('method', method)\n\t}\n\n\treturn calendarComp\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\n/**\n *\n * @param baseClass\n */\nexport default function observerTrait(baseClass) {\n\n\t/**\n\t * @class ObserverTrait\n\t */\n\treturn class extends baseClass {\n\n\t\t/**\n\t\t * Constructor\n\t\t *\n\t\t * @param {...any} args\n\t\t */\n\t\tconstructor(...args) {\n\t\t\tsuper(...args)\n\n\t\t\t/**\n\t\t\t * List of subscribers\n\t\t\t *\n\t\t\t * @type {Function[]}\n\t\t\t * @private\n\t\t\t */\n\t\t\tthis._subscribers = []\n\t\t}\n\n\t\t/**\n\t\t * Adds a new subscriber\n\t\t *\n\t\t * @param {Function} handler - Handler to be called when modification happens\n\t\t */\n\t\tsubscribe(handler) {\n\t\t\tthis._subscribers.push(handler)\n\t\t}\n\n\t\t/**\n\t\t * Removes a subscriber\n\t\t *\n\t\t * @param {Function} handler - Handler to be no longer called when modification happens\n\t\t */\n\t\tunsubscribe(handler) {\n\t\t\tconst index = this._subscribers.indexOf(handler)\n\t\t\tif (index === -1) {\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\tthis._subscribers.splice(index, 1)\n\t\t}\n\n\t\t/**\n\t\t * Notify all subscribed handlers\n\t\t *\n\t\t * @param {...any} args\n\t\t * @protected\n\t\t */\n\t\t_notifySubscribers(...args) {\n\t\t\tfor (const handler of this._subscribers) {\n\t\t\t\thandler(...args)\n\t\t\t}\n\t\t}\n\n\t}\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nimport { uc } from '../helpers/stringHelper.js'\nimport lockableTrait from '../traits/lockable.js'\nimport observerTrait from '../traits/observer.js'\n\n/**\n * @class Parameter\n * @classdesc This class represents a property parameters as defined in RFC 5545 Section 3.2\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.2\n * @url\n */\nexport default class Parameter extends observerTrait(lockableTrait(class {})) {\n\n\t/**\n\t * Constructor\n\t *\n\t * @param {string} name The name of the parameter\n\t * @param {string|Array|null} value The value of the parameter\n\t */\n\tconstructor(name, value = null) {\n\t\tsuper()\n\n\t\t/**\n\t\t * Name of the parameter\n\t\t *\n\t\t * @type {string}\n\t\t * @private\n\t\t */\n\t\tthis._name = uc(name)\n\n\t\t/**\n\t\t * Value of the parameter\n\t\t *\n\t\t * @type {string|Array|null}\n\t\t * @private\n\t\t */\n\t\tthis._value = value\n\t}\n\n\t/**\n\t * Get parameter name\n\t *\n\t * @readonly\n\t * @return {string}\n\t */\n\tget name() {\n\t\treturn this._name\n\t}\n\n\t/**\n\t * Get parameter value\n\t *\n\t * @return {string | Array}\n\t */\n\tget value() {\n\t\treturn this._value\n\t}\n\n\t/**\n\t * Set new parameter value\n\t *\n\t * @throws {ModificationNotAllowedError} if parameter is locked for modification\n\t * @param {string | Array} value The new value to set\n\t */\n\tset value(value) {\n\t\tthis._modifyContent()\n\t\tthis._value = value\n\t}\n\n\t/**\n\t * Gets the first value of this parameter\n\t *\n\t * @return {string | null}\n\t */\n\tgetFirstValue() {\n\t\tif (!this.isMultiValue()) {\n\t\t\treturn this.value\n\t\t} else {\n\t\t\tif (this.value.length > 0) {\n\t\t\t\treturn this.value[0]\n\t\t\t}\n\t\t}\n\n\t\treturn null\n\t}\n\n\t/**\n\t * Gets an iterator for all values\n\t */\n\t* getValueIterator() {\n\t\tif (this.isMultiValue()) {\n\t\t\tyield * this.value.slice()[Symbol.iterator]()\n\t\t} else {\n\t\t\tyield this.value\n\t\t}\n\t}\n\n\t/**\n\t * Returns whether or not the value is a multivalue\n\t *\n\t * @return {boolean}\n\t */\n\tisMultiValue() {\n\t\treturn Array.isArray(this._value)\n\t}\n\n\t/**\n\t * Creates a copy of this parameter\n\t *\n\t * @return {Parameter}\n\t */\n\tclone() {\n\t\tconst parameter = new this.constructor(this._name)\n\t\tif (this.isMultiValue()) {\n\t\t\t// only copy array values, don't copy array reference\n\t\t\tparameter.value = this._value.slice()\n\t\t} else {\n\t\t\tparameter.value = this._value\n\t\t}\n\n\t\t// cloned parameters are always mutable\n\t\treturn parameter\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\t_modifyContent() {\n\t\tsuper._modifyContent()\n\t\tthis._notifySubscribers()\n\t}\n\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport lockableTrait from '../traits/lockable.js'\nimport observerTrait from '../traits/observer.js'\n\n/**\n * @class AbstractValue\n * @classdesc BaseClass for all values\n */\nexport default class AbstractValue extends observerTrait(lockableTrait(class {})) {\n\n\t/**\n\t * Constructor\n\t *\n\t * @param {ICAL.Binary|ICAL.Duration|ICAL.Period|ICAL.Recur|ICAL.Time|ICAL.UtcOffset} icalValue The ICAL.JS object to wrap\n\t */\n\tconstructor(icalValue) {\n\t\tif (new.target === AbstractValue) {\n\t\t\tthrow new TypeError('Cannot instantiate abstract class AbstractValue')\n\t\t}\n\t\tsuper()\n\n\t\t/**\n\t\t * Wrapped ICAL.js value\n\t\t *\n\t\t * @type {ICAL.Binary|ICAL.Duration|ICAL.Period|ICAL.Recur|ICAL.Time|ICAL.UtcOffset}\n\t\t */\n\t\tthis._innerValue = icalValue\n\t}\n\n\t/**\n\t * Gets wrapped ICAL.JS object\n\t *\n\t * @return {*}\n\t */\n\ttoICALJs() {\n\t\treturn this._innerValue\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\t_modifyContent() {\n\t\tsuper._modifyContent()\n\t\tthis._notifySubscribers()\n\t}\n\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport AbstractValue from './abstractValue.js'\nimport ICAL from 'ical.js'\n\n/**\n * @class BinaryValue\n * @classdesc Wrapper for ICAL.Binary\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.1.3\n * @url https://github.com/mozilla-comm/ical.js/blob/master/lib/ical/binary.js\n */\nexport default class BinaryValue extends AbstractValue {\n\n\t/**\n\t * Sets the raw b64 encoded value\n\t *\n\t * @return {string}\n\t */\n\tget rawValue() {\n\t\treturn this._innerValue.value\n\t}\n\n\t/**\n\t * Gets the raw b64 encoded value\n\t *\n\t * @throws {ModificationNotAllowedError} if value is locked for modification\n\t * @param {string} value - The new raw value\n\t */\n\tset rawValue(value) {\n\t\tthis._modifyContent()\n\t\tthis._innerValue.value = value\n\t}\n\n\t/**\n\t * Gets the decoded value\n\t *\n\t * @return {string}\n\t */\n\tget value() {\n\t\treturn this._innerValue.decodeValue()\n\t}\n\n\t/**\n\t * Sets the decoded Value\n\t *\n\t * @throws {ModificationNotAllowedError} if value is locked for modification\n\t * @param  {string} decodedValue - The new encoded value\n\t */\n\tset value(decodedValue) {\n\t\tthis._modifyContent()\n\t\tthis._innerValue.setEncodedValue(decodedValue)\n\t}\n\n\t/**\n\t * clones this value\n\t *\n\t * @return {BinaryValue}\n\t */\n\tclone() {\n\t\treturn BinaryValue.fromRawValue(this._innerValue.value)\n\t}\n\n\t/**\n\t * Create a new BinaryValue object from an ICAL.Binary object\n\t *\n\t * @param {ICAL.Binary} icalValue - The ICAL.Binary object\n\t * @return {BinaryValue}\n\t */\n\tstatic fromICALJs(icalValue) {\n\t\treturn new BinaryValue(icalValue)\n\t}\n\n\t/**\n\t * Create a new BinaryValue object from a raw b64 encoded value\n\t *\n\t * @param {string} rawValue - The raw value\n\t * @return {BinaryValue}\n\t */\n\tstatic fromRawValue(rawValue) {\n\t\tconst icalBinary = new ICAL.Binary(rawValue)\n\t\treturn BinaryValue.fromICALJs(icalBinary)\n\t}\n\n\t/**\n\t * Create a new BinaryValue object from decoded value\n\t *\n\t * @param {string} decodedValue - The encoded value\n\t * @return {BinaryValue}\n\t */\n\tstatic fromDecodedValue(decodedValue) {\n\t\tconst icalBinary = new ICAL.Binary()\n\t\ticalBinary.setEncodedValue(decodedValue)\n\t\treturn BinaryValue.fromICALJs(icalBinary)\n\t}\n\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport AbstractValue from './abstractValue.js'\nimport ICAL from 'ical.js'\n\n/**\n * @class DurationValue\n * @classdesc Wrapper for ICAL.Duration\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.3.6\n * @url https://github.com/mozilla-comm/ical.js/blob/master/lib/ical/duration.js\n */\nexport default class DurationValue extends AbstractValue {\n\n\t/**\n\t * Gets the weeks of the stored duration-value\n\t *\n\t * @return {number}\n\t */\n\tget weeks() {\n\t\treturn this._innerValue.weeks\n\t}\n\n\t/**\n\t * Sets the weeks of the stored duration-value\n\t *\n\t * @throws {ModificationNotAllowedError} if value is locked for modification\n\t * @throws {TypeError} if value is negative\n\t * @param {number} weeks Amount of weeks\n\t */\n\tset weeks(weeks) {\n\t\tthis._modifyContent()\n\t\tif (weeks < 0) {\n\t\t\tthrow new TypeError('Weeks cannot be negative, use isNegative instead')\n\t\t}\n\n\t\tthis._innerValue.weeks = weeks\n\t}\n\n\t/**\n\t * Gets the days of the stored duration-value\n\t *\n\t * @return {number}\n\t */\n\tget days() {\n\t\treturn this._innerValue.days\n\t}\n\n\t/**\n\t * Sets the days of the stored duration-value\n\t *\n\t * @throws {ModificationNotAllowedError} if value is locked for modification\n\t * @throws {TypeError} if value is negative\n\t * @param {number} days Amount of days\n\t */\n\tset days(days) {\n\t\tthis._modifyContent()\n\t\tif (days < 0) {\n\t\t\tthrow new TypeError('Days cannot be negative, use isNegative instead')\n\t\t}\n\n\t\tthis._innerValue.days = days\n\t}\n\n\t/**\n\t * Gets the hours of the stored duration-value\n\t *\n\t * @return {number}\n\t */\n\tget hours() {\n\t\treturn this._innerValue.hours\n\t}\n\n\t/**\n\t * Sets the weeks of the stored duration-value\n\t *\n\t * @throws {ModificationNotAllowedError} if value is locked for modification\n\t * @throws {TypeError} if value is negative\n\t * @param {number} hours Amount of hours\n\t */\n\tset hours(hours) {\n\t\tthis._modifyContent()\n\t\tif (hours < 0) {\n\t\t\tthrow new TypeError('Hours cannot be negative, use isNegative instead')\n\t\t}\n\n\t\tthis._innerValue.hours = hours\n\t}\n\n\t/**\n\t * Gets the minutes of the stored duration-value\n\t *\n\t * @return {number}\n\t */\n\tget minutes() {\n\t\treturn this._innerValue.minutes\n\t}\n\n\t/**\n\t * Sets the minutes of the stored duration-value\n\t *\n\t * @throws {ModificationNotAllowedError} if value is locked for modification\n\t * @throws {TypeError} if value is negative\n\t * @param {number} minutes Amount of minutes\n\t */\n\tset minutes(minutes) {\n\t\tthis._modifyContent()\n\t\tif (minutes < 0) {\n\t\t\tthrow new TypeError('Minutes cannot be negative, use isNegative instead')\n\t\t}\n\n\t\tthis._innerValue.minutes = minutes\n\t}\n\n\t/**\n\t * Gets the seconds of the stored duration-value\n\t *\n\t * @return {number}\n\t */\n\tget seconds() {\n\t\treturn this._innerValue.seconds\n\t}\n\n\t/**\n\t * Sets the seconds of the stored duration-value\n\t *\n\t * @throws {ModificationNotAllowedError} if value is locked for modification\n\t * @throws {TypeError} if value is negative\n\t * @param {number} seconds Amount of seconds\n\t */\n\tset seconds(seconds) {\n\t\tthis._modifyContent()\n\t\tif (seconds < 0) {\n\t\t\tthrow new TypeError('Seconds cannot be negative, use isNegative instead')\n\t\t}\n\n\t\tthis._innerValue.seconds = seconds\n\t}\n\n\t/**\n\t * Gets the negative-indicator of the stored duration-value\n\t *\n\t * @return {boolean}\n\t */\n\tget isNegative() {\n\t\treturn this._innerValue.isNegative\n\t}\n\n\t/**\n\t * Gets the negative-indicator of the stored duration-value\n\t *\n\t * @throws {ModificationNotAllowedError} if value is locked for modification\n\t * @param {boolean} isNegative Whether or not the duration is negative\n\t */\n\tset isNegative(isNegative) {\n\t\tthis._modifyContent()\n\t\tthis._innerValue.isNegative = !!isNegative\n\t}\n\n\t/**\n\t * Gets the amount of total seconds of the stored duration-value\n\t *\n\t * @return {* | number}\n\t */\n\tget totalSeconds() {\n\t\treturn this._innerValue.toSeconds()\n\t}\n\n\t/**\n\t * Sets the amount of total seconds of the stored duration-value\n\t *\n\t * @throws {ModificationNotAllowedError} if value is locked for modification\n\t * @param {number} totalSeconds The total amounts of seconds to set\n\t */\n\tset totalSeconds(totalSeconds) {\n\t\tthis._modifyContent()\n\t\tthis._innerValue.fromSeconds(totalSeconds)\n\t}\n\n\t/**\n\t * Compares this duration to another one\n\t *\n\t * @param {DurationValue} otherDuration The duration to compare to\n\t * @return {number} -1, 0 or 1 for less/equal/greater\n\t */\n\tcompare(otherDuration) {\n\t\treturn this._innerValue.compare(otherDuration.toICALJs())\n\t}\n\n\t/**\n\t * Adds the value of another duration to this one\n\t *\n\t * @throws {ModificationNotAllowedError} if value is locked for modification\n\t * @param {DurationValue} otherDuration The duration to add\n\t */\n\taddDuration(otherDuration) {\n\t\tthis._modifyContent()\n\t\tthis.totalSeconds += otherDuration.totalSeconds\n\t\tthis._innerValue.normalize()\n\t}\n\n\t/**\n\t * Subtract the value of another duration from this one\n\t *\n\t * @throws {ModificationNotAllowedError} if value is locked for modification\n\t * @param {DurationValue} otherDuration The duration to subtract\n\t */\n\tsubtractDuration(otherDuration) {\n\t\tthis._modifyContent()\n\t\tthis.totalSeconds -= otherDuration.totalSeconds\n\t\tthis._innerValue.normalize()\n\t}\n\n\t/**\n\t * clones this value\n\t *\n\t * @return {DurationValue}\n\t */\n\tclone() {\n\t\treturn DurationValue.fromICALJs(this._innerValue.clone())\n\t}\n\n\t/**\n\t * Create a new DurationValue object from an ICAL.Duration object\n\t *\n\t * @param {ICAL.Duration} icalValue The ical.js duration value\n\t * @return {DurationValue}\n\t */\n\tstatic fromICALJs(icalValue) {\n\t\treturn new DurationValue(icalValue)\n\t}\n\n\t/**\n\t * Create a new DurationValue object from a number of seconds\n\t *\n\t * @param {number} seconds Total amount of seconds\n\t * @return {DurationValue}\n\t */\n\tstatic fromSeconds(seconds) {\n\t\tconst icalDuration = ICAL.Duration.fromSeconds(seconds)\n\t\treturn new DurationValue(icalDuration)\n\n\t}\n\n\t/**\n\t * Create a new DurationValue object from data\n\t *\n\t * @param {object} data The destructuring object\n\t * @param {number=} data.weeks Number of weeks to set\n\t * @param {number=} data.days Number of days to set\n\t * @param {number=} data.hours Number of hours to set\n\t * @param {number=} data.minutes Number of minutes to set\n\t * @param {number=} data.seconds Number of seconds to set\n\t * @param {boolean=} data.isNegative Whether or not duration is negative\n\t * @return {DurationValue}\n\t */\n\tstatic fromData(data) {\n\t\tconst icalDuration = ICAL.Duration.fromData(data)\n\t\treturn new DurationValue(icalDuration)\n\t}\n\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport AbstractValue from './abstractValue.js'\nimport DurationValue from './durationValue.js'\nimport ICAL from 'ical.js'\n\n/**\n * @class DateTimeValue\n * @classdesc Wrapper for ICAL.Time\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.3.4\n * @url https://tools.ietf.org/html/rfc5545#section-3.3.5\n * @url https://tools.ietf.org/html/rfc5545#section-3.3.12\n * @url https://github.com/mozilla-comm/ical.js/blob/master/lib/ical/time.js\n */\nexport default class DateTimeValue extends AbstractValue {\n\n\t/**\n\t * Gets the year of the stored date-time-value\n\t *\n\t * @return {number}\n\t */\n\tget year() {\n\t\treturn this._innerValue.year\n\t}\n\n\t/**\n\t * Sets the year of the stored date-time-value\n\t *\n\t * @throws {ModificationNotAllowedError} if value is locked for modification\n\t * @param {number} year Number of years to set\n\t */\n\tset year(year) {\n\t\tthis._modifyContent()\n\t\tthis._innerValue.year = year\n\t}\n\n\t/**\n\t * Gets the month of the stored date-time-value\n\t *\n\t * @return {number}\n\t */\n\tget month() {\n\t\treturn this._innerValue.month\n\t}\n\n\t/**\n\t * Sets the month of the stored date-time-value\n\t *\n\t * @throws {ModificationNotAllowedError} if value is locked for modification\n\t * @param {number} month Number of months to set\n\t */\n\tset month(month) {\n\t\tthis._modifyContent()\n\t\tif (month < 1 || month > 12) {\n\t\t\tthrow new TypeError('Month out of range')\n\t\t}\n\n\t\tthis._innerValue.month = month\n\t}\n\n\t/**\n\t * Gets the day of the stored date-time-value\n\t *\n\t * @return {number}\n\t */\n\tget day() {\n\t\treturn this._innerValue.day\n\t}\n\n\t/**\n\t * Sets the day of the stored date-time-value\n\t *\n\t * @throws {ModificationNotAllowedError} if value is locked for modification\n\t * @throws {TypeError} if out of range\n\t * @param {number} day Number of days to set\n\t */\n\tset day(day) {\n\t\tthis._modifyContent()\n\t\tif (day < 1 || day > 31) {\n\t\t\tthrow new TypeError('Day out of range')\n\t\t}\n\n\t\tthis._innerValue.day = day\n\t}\n\n\t/**\n\t * Gets the hour of the stored date-time-value\n\t *\n\t * @return {number}\n\t */\n\tget hour() {\n\t\treturn this._innerValue.hour\n\t}\n\n\t/**\n\t * Sets the hour of the stored date-time-value\n\t *\n\t * @throws {ModificationNotAllowedError} if value is locked for modification\n\t * @throws {TypeError} if out of range\n\t * @param {number} hour Number of hours to set\n\t */\n\tset hour(hour) {\n\t\tthis._modifyContent()\n\t\tif (hour < 0 || hour > 23) {\n\t\t\tthrow new TypeError('Hour out of range')\n\t\t}\n\n\t\tthis._innerValue.hour = hour\n\t}\n\n\t/**\n\t * Gets the minute of the stored date-time-value\n\t *\n\t * @return {number}\n\t */\n\tget minute() {\n\t\treturn this._innerValue.minute\n\t}\n\n\t/**\n\t * Sets the minute of the stored date-time-value\n\t *\n\t * @throws {ModificationNotAllowedError} if value is locked for modification\n\t * @throws {TypeError} if out of range\n\t * @param {number} minute Number of minutes to set\n\t */\n\tset minute(minute) {\n\t\tthis._modifyContent()\n\t\tif (minute < 0 || minute > 59) {\n\t\t\tthrow new TypeError('Minute out of range')\n\t\t}\n\n\t\tthis._innerValue.minute = minute\n\t}\n\n\t/**\n\t * Gets the second of the stored date-time-value\n\t *\n\t * @return {number}\n\t */\n\tget second() {\n\t\treturn this._innerValue.second\n\t}\n\n\t/**\n\t * Sets the second of the stored date-time-value\n\t *\n\t * @throws {ModificationNotAllowedError} if value is locked for modification\n\t * @throws {TypeError} if out of range\n\t * @param {number} second Number of seconds to set\n\t */\n\tset second(second) {\n\t\tthis._modifyContent()\n\t\tif (second < 0 || second > 59) {\n\t\t\tthrow new TypeError('Second out of range')\n\t\t}\n\n\t\tthis._innerValue.second = second\n\t}\n\n\t/**\n\t * Gets the timezone of this date-time-value\n\t *\n\t * @return {string | null}\n\t */\n\tget timezoneId() {\n\t\t// If zone.tzid is set and it's not 'floating' nor 'UTC', then it's a proper\n\t\t// timezone that we also have a timezone id for\n\t\tif (this._innerValue.zone.tzid && this._innerValue.zone.tzid !== 'floating' && this._innerValue.zone.tzid === 'UTC') {\n\t\t\treturn this._innerValue.zone.tzid\n\t\t}\n\n\t\t// If there is a timezone set, but we didn't have a zone.tzid in the previous if,\n\t\t// this means that the tzid does not have a definition stored along it.\n\t\t// we will keep this information anyway to not lose it\n\t\tif (this._innerValue.timezone) {\n\t\t\treturn this._innerValue.timezone\n\t\t}\n\n\t\t// this is the case when it's floating / UTC\n\t\treturn this._innerValue.zone.tzid || null\n\t}\n\n\t/**\n\t * Gets whether this date-time-value is a date or date-time\n\t *\n\t * @return {boolean}\n\t */\n\tget isDate() {\n\t\treturn this._innerValue.isDate\n\t}\n\n\t/**\n\t * Sets whether this date-time-value is a date or date-time\n\t *\n\t * @throws {ModificationNotAllowedError} if value is locked for modification\n\t * @param {boolean} isDate Whether this is a date or date-time value\n\t */\n\tset isDate(isDate) {\n\t\tthis._modifyContent()\n\t\tthis._innerValue.isDate = !!isDate\n\n\t\tif (isDate) {\n\t\t\tthis._innerValue.hour = 0\n\t\t\tthis._innerValue.minute = 0\n\t\t\tthis._innerValue.second = 0\n\t\t}\n\t}\n\n\t/**\n\t * Gets the unix-time\n\t *\n\t * @return {number}\n\t */\n\tget unixTime() {\n\t\treturn this._innerValue.toUnixTime()\n\t}\n\n\t/**\n\t * returns vanilla javascript date object\n\t *\n\t * @return {Date}\n\t */\n\tget jsDate() {\n\t\treturn this._innerValue.toJSDate()\n\t}\n\n\t/**\n\t * Adds a duration to this date-time-value\n\t *\n\t * @param {DurationValue} duration The duration to ad\n\t */\n\taddDuration(duration) {\n\t\tthis._innerValue.addDuration(duration.toICALJs())\n\t}\n\n\t/**\n\t * Subtract another date excluding timezones\n\t *\n\t * @param {DateTimeValue} other The date-time value to subtract\n\t * @return {DurationValue}\n\t */\n\tsubtractDateWithoutTimezone(other) {\n\t\tconst icalDuration = this._innerValue.subtractDate(other.toICALJs())\n\t\treturn DurationValue.fromICALJs(icalDuration)\n\t}\n\n\t/**\n\t * Subtract another date, taking timezones into account\n\t *\n\t * @param {DateTimeValue} other The date-time value to subtract\n\t * @return {DurationValue}\n\t */\n\tsubtractDateWithTimezone(other) {\n\t\tconst icalDuration = this._innerValue.subtractDateTz(other.toICALJs())\n\t\treturn DurationValue.fromICALJs(icalDuration)\n\t}\n\n\t/**\n\t * Compares this DateTimeValue object with another one\n\t *\n\t * @param {DateTimeValue} other The date-time to compare to\n\t * @return {number} -1, 0 or 1 for less/equal/greater\n\t */\n\tcompare(other) {\n\t\treturn this._innerValue.compare(other.toICALJs())\n\t}\n\n\t/**\n\t * Compares only the date part in a given timezone\n\t *\n\t * @param {DateTimeValue} other The date-time to compare to\n\t * @param {Timezone} timezone The timezone to compare in\n\t * @return {number} -1, 0 or 1 for less/equal/greater\n\t */\n\tcompareDateOnlyInGivenTimezone(other, timezone) {\n\t\treturn this._innerValue.compareDateOnlyTz(other.toICALJs(), timezone.toICALTimezone())\n\t}\n\n\t/**\n\t * Returns a clone of this object which was converted to a different timezone\n\t *\n\t * @param {Timezone} timezone TimezoneId to convert to\n\t * @return {DateTimeValue}\n\t */\n\tgetInTimezone(timezone) {\n\t\tconst clonedICALTime = this._innerValue.convertToZone(timezone.toICALTimezone())\n\t\treturn DateTimeValue.fromICALJs(clonedICALTime)\n\t}\n\n\t/**\n\t * Get the inner ICAL.Timezone\n\t *\n\t * @return {ICAL.Timezone}\n\t * @package\n\t */\n\tgetICALTimezone() {\n\t\treturn this._innerValue.zone\n\t}\n\n\t/**\n\t * Returns a clone of this object which was converted to a different timezone\n\t *\n\t * @param {ICAL.Timezone} timezone TimezoneId to convert to\n\t * @return {DateTimeValue}\n\t * @package\n\t */\n\tgetInICALTimezone(timezone) {\n\t\tconst clonedICALTime = this._innerValue.convertToZone(timezone)\n\t\treturn DateTimeValue.fromICALJs(clonedICALTime)\n\t}\n\n\t/**\n\t * Returns a clone of this object which was converted to UTC\n\t *\n\t * @return {DateTimeValue}\n\t */\n\tgetInUTC() {\n\t\tconst clonedICALTime = this._innerValue.convertToZone(ICAL.Timezone.utcTimezone)\n\t\treturn DateTimeValue.fromICALJs(clonedICALTime)\n\t}\n\n\t/**\n\t * This silently replaces the inner timezone without converting the actual time\n\t *\n\t * @param {ICAL.Timezone} timezone The timezone to replace with\n\t * @package\n\t */\n\tsilentlyReplaceTimezone(timezone) {\n\t\tthis._modify()\n\t\tthis._innerValue = new ICAL.Time({\n\t\t\tyear: this.year,\n\t\t\tmonth: this.month,\n\t\t\tday: this.day,\n\t\t\thour: this.hour,\n\t\t\tminute: this.minute,\n\t\t\tsecond: this.second,\n\t\t\tisDate: this.isDate,\n\t\t\ttimezone,\n\t\t})\n\t}\n\n\t/**\n\t * Replaces the inner timezone without converting the actual time\n\t *\n\t * @param {Timezone} timezone The timezone to replace with\n\t */\n\treplaceTimezone(timezone) {\n\t\tthis._modifyContent()\n\t\tthis._innerValue = ICAL.Time.fromData({\n\t\t\tyear: this.year,\n\t\t\tmonth: this.month,\n\t\t\tday: this.day,\n\t\t\thour: this.hour,\n\t\t\tminute: this.minute,\n\t\t\tsecond: this.second,\n\t\t\tisDate: this.isDate,\n\t\t}, timezone.toICALTimezone())\n\t}\n\n\t/**\n\t * Calculates the UTC offset of the date-time-value in its timezone\n\t *\n\t * @return {number}\n\t */\n\tutcOffset() {\n\t\treturn this._innerValue.utcOffset()\n\t}\n\n\t/**\n\t * Check if this is an event with floating time\n\t *\n\t * @return {boolean}\n\t */\n\tisFloatingTime() {\n\t\treturn this._innerValue.zone.tzid === 'floating'\n\t}\n\n\t/**\n\t * clones this value\n\t *\n\t * @return {DateTimeValue}\n\t */\n\tclone() {\n\t\treturn DateTimeValue.fromICALJs(this._innerValue.clone())\n\t}\n\n\t/**\n\t * Create a new DateTimeValue object from an ICAL.Time object\n\t *\n\t * @param {ICAL.Time} icalValue The ical.js Date value to initialise from\n\t * @return {DateTimeValue}\n\t */\n\tstatic fromICALJs(icalValue) {\n\t\treturn new DateTimeValue(icalValue)\n\t}\n\n\t/**\n\t * Creates a new DateTimeValue object based on a vanilla javascript object\n\t *\n\t * @param {Date} jsDate The JavaScript date to initialise from\n\t * @param {boolean=} useUTC Whether or not to treat it as UTC\n\t * @return {DateTimeValue}\n\t */\n\tstatic fromJSDate(jsDate, useUTC = false) {\n\t\tconst icalValue = ICAL.Time.fromJSDate(jsDate, useUTC)\n\t\treturn DateTimeValue.fromICALJs(icalValue)\n\t}\n\n\t/**\n\t * Creates a new DateTimeValue object based on simple parameters\n\t *\n\t * @param {object} data The destructuring object\n\t * @param {number=} data.year Amount of years to set\n\t * @param {number=} data.month Amount of month to set (1-based)\n\t * @param {number=} data.day Amount of days to set\n\t * @param {number=} data.hour Amount of hours to set\n\t * @param {number=} data.minute Amount of minutes to set\n\t * @param {number=} data.second Amount of seconds to set\n\t * @param {boolean=} data.isDate Whether this is a date or date-time\n\t * @param {Timezone=} timezone The timezone of the DateTimeValue\n\t * @return {DateTimeValue}\n\t */\n\tstatic fromData(data, timezone) {\n\t\tconst icalValue = ICAL.Time.fromData(data, timezone\n\t\t\t? timezone.toICALTimezone()\n\t\t\t: undefined)\n\t\treturn DateTimeValue.fromICALJs(icalValue)\n\t}\n\n}\n\nDateTimeValue.SUNDAY = ICAL.Time.SUNDAY\nDateTimeValue.MONDAY = ICAL.Time.MONDAY\nDateTimeValue.TUESDAY = ICAL.Time.TUESDAY\nDateTimeValue.WEDNESDAY = ICAL.Time.WEDNESDAY\nDateTimeValue.THURSDAY = ICAL.Time.THURSDAY\nDateTimeValue.FRIDAY = ICAL.Time.FRIDAY\nDateTimeValue.SATURDAY = ICAL.Time.SATURDAY\n\nDateTimeValue.DEFAULT_WEEK_START = DateTimeValue.MONDAY\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport AbstractValue from './abstractValue.js'\nimport DateTimeValue from './dateTimeValue.js'\nimport DurationValue from './durationValue.js'\nimport ICAL from 'ical.js'\n\n/**\n * @class PeriodValue\n * @classdesc Wrapper for ICAL.Period\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.3.9\n * @url https://github.com/mozilla-comm/ical.js/blob/master/lib/ical/period.js\n */\nexport default class PeriodValue extends AbstractValue {\n\n\t/**\n\t * @inheritDoc\n\t */\n\tconstructor(...args) {\n\t\tsuper(...args)\n\n\t\t/**\n\t\t * DateTimeValue object for start\n\t\t *\n\t\t * @type {DateTimeValue}\n\t\t * @private\n\t\t */\n\t\tthis._start = DateTimeValue.fromICALJs(this._innerValue.start)\n\n\t\t/**\n\t\t * DateTimeValue object for end\n\t\t *\n\t\t * @type {DateTimeValue|null}\n\t\t * @private\n\t\t */\n\t\tthis._end = null\n\n\t\t/**\n\t\t * DurationValue object for duration\n\t\t *\n\t\t * @type {DurationValue|null}\n\t\t * @private\n\t\t */\n\t\tthis._duration = null\n\t}\n\n\t/**\n\t * Gets the start of the period-value\n\t *\n\t * @return {DateTimeValue}\n\t */\n\tget start() {\n\t\treturn this._start\n\t}\n\n\t/**\n\t * Sets the start of the period-value\n\t *\n\t * @throws {ModificationNotAllowedError} if value is locked for modification\n\t * @param {DateTimeValue} start The start of the period\n\t */\n\tset start(start) {\n\t\tthis._modifyContent()\n\t\tthis._start = start\n\t\tthis._innerValue.start = start.toICALJs()\n\t}\n\n\t/**\n\t * Gets the end of the period-value\n\t *\n\t * @return {DateTimeValue}\n\t */\n\tget end() {\n\t\tif (!this._end) {\n\t\t\tif (this._duration) {\n\t\t\t\tthis._duration.lock()\n\t\t\t\tthis._duration = null\n\t\t\t}\n\n\t\t\tthis._innerValue.end = this._innerValue.getEnd()\n\t\t\tthis._end = DateTimeValue.fromICALJs(this._innerValue.end)\n\t\t\tthis._innerValue.duration = null\n\n\t\t\tif (this.isLocked()) {\n\t\t\t\tthis._end.lock()\n\t\t\t}\n\t\t}\n\n\t\treturn this._end\n\t}\n\n\t/**\n\t * Sets the end of the period-value\n\t *\n\t * @throws {ModificationNotAllowedError} if value is locked for modification\n\t * @param {DateTimeValue} end The end of the period\n\t */\n\tset end(end) {\n\t\tthis._modifyContent()\n\t\tthis._innerValue.duration = null\n\t\tthis._innerValue.end = end.toICALJs()\n\t\tthis._end = end\n\t}\n\n\t/**\n\t * Gets the duration of the period-value\n\t * The value is automatically locked.\n\t * If you want to edit the value, clone it and it as new duration\n\t *\n\t * @return {DurationValue}\n\t */\n\tget duration() {\n\t\tif (!this._duration) {\n\t\t\tif (this._end) {\n\t\t\t\tthis._end.lock()\n\t\t\t\tthis._end = null\n\t\t\t}\n\n\t\t\tthis._innerValue.duration = this._innerValue.getDuration()\n\t\t\tthis._duration = DurationValue.fromICALJs(this._innerValue.duration)\n\t\t\tthis._innerValue.end = null\n\n\t\t\tif (this.isLocked()) {\n\t\t\t\tthis._duration.lock()\n\t\t\t}\n\t\t}\n\n\t\treturn this._duration\n\t}\n\n\t/**\n\t * Sets the duration of the period-value\n\t *\n\t * @throws {ModificationNotAllowedError} if value is locked for modification\n\t * @param {DurationValue} duration The duration to set\n\t */\n\tset duration(duration) {\n\t\tthis._modifyContent()\n\t\tthis._innerValue.end = null\n\t\tthis._innerValue.duration = duration.toICALJs()\n\t\tthis._duration = duration\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tlock() {\n\t\tsuper.lock()\n\t\tthis.start.lock()\n\n\t\tif (this._end) {\n\t\t\tthis._end.lock()\n\t\t}\n\t\tif (this._duration) {\n\t\t\tthis._duration.lock()\n\t\t}\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tunlock() {\n\t\tsuper.unlock()\n\t\tthis.start.unlock()\n\n\t\tif (this._end) {\n\t\t\tthis._end.unlock()\n\t\t}\n\t\tif (this._duration) {\n\t\t\tthis._duration.unlock()\n\t\t}\n\t}\n\n\t/**\n\t * clones this value\n\t *\n\t * @return {PeriodValue}\n\t */\n\tclone() {\n\t\treturn PeriodValue.fromICALJs(this._innerValue.clone())\n\t}\n\n\t/**\n\t * Create a new PeriodValue object from a ICAL.Period object\n\t *\n\t * @param {ICAL.Period} icalValue The ical.js period value to initialise from\n\t * @return {PeriodValue}\n\t */\n\tstatic fromICALJs(icalValue) {\n\t\treturn new PeriodValue(icalValue)\n\t}\n\n\t/**\n\t * Create a new PeriodValue object from start and end\n\t *\n\t * @param {object} data The destructuring object\n\t * @param {DateTimeValue} data.start The start of the period\n\t * @param {DateTimeValue} data.end The end of the period\n\t * @return {PeriodValue}\n\t */\n\tstatic fromDataWithEnd(data) {\n\t\tconst icalPeriod = ICAL.Period.fromData({\n\t\t\tstart: data.start.toICALJs(),\n\t\t\tend: data.end.toICALJs(),\n\t\t})\n\t\treturn PeriodValue.fromICALJs(icalPeriod)\n\t}\n\n\t/**\n\t * Create a new PeriodValue object from start and duration\n\t *\n\t * @param {object} data The destructuring object\n\t * @param {DateTimeValue} data.start The start of the period\n\t * @param {DurationValue} data.duration The duration of the period\n\t * @return {PeriodValue}\n\t */\n\tstatic fromDataWithDuration(data) {\n\t\tconst icalPeriod = ICAL.Period.fromData({\n\t\t\tstart: data.start.toICALJs(),\n\t\t\tduration: data.duration.toICALJs(),\n\t\t})\n\t\treturn PeriodValue.fromICALJs(icalPeriod)\n\t}\n\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport AbstractValue from './abstractValue.js'\nimport DateTimeValue from './dateTimeValue.js'\nimport { uc } from '../helpers/stringHelper.js'\nimport ICAL from 'ical.js'\n\nconst ALLOWED_FREQ = ['SECONDLY', 'MINUTELY', 'HOURLY', 'DAILY', 'WEEKLY', 'MONTHLY', 'YEARLY']\n\n/**\n * @class RecurValue\n * @classdesc Wrapper for ICAL.Recur\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.3.10\n * @url https://github.com/mozilla-comm/ical.js/blob/master/lib/ical/recur.js\n */\nexport default class RecurValue extends AbstractValue {\n\n\t/**\n\t * Constructor\n\t *\n\t * @param {ICAL.Recur} icalValue The ical.js rrule value\n\t * @param {DateTimeValue?} until The Until date\n\t */\n\tconstructor(icalValue, until) {\n\t\tsuper(icalValue)\n\n\t\t/**\n\t\t * DateTimeValue object for Until\n\t\t *\n\t\t * @type {DateTimeValue}\n\t\t * @private\n\t\t */\n\t\tthis._until = until\n\t}\n\n\t/**\n\t * Gets the stored interval of this recurrence rule\n\t *\n\t * @return {number}\n\t */\n\tget interval() {\n\t\treturn this._innerValue.interval\n\t}\n\n\t/**\n\t * Sets the stored interval of this recurrence rule\n\t *\n\t * @throws {ModificationNotAllowedError} if value is locked for modification\n\t * @param {number} interval New Interval to set\n\t */\n\tset interval(interval) {\n\t\tthis._modifyContent()\n\t\tthis._innerValue.interval = parseInt(interval, 10)\n\t}\n\n\t/**\n\t * Gets the weekstart used to calculate the recurrence expansion\n\t *\n\t * @return {number}\n\t */\n\tget weekStart() {\n\t\treturn this._innerValue.wkst\n\t}\n\n\t/**\n\t * Sets the weekstart used to calculate the recurrence expansion\n\t *\n\t * @throws {ModificationNotAllowedError} if value is locked for modification\n\t * @throws {TypeError} if weekstart out of range\n\t * @param {number} weekStart New start of week to set\n\t */\n\tset weekStart(weekStart) {\n\t\tthis._modifyContent()\n\t\tif (weekStart < DateTimeValue.SUNDAY || weekStart > DateTimeValue.SATURDAY) {\n\t\t\tthrow new TypeError('Weekstart out of range')\n\t\t}\n\n\t\tthis._innerValue.wkst = weekStart\n\t}\n\n\t/**\n\t * Gets the until value if set\n\t * The value is automatically locked.\n\t * If you want to edit the value, clone it and it as new until\n\t *\n\t * @return {null|DateTimeValue}\n\t */\n\tget until() {\n\t\tif (!this._until && this._innerValue.until) {\n\t\t\tthis._until = DateTimeValue.fromICALJs(this._innerValue.until)\n\t\t}\n\n\t\treturn this._until\n\t}\n\n\t/**\n\t * Sets the until value, automatically removes count\n\t *\n\t * @throws {ModificationNotAllowedError} if value is locked for modification\n\t * @param {DateTimeValue} until New until date to set\n\t */\n\tset until(until) {\n\t\tthis._modifyContent()\n\n\t\tif (this._until) {\n\t\t\tthis._until.lock()\n\t\t}\n\n\t\tthis._until = until\n\t\tthis._innerValue.count = null\n\t\tthis._innerValue.until = until.toICALJs()\n\t}\n\n\t/**\n\t * Gets the count value if set\n\t *\n\t * @return {null | number}\n\t */\n\tget count() {\n\t\treturn this._innerValue.count\n\t}\n\n\t/**\n\t * Sets the count value, automatically removes until\n\t *\n\t * @throws {ModificationNotAllowedError} if value is locked for modification\n\t * @param {number} count New occurrence limit to set\n\t */\n\tset count(count) {\n\t\tthis._modifyContent()\n\n\t\tif (this._until) {\n\t\t\tthis._until.lock()\n\t\t\tthis._until = null\n\t\t}\n\n\t\tthis._innerValue.until = null\n\t\tthis._innerValue.count = parseInt(count, 10)\n\t}\n\n\t/**\n\t * Gets the frequency of the recurrence rule\n\t *\n\t * @return {string} see\n\t */\n\tget frequency() {\n\t\treturn this._innerValue.freq\n\t}\n\n\t/**\n\t * Sets the frequency of the recurrence rule\n\t *\n\t * @throws {ModificationNotAllowedError} if value is locked for modification\n\t * @throws {TypeError} if frequency is unknown\n\t * @param {string} freq New frequency to set\n\t */\n\tset frequency(freq) {\n\t\tthis._modifyContent()\n\t\tif (!ALLOWED_FREQ.includes(freq)) {\n\t\t\tthrow new TypeError('Unknown frequency')\n\t\t}\n\n\t\tthis._innerValue.freq = freq\n\t}\n\n\t/**\n\t * Modifies this recurrence-value to unset count and until\n\t */\n\tsetToInfinite() {\n\t\tthis._modifyContent()\n\n\t\tif (this._until) {\n\t\t\tthis._until.lock()\n\t\t\tthis._until = null\n\t\t}\n\n\t\tthis._innerValue.until = null\n\t\tthis._innerValue.count = null\n\t}\n\n\t/**\n\t * Checks whether the stored rule is finite\n\t *\n\t * @return {boolean}\n\t */\n\tisFinite() {\n\t\treturn this._innerValue.isFinite()\n\t}\n\n\t/**\n\t * Checks whether the recurrence rule is limited by count\n\t *\n\t * @return {boolean}\n\t */\n\tisByCount() {\n\t\treturn this._innerValue.isByCount()\n\t}\n\n\t/**\n\t * Adds a part to a component to the recurrence-rule\n\t *\n\t * @throws {ModificationNotAllowedError} if value is locked for modification\n\t * @param {string} componentName The name of the recurrence-component to add\n\t * @param {string | number} value The value to add\n\t */\n\taddComponent(componentName, value) {\n\t\tthis._modifyContent()\n\t\tthis._innerValue.addComponent(componentName, value)\n\t}\n\n\t/**\n\t * Sets / overwrites a component to the recurrence-rule\n\t *\n\t * @throws {ModificationNotAllowedError} if value is locked for modification\n\t * @param {string} componentName The name of the component to set\n\t * @param {number[] | string[]} value The value to set\n\t */\n\tsetComponent(componentName, value) {\n\t\tthis._modifyContent()\n\n\t\tif (value.length === 0) {\n\t\t\tdelete this._innerValue.parts[componentName.toUpperCase()]\n\t\t} else {\n\t\t\tthis._innerValue.setComponent(componentName, value)\n\t\t}\n\t}\n\n\t/**\n\t * Removes all parts of a component\n\t *\n\t * @throws {ModificationNotAllowedError} if value is locked for modification\n\t * @param {string} componentName The name of the component to remove\n\t */\n\tremoveComponent(componentName) {\n\t\tdelete this._innerValue.parts[uc(componentName)]\n\t}\n\n\t/**\n\t * Gets all parts of a component\n\t *\n\t * @param {string} componentName The name of the component to get\n\t * @return {Array}\n\t */\n\tgetComponent(componentName) {\n\t\treturn this._innerValue.getComponent(componentName)\n\t}\n\n\t/**\n\t * Checks if this recurrence rule is valid according to RFC 5545\n\t *\n\t * @return {boolean}\n\t */\n\tisRuleValid() {\n\t\treturn true\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tlock() {\n\t\tsuper.lock()\n\n\t\tif (this._until) {\n\t\t\tthis._until.lock()\n\t\t}\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tunlock() {\n\t\tsuper.unlock()\n\n\t\tif (this._until) {\n\t\t\tthis._until.unlock()\n\t\t}\n\t}\n\n\t/**\n\t * clones this value\n\t *\n\t * @return {RecurValue}\n\t */\n\tclone() {\n\t\treturn RecurValue.fromICALJs(this._innerValue.clone())\n\t}\n\n\t/**\n\t * Create a new RecurValue object from a ICAL.Recur object\n\t *\n\t * @param {ICAL.Recur} icalValue The ICAL.JS Recur value\n\t * @param {DateTimeValue?} until The Until date\n\t * @return {RecurValue}\n\t */\n\tstatic fromICALJs(icalValue, until = null) {\n\t\treturn new RecurValue(icalValue, until)\n\t}\n\n\t/**\n\t * Create a new RecurValue object from a data object\n\t *\n\t * @param {object} data The destructuring object\n\t * @param {string=} data.freq FREQ part of RRULE\n\t * @param {number=} data.interval INTERVAL part of RRULE\n\t * @param {number=} data.wkst WEEKSTART part of RRULE\n\t * @param {DateTimeValue=} data.until UNTIL part of RRULE\n\t * @param {number=} data.count COUNT part of RRULE\n\t * @param {number[]=} data.bysecond BYSECOND part of RRULE\n\t * @param {number[]=} data.byminute BYMINUTE part of RRULE\n\t * @param {number[]=} data.byhour BYHOUR part of RRULE\n\t * @param {string[]=} data.byday BYDAY part of RRULE\n\t * @param {number[]=} data.bymonthday BYMONTHDAY part of RRULE\n\t * @param {number[]=} data.byyearday BYYEARDAY part of RRULE\n\t * @param {number[]=} data.byweekno BYWEEKNO part of RRULE\n\t * @param {number[]=} data.bymonth BYMONTH part of RRULE\n\t * @param {number[]=} data.bysetpos BYSETPOS part of RRULE\n\t * @return {RecurValue}\n\t */\n\tstatic fromData(data) {\n\t\tlet until = null\n\n\t\tif (data.until) {\n\t\t\tuntil = data.until\n\t\t\tdata.until = data.until.toICALJs()\n\t\t}\n\n\t\tconst icalRecur = ICAL.Recur.fromData(data)\n\t\treturn RecurValue.fromICALJs(icalRecur, until)\n\t}\n\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport AbstractValue from './abstractValue.js'\nimport ICAL from 'ical.js'\n\n/**\n * @class UTCOffsetValue\n * @classdesc Wrapper for ICAL.UtcOffset\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.3.14\n * @url https://github.com/mozilla-comm/ical.js/blob/master/lib/ical/utc_offset.js\n */\nexport default class UTCOffsetValue extends AbstractValue {\n\n\t/**\n\t * Gets the hour part of the offset-value\n\t *\n\t * @return {number}\n\t */\n\tget hours() {\n\t\treturn this._innerValue.hours\n\t}\n\n\t/**\n\t * Sets the hour part of the offset-value\n\t *\n\t * @throws {ModificationNotAllowedError} if value is locked for modification\n\t * @param {number} hours - New hours to set\n\t */\n\tset hours(hours) {\n\t\tthis._modifyContent()\n\t\tthis._innerValue.hours = hours\n\t}\n\n\t/**\n\t * Gets the minute part of the offset-value\n\t *\n\t * @return {number}\n\t */\n\tget minutes() {\n\t\treturn this._innerValue.minutes\n\t}\n\n\t/**\n\t * Sets the minute part of the offset-value\n\t *\n\t * @throws {ModificationNotAllowedError} if value is locked for modification\n\t * @param {number} minutes - New minutes to set\n\t */\n\tset minutes(minutes) {\n\t\tthis._modifyContent()\n\t\tthis._innerValue.minutes = minutes\n\t}\n\n\t/**\n\t * Gets the factor\n\t *\n\t * @return {number}\n\t */\n\tget factor() {\n\t\treturn this._innerValue.factor\n\t}\n\n\t/**\n\t * Sets the factor\n\t *\n\t * @throws {ModificationNotAllowedError} if value is locked for modification\n\t * @throws {TypeError} if factor is neither 1 nor -1\n\t * @param {number} factor - New factor to set, 1 for positive, -1 for negative\n\t */\n\tset factor(factor) {\n\t\tthis._modifyContent()\n\t\tif (factor !== 1 && factor !== -1) {\n\t\t\tthrow new TypeError('Factor may only be set to 1 or -1')\n\t\t}\n\n\t\tthis._innerValue.factor = factor\n\t}\n\n\t/**\n\t * Gets the total amount of seconds\n\t *\n\t * @return {number}\n\t */\n\tget totalSeconds() {\n\t\treturn this._innerValue.toSeconds()\n\t}\n\n\t/**\n\t * Sets the total amount of seconds\n\t *\n\t * @throws {ModificationNotAllowedError} if value is locked for modification\n\t * @param {number} totalSeconds - New number of total seconds to set\n\t */\n\tset totalSeconds(totalSeconds) {\n\t\tthis._modifyContent()\n\t\tthis._innerValue.fromSeconds(totalSeconds)\n\t}\n\n\t/**\n\t * Compares this UTCOffset to another one\n\t *\n\t * @param {UTCOffsetValue} other - The other UTCOffsetValue to compare with\n\t * @return {number} -1, 0 or 1 for less/equal/greater\n\t */\n\tcompare(other) {\n\t\treturn this._innerValue.compare(other.toICALJs())\n\t}\n\n\t/**\n\t * Clones this value\n\t *\n\t * @return {UTCOffsetValue}\n\t */\n\tclone() {\n\t\treturn UTCOffsetValue.fromICALJs(this._innerValue.clone())\n\t}\n\n\t/**\n\t * Create a new UTCOffsetValue object from a ICAL.UTCOffset object\n\t *\n\t * @param {ICAL.UtcOffset} icalValue - The ICAL.UtcOffset object to initialize this object from\n\t * @return {UTCOffsetValue}\n\t */\n\tstatic fromICALJs(icalValue) {\n\t\treturn new UTCOffsetValue(icalValue)\n\t}\n\n\t/**\n\t * Create a new UTCOffsetValue object from a data object\n\t *\n\t * @param {object} data - Object with data to create UTCOffsetValue object from\n\t * @param {number=} data.hours - The number of hours to set\n\t * @param {number=} data.minutes - The number of minutes to set\n\t * @param {number=} data.factor - The factor to use, 1 for positive, -1 for negative\n\t * @return {UTCOffsetValue}\n\t */\n\tstatic fromData(data) {\n\t\tconst icalUTCOffset = new ICAL.UtcOffset()\n\t\ticalUTCOffset.fromData(data)\n\t\treturn UTCOffsetValue.fromICALJs(icalUTCOffset)\n\t}\n\n\t/**\n\t * Create a new UTCOffsetValue object from an amount of seconds\n\t *w\n\t *\n\t * @param {number} seconds - The total number of seconds to create the UTCOffsetValue object from\n\t * @return {UTCOffsetValue}\n\t */\n\tstatic fromSeconds(seconds) {\n\t\tconst icalUTCOffset = ICAL.UtcOffset.fromSeconds(seconds)\n\t\treturn UTCOffsetValue.fromICALJs(icalUTCOffset)\n\t}\n\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nexport default class UnknownICALTypeError extends Error {}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @author Richard Steinmetz <richard@steinmetz.cloud>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport AbstractValue from './abstractValue.js'\nimport BinaryValue from './binaryValue.js'\nimport DurationValue from './durationValue.js'\nimport PeriodValue from './periodValue.js'\nimport RecurValue from './recurValue.js'\nimport DateTimeValue from './dateTimeValue.js'\nimport UTCOffsetValue from './utcOffsetValue.js'\nimport UnknownICALTypeError from '../errors/unknownICALTypeError.js'\nimport { lc } from '../helpers/stringHelper.js'\n\n/**\n *\n * @param {string} icaltype The icaltype to get a Value constructor for\n * @return {RecurValue|PeriodValue|BinaryValue|DurationValue|UTCOffsetValue|DateTimeValue}\n */\nexport function getConstructorForICALType(icaltype) {\n\tswitch (lc(icaltype)) {\n\tcase 'binary':\n\t\treturn BinaryValue\n\n\tcase 'date':\n\tcase 'date-time':\n\t\treturn DateTimeValue\n\n\tcase 'duration':\n\t\treturn DurationValue\n\n\tcase 'period':\n\t\treturn PeriodValue\n\n\tcase 'recur':\n\t\treturn RecurValue\n\n\tcase 'utc-offset':\n\t\treturn UTCOffsetValue\n\n\tdefault:\n\t\tthrow new UnknownICALTypeError()\n\t}\n}\n\nexport {\n\tAbstractValue,\n\tBinaryValue,\n\tDateTimeValue,\n\tDurationValue,\n\tPeriodValue,\n\tRecurValue,\n\tUTCOffsetValue,\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport ExpectedICalJSError from '../errors/expectedICalJSError.js'\nimport Parameter from '../parameters/parameter.js'\nimport { createProperty } from '../factories/icalFactory.js'\nimport { lc, uc } from '../helpers/stringHelper.js'\nimport { getConstructorForICALType } from '../values/index.js'\nimport AbstractValue from '../values/abstractValue.js'\nimport DateTimeValue from '../values/dateTimeValue.js'\nimport lockableTrait from '../traits/lockable.js'\nimport observerTrait from '../traits/observer.js'\nimport ICAL from 'ical.js'\n\n/**\n * @class Property\n * @classdesc This class represents a property as defined in RFC 5545 Section 3.5\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.5\n * @url https://github.com/mozilla-comm/ical.js/blob/master/lib/ical/property.js\n */\nexport default class Property extends observerTrait(lockableTrait(class {})) {\n\n\t/**\n\t * Constructor\n\t *\n\t * @param {string} name The name of the property\n\t * @param {string | number | AbstractValue | string[] | number[] | AbstractValue[] | null} value The value of the property\n\t * @param {Parameter[] | [string][]} parameters Array of parameters\n\t * @param {CalendarComponent|null} root The root of the calendar-document\n\t * @param {AbstractComponent|null} parent The parent-element of this property\n\t */\n\tconstructor(name, value = null, parameters = [], root = null, parent = null) {\n\t\tsuper()\n\n\t\t/**\n\t\t * Name of the property\n\t\t *\n\t\t * @type {string}\n\t\t * @protected\n\t\t */\n\t\tthis._name = uc(name)\n\n\t\t/**\n\t\t * Value of the property\n\t\t *\n\t\t * @type {string | number | AbstractValue | string[] | number[] | AbstractValue[] | null}\n\t\t * @protected\n\t\t */\n\t\tthis._value = value\n\n\t\t/**\n\t\t * List of parameters associated with this parameter\n\t\t *\n\t\t * @type {Map<string, Parameter>}\n\t\t */\n\t\tthis._parameters = new Map()\n\n\t\t/**\n\t\t * Root node of ical document\n\t\t *\n\t\t * @type {CalendarComponent|null}\n\t\t * @protected\n\t\t */\n\t\tthis._root = root\n\n\t\t/**\n\t\t * Parent node\n\t\t *\n\t\t * @type {AbstractComponent|null}\n\t\t * @protected\n\t\t */\n\t\tthis._parent = parent\n\n\t\tthis._setParametersFromConstructor(parameters)\n\t\tif (value instanceof AbstractValue) {\n\t\t\tvalue.subscribe(() => this._notifySubscribers())\n\t\t}\n\t}\n\n\t/**\n\t * Get property name\n\t *\n\t * @readonly\n\t * @return {string}\n\t */\n\tget name() {\n\t\treturn this._name\n\t}\n\n\t/**\n\t * Get parameter value\n\t *\n\t * @return {string | number | AbstractValue | string[] | number[] | AbstractValue[] | null}\n\t */\n\tget value() {\n\t\treturn this._value\n\t}\n\n\t/**\n\t * Set new parameter value\n\t *\n\t * @param {string | number | AbstractValue | string[] | number[] | AbstractValue[] | null} value The value of the property\n\t * @throws {ModificationNotAllowedError} if property is locked for modification\n\t */\n\tset value(value) {\n\t\tthis._modifyContent()\n\t\tthis._value = value\n\n\t\tif (value instanceof AbstractValue) {\n\t\t\tvalue.subscribe(() => this._notifySubscribers())\n\t\t}\n\t}\n\n\t/**\n\t * Gets the root of this property\n\t *\n\t * @return {CalendarComponent|null}\n\t */\n\tget root() {\n\t\treturn this._root\n\t}\n\n\t/**\n\t * Sets the root of this property\n\t *\n\t * @param {CalendarComponent|null} root The root of the calendar-document\n\t * @throws {ModificationNotAllowedError} if property is locked for modification\n\t */\n\tset root(root) {\n\t\tthis._modify()\n\t\tthis._root = root\n\t}\n\n\t/**\n\t * Gets the direct parent element of this property\n\t *\n\t * @return {AbstractComponent}\n\t */\n\tget parent() {\n\t\treturn this._parent\n\t}\n\n\t/**\n\t * Sets the direct parent element of this property\n\t *\n\t * @param {AbstractComponent|null} parent The parent element of this property\n\t * @throws {ModificationNotAllowedError} if property is locked for modification\n\t */\n\tset parent(parent) {\n\t\tthis._modify()\n\t\tthis._parent = parent\n\t}\n\n\t/**\n\t * Gets the first value of this property\n\t *\n\t * @return {null | string | number | AbstractValue}\n\t */\n\tgetFirstValue() {\n\t\tif (!this.isMultiValue()) {\n\t\t\treturn this.value\n\t\t} else {\n\t\t\tif (this.value.length > 0) {\n\t\t\t\treturn this.value[0]\n\t\t\t}\n\t\t}\n\n\t\treturn null\n\t}\n\n\t/**\n\t * Gets an iterator over all values\n\t */\n\t* getValueIterator() {\n\t\tif (this.isMultiValue()) {\n\t\t\tyield * this.value.slice()[Symbol.iterator]()\n\t\t} else {\n\t\t\tyield this.value\n\t\t}\n\t}\n\n\t/**\n\t * Adds a value to the multi-value property\n\t *\n\t * @param {string | AbstractValue} value Value to add\n\t */\n\taddValue(value) {\n\t\tif (!this.isMultiValue()) {\n\t\t\tthrow new TypeError('This is not a multivalue property')\n\t\t}\n\n\t\tthis._modifyContent()\n\t\tthis.value.push(value)\n\t}\n\n\t/**\n\t * Checks if a value is inside this multi-value property\n\t *\n\t * @param {string | AbstractValue} value Value to check for\n\t * @return {boolean}\n\t */\n\thasValue(value) {\n\t\tif (!this.isMultiValue()) {\n\t\t\tthrow new TypeError('This is not a multivalue property')\n\t\t}\n\n\t\treturn this.value.includes(value)\n\t}\n\n\t/**\n\t * Removes a value from this multi-value property\n\t *\n\t * @param {string | AbstractValue} value Value to remove\n\t */\n\tremoveValue(value) {\n\t\tif (!this.hasValue(value)) {\n\t\t\treturn\n\t\t}\n\n\t\tthis._modifyContent()\n\t\tconst index = this.value.indexOf(value)\n\t\tthis.value.splice(index, 1)\n\t}\n\n\t/**\n\t * Sets a parameter on this property\n\t *\n\t * @param {Parameter} parameter The parameter to set\n\t * @throws {ModificationNotAllowedError} if property is locked for modification\n\t */\n\tsetParameter(parameter) {\n\t\tthis._modify()\n\t\tthis._parameters.set(parameter.name, parameter)\n\t\tparameter.subscribe(() => this._notifySubscribers())\n\t}\n\n\t/**\n\t * Gets a parameter on this property by its name\n\t *\n\t * @param {string} parameterName Name of the parameter to get\n\t * @return {Parameter}\n\t */\n\tgetParameter(parameterName) {\n\t\treturn this._parameters.get(uc(parameterName))\n\t}\n\n\t/**\n\t * Gets an iterator over all available parameters\n\t */\n\t* getParametersIterator() {\n\t\tyield * this._parameters.values()\n\t}\n\n\t/**\n\t * Get first value of a parameter\n\t *\n\t * @param {string} parameterName Name of the parameter\n\t * @return {null | string}\n\t */\n\tgetParameterFirstValue(parameterName) {\n\t\tconst parameter = this.getParameter(parameterName)\n\t\tif (parameter instanceof Parameter) {\n\t\t\tif (parameter.isMultiValue()) {\n\t\t\t\treturn parameter.value[0]\n\t\t\t} else {\n\t\t\t\treturn parameter.value\n\t\t\t}\n\t\t}\n\n\t\treturn null\n\t}\n\n\t/**\n\t * Returns whether a parameter exists on this property\n\t *\n\t * @param {string} parameterName Name of the parameter\n\t * @return {boolean}\n\t */\n\thasParameter(parameterName) {\n\t\treturn this._parameters.has(uc(parameterName))\n\t}\n\n\t/**\n\t * Deletes a parameter on this property\n\t *\n\t * @param {string} parameterName Name of the parameter\n\t * @throws {ModificationNotAllowedError} if property is locked for modification\n\t */\n\tdeleteParameter(parameterName) {\n\t\tthis._modify()\n\t\tthis._parameters.delete(uc(parameterName))\n\t}\n\n\t/**\n\t * update a parameter if it exists,\n\t * create a new one if it doesn't\n\t *\n\t * @param {string} parameterName Name of the parameter\n\t * @param {string|Array|null} value Value to set\n\t * @throws {ModificationNotAllowedError} if property is locked for modification\n\t */\n\tupdateParameterIfExist(parameterName, value) {\n\t\tthis._modify()\n\t\tif (this.hasParameter(parameterName)) {\n\t\t\tconst parameter = this.getParameter(parameterName)\n\t\t\tparameter.value = value\n\t\t} else {\n\t\t\tconst parameter = new Parameter(uc(parameterName), value)\n\t\t\tthis.setParameter(parameter)\n\t\t}\n\t}\n\n\t/**\n\t * Returns whether or not the value is a multivalue\n\t *\n\t * @return {boolean}\n\t */\n\tisMultiValue() {\n\t\treturn Array.isArray(this._value)\n\t}\n\n\t/**\n\t * Returns whether or not this valus is decorated\n\t *\n\t * @return {boolean}\n\t */\n\tisDecoratedValue() {\n\t\tif (this.isMultiValue()) {\n\t\t\treturn this._value[0] instanceof AbstractValue\n\t\t} else {\n\t\t\treturn this._value instanceof AbstractValue\n\t\t}\n\t}\n\n\t/**\n\t * Marks this parameter is immutable\n\t * locks it against further modification\n\t */\n\tlock() {\n\t\tsuper.lock()\n\n\t\tfor (const parameter of this.getParametersIterator()) {\n\t\t\tparameter.lock()\n\t\t}\n\n\t\tif (this.isDecoratedValue()) {\n\t\t\tfor (const value of this.getValueIterator()) {\n\t\t\t\tvalue.lock()\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Marks this parameter as mutable\n\t * allowing further modification\n\t */\n\tunlock() {\n\t\tsuper.unlock()\n\n\t\tfor (const parameter of this.getParametersIterator()) {\n\t\t\tparameter.unlock()\n\t\t}\n\n\t\tif (this.isDecoratedValue()) {\n\t\t\tfor (const value of this.getValueIterator()) {\n\t\t\t\tvalue.unlock()\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Creates a copy of this parameter\n\t *\n\t * @return {Property}\n\t */\n\tclone() {\n\t\tconst parameters = []\n\t\tfor (const parameter of this.getParametersIterator()) {\n\t\t\tparameters.push(parameter.clone())\n\t\t}\n\n\t\treturn new this.constructor(this.name, this._cloneValue(), parameters, this.root, this.parent)\n\t}\n\n\t/**\n\t * Copies the values of this property\n\t *\n\t * @return {string | number | AbstractValue | string[] | number[] | AbstractValue[] | null}\n\t * @protected\n\t */\n\t_cloneValue() {\n\t\tif (this.isDecoratedValue()) {\n\t\t\tif (this.isMultiValue()) {\n\t\t\t\treturn this._value.map((val) => val.clone())\n\t\t\t} else {\n\t\t\t\treturn this._value.clone()\n\t\t\t}\n\t\t} else {\n\t\t\tif (this.isMultiValue()) {\n\t\t\t\t// only copy array values, don't copy array reference\n\t\t\t\treturn this._value.slice()\n\t\t\t} else {\n\t\t\t\treturn this._value\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Sets parameters from the constructor\n\t *\n\t * @param {Parameter[] | [string][]} parameters Array of parameters to set\n\t * @private\n\t */\n\t_setParametersFromConstructor(parameters) {\n\t\tparameters.forEach((parameter) => {\n\t\t\tif (!(parameter instanceof Parameter)) {\n\t\t\t\tparameter = new Parameter(parameter[0], parameter[1])\n\t\t\t}\n\n\t\t\tthis.setParameter(parameter)\n\t\t})\n\t}\n\n\t/**\n\t * Creates a new Component based on an ical object\n\t *\n\t * @param {ICAL.Property} icalProperty The ical.js property to initialise from\n\t * @param {CalendarComponent=} root The root of the calendar-document\n\t * @param {AbstractComponent=} parent The parent element of this property\n\t * @return {Property}\n\t */\n\tstatic fromICALJs(icalProperty, root = null, parent = null) {\n\t\tif (!(icalProperty instanceof ICAL.Property)) {\n\t\t\tthrow new ExpectedICalJSError()\n\t\t}\n\n\t\tlet value\n\t\tif (icalProperty.isDecorated) {\n\t\t\tconst constructor = getConstructorForICALType(icalProperty.getFirstValue().icaltype)\n\t\t\tif (icalProperty.isMultiValue) {\n\t\t\t\tvalue = icalProperty.getValues().map((val) => constructor.fromICALJs(val))\n\t\t\t} else {\n\t\t\t\tvalue = constructor.fromICALJs(icalProperty.getFirstValue())\n\t\t\t}\n\t\t} else {\n\t\t\tif (icalProperty.isMultiValue) {\n\t\t\t\tvalue = icalProperty.getValues()\n\t\t\t} else {\n\t\t\t\tvalue = icalProperty.getFirstValue()\n\t\t\t}\n\t\t}\n\n\t\tconst parameters = []\n\t\tconst paramNames = Object.keys(Object.assign({}, icalProperty.toJSON()[1]))\n\t\tparamNames.forEach((paramName) => {\n\t\t\t// Timezone id is handled by DateTimeValue\n\t\t\tif (uc(paramName) === 'TZID') {\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\tparameters.push([paramName, icalProperty.getParameter(paramName)])\n\t\t})\n\n\t\treturn new this(icalProperty.name, value, parameters, root, parent)\n\t}\n\n\t/**\n\t * Returns an ICAL.js property based on this Property\n\t *\n\t * @return {ICAL.Property}\n\t */\n\ttoICALJs() {\n\t\tconst icalProperty = createProperty(lc(this.name))\n\n\t\tif (this.isMultiValue()) {\n\t\t\tif (this.isDecoratedValue()) {\n\t\t\t\ticalProperty.setValues(this.value.map((val) => val.toICALJs()))\n\t\t\t} else {\n\t\t\t\ticalProperty.setValues(this.value)\n\t\t\t}\n\t\t} else {\n\t\t\tif (this.isDecoratedValue()) {\n\t\t\t\ticalProperty.setValue(this.value.toICALJs())\n\t\t\t} else {\n\t\t\t\ticalProperty.setValue(this.value)\n\n\t\t\t}\n\t\t}\n\n\t\tfor (const parameter of this.getParametersIterator()) {\n\t\t\ticalProperty.setParameter(lc(parameter.name), parameter.value)\n\t\t}\n\n\t\tconst firstValue = this.getFirstValue()\n\t\tif (firstValue instanceof DateTimeValue\n\t\t\t&& firstValue.timezoneId !== 'floating'\n\t\t\t&& firstValue.timezoneId !== 'UTC'\n\t\t\t&& !firstValue.isDate) {\n\t\t\ticalProperty.setParameter('tzid', firstValue.timezoneId)\n\t\t}\n\n\t\treturn icalProperty\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\t_modifyContent() {\n\t\tsuper._modifyContent()\n\t\tthis._notifySubscribers()\n\t}\n\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport Property from './property.js'\nimport BinaryValue from '../values/binaryValue.js'\n\n/**\n * @class AttachmentProperty\n * @classdesc This class represents an attachment property as defined in RFC 5545 Section 3.8.1.1\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.1.1\n */\nexport default class AttachmentProperty extends Property {\n\n\t/**\n\t * Gets the format-type of this attachment\n\t *\n\t * @return {string}\n\t */\n\tget formatType() {\n\t\treturn this.getParameterFirstValue('FMTTYPE')\n\t}\n\n\t/**\n\t * Sets the format-type of this attachment\n\t *\n\t * @param {string} fmtType Mime-type of attachment\n\t */\n\tset formatType(fmtType) {\n\t\tthis.updateParameterIfExist('FMTTYPE', fmtType)\n\t}\n\n\t/**\n\t * Gets the uri of this attachment\n\t *\n\t * @return {string | null}\n\t */\n\tget uri() {\n\t\tif (this._value instanceof BinaryValue) {\n\t\t\treturn null\n\t\t}\n\n\t\treturn this._value\n\t}\n\n\t/**\n\t * Sets the uri of this attachment\n\t *\n\t * @param {string} uri Link to attachment if applicable\n\t */\n\tset uri(uri) {\n\t\tthis.value = uri\n\t}\n\n\t/**\n\t * Gets the encoding of this attachment\n\t *\n\t * @return {string|null}\n\t */\n\tget encoding() {\n\t\tif (this._value instanceof BinaryValue) {\n\t\t\treturn 'BASE64'\n\t\t}\n\n\t\treturn null\n\t}\n\n\t/**\n\t * Gets the data stored in this attachment\n\t *\n\t * @return {string | null}\n\t */\n\tget data() {\n\t\tif (this._value instanceof BinaryValue) {\n\t\t\treturn this._value.value\n\t\t}\n\n\t\treturn null\n\t}\n\n\t/**\n\t * Sets the data stored in this attachment\n\t *\n\t * @param {string} data The data of the attachment\n\t */\n\tset data(data) {\n\t\tif (this.value instanceof BinaryValue) {\n\t\t\tthis.value.value = data\n\t\t} else {\n\t\t\tthis.value = BinaryValue.fromDecodedValue(data)\n\t\t}\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\ttoICALJs() {\n\t\tconst icalProperty = super.toICALJs()\n\t\tif (this._value instanceof BinaryValue && this.getParameterFirstValue('ENCODING') !== 'BASE64') {\n\t\t\ticalProperty.setParameter('ENCODING', 'BASE64')\n\t\t}\n\n\t\treturn icalProperty\n\t}\n\n\t/**\n\t * Creates a new AttachmentProperty based on data\n\t *\n\t * @param {string} data The data of the attachment\n\t * @param {string=} formatType The mime-type of the data\n\t * @return {AttachmentProperty}\n\t */\n\tstatic fromData(data, formatType = null) {\n\t\tconst binaryValue = BinaryValue.fromDecodedValue(data)\n\t\tconst property = new AttachmentProperty('ATTACH', binaryValue)\n\n\t\tif (formatType) {\n\t\t\tproperty.formatType = formatType\n\t\t}\n\n\t\treturn property\n\t}\n\n\t/**\n\t * Creates a new AttachmentProperty based on a link\n\t *\n\t * @param {string} uri The URI for the attachment\n\t * @param {string=} formatType The mime-type of the uri\n\t * @return {AttachmentProperty}\n\t */\n\tstatic fromLink(uri, formatType = null) {\n\t\tconst property = new AttachmentProperty('ATTACH', uri)\n\n\t\tif (formatType) {\n\t\t\tproperty.formatType = formatType\n\t\t}\n\n\t\treturn property\n\t}\n\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n * @author Richard Steinmetz <richard@steinmetz.cloud>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport Property from './property.js'\nimport { startStringWith, uc } from '../helpers/stringHelper.js'\n\n/**\n * @class AttendeeProperty\n * @classdesc This class represents an attendee property as defined in RFC 5545 Section 3.8.4.1\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.4.1\n */\nexport default class AttendeeProperty extends Property {\n\n\t/**\n\t * Returns the role of the attendee.\n\t *\n\t * @return {string}\n\t */\n\tget role() {\n\t\tconst allowed = ['CHAIR', 'REQ-PARTICIPANT', 'OPT-PARTICIPANT', 'NON-PARTICIPANT']\n\t\tconst defaultValue = 'REQ-PARTICIPANT'\n\n\t\tif (this.hasParameter('ROLE')) {\n\t\t\tconst value = this.getParameterFirstValue('ROLE')\n\t\t\tif (allowed.includes(value)) {\n\t\t\t\treturn value\n\t\t\t}\n\t\t}\n\n\t\treturn defaultValue\n\t}\n\n\t/**\n\t * Sets new role of the attendee\n\t *\n\t * @param {string} role The role of the attendee (e.g. CHAIR, REQ-PARTICIPANT)\n\t */\n\tset role(role) {\n\t\tthis.updateParameterIfExist('ROLE', role)\n\t}\n\n\t/**\n\t * Returns the calendar-user-type of an attendee\n\t *\n\t * @return {string}\n\t */\n\tget userType() {\n\t\tconst allowed = ['INDIVIDUAL', 'GROUP', 'RESOURCE', 'ROOM', 'UNKNOWN']\n\n\t\tif (!this.hasParameter('CUTYPE')) {\n\t\t\treturn 'INDIVIDUAL'\n\t\t} else {\n\t\t\tconst value = this.getParameterFirstValue('CUTYPE')\n\t\t\tif (allowed.includes(value)) {\n\t\t\t\treturn value\n\t\t\t}\n\n\t\t\treturn 'UNKNOWN'\n\t\t}\n\t}\n\n\t/**\n\t * Sets new calendar-user-type of attendee\n\t *\n\t * @param {string} userType The type of user (e.g. INDIVIDUAL, GROUP)\n\t */\n\tset userType(userType) {\n\t\tthis.updateParameterIfExist('CUTYPE', userType)\n\t}\n\n\t/**\n\t * Returns the \"Répondez s'il vous plaît\" value for attendee\n\t *\n\t * @return {boolean}\n\t */\n\tget rsvp() {\n\t\tif (!this.hasParameter('RSVP')) {\n\t\t\treturn false\n\t\t} else {\n\t\t\tconst value = this.getParameterFirstValue('RSVP')\n\t\t\treturn uc(value) === 'TRUE'\n\t\t}\n\t}\n\n\t/**\n\t * Updates the \"Répondez s'il vous plaît\" value for attendee\n\t *\n\t * @param {boolean} rsvp Whether or not to send out an invitation\n\t */\n\tset rsvp(rsvp) {\n\t\tthis.updateParameterIfExist('RSVP', rsvp ? 'TRUE' : 'FALSE')\n\t}\n\n\t/**\n\t * Returns the common-name of the attendee\n\t *\n\t * @return {string|null}\n\t */\n\tget commonName() {\n\t\treturn this.getParameterFirstValue('CN')\n\t}\n\n\t/**\n\t * Sets a new common-name of the attendee\n\t *\n\t * @param {string} commonName The display name of the attendee\n\t */\n\tset commonName(commonName) {\n\t\tthis.updateParameterIfExist('CN', commonName)\n\t}\n\n\t/**\n\t * Returns the participation-status of the attendee\n\t *\n\t * @return {string}\n\t */\n\tget participationStatus() {\n\t\tlet vobjectType\n\t\tif (this.parent) {\n\t\t\tvobjectType = this.parent.name\n\t\t} else {\n\t\t\t// let's assume we are inside an event\n\t\t\t// if we don't know better\n\t\t\tvobjectType = 'VEVENT'\n\t\t}\n\n\t\tconst allowed = {\n\t\t\tVEVENT: ['NEEDS-ACTION', 'ACCEPTED', 'DECLINED', 'TENTATIVE', 'DELEGATED'],\n\t\t\tVJOURNAL: ['NEEDS-ACTION', 'ACCEPTED', 'DECLINED'],\n\t\t\tVTODO: ['NEEDS-ACTION', 'ACCEPTED', 'DECLINED', 'TENTATIVE', 'DELEGATED', 'COMPLETED', 'IN-PROCESS'],\n\t\t}\n\n\t\tif (!this.hasParameter('PARTSTAT')) {\n\t\t\treturn 'NEEDS-ACTION'\n\t\t} else {\n\t\t\tconst value = this.getParameterFirstValue('PARTSTAT')\n\t\t\tif (allowed[vobjectType].includes(value)) {\n\t\t\t\treturn value\n\t\t\t}\n\n\t\t\treturn 'NEEDS-ACTION'\n\t\t}\n\t}\n\n\t/**\n\t * Sets a new participation-status of the attendee\n\t *\n\t * @param {string} participationStatus The participation status (e.g. ACCEPTED, DECLINED)\n\t */\n\tset participationStatus(participationStatus) {\n\t\tthis.updateParameterIfExist('PARTSTAT', participationStatus)\n\t}\n\n\t/**\n\t * Gets this attendee's language\n\t *\n\t * @return {string}\n\t */\n\tget language() {\n\t\treturn this.getParameterFirstValue('LANGUAGE')\n\t}\n\n\t/**\n\t * Sets this attendee's language\n\t * This can be used to influence the language of the invitation email\n\t *\n\t * @param {string} language The preferred language of the attendee\n\t */\n\tset language(language) {\n\t\tthis.updateParameterIfExist('LANGUAGE', language)\n\t}\n\n\t/**\n\t * Gets the email of the attendee\n\t *\n\t * @return {string}\n\t */\n\tget email() {\n\t\treturn this.value\n\t}\n\n\t/**\n\t * Sets the email address of the attendee\n\t *\n\t * @param {string} email The e-email address of the attendee\n\t */\n\tset email(email) {\n\t\tthis.value = startStringWith(email, 'mailto:')\n\t}\n\n\t/**\n\t * Gets the email addresses of groups the attendee is a part of\n\t *\n\t * @return {string[]|null} The email addresses of the groups\n\t */\n\tget member() {\n\t\treturn this.getParameter('MEMBER')?.value ?? null\n\t}\n\n\t/**\n\t * Sets the email addresses of groups the attendee is a part of\n\t *\n\t * @param {string[]} members The email addresses of the groups\n\t */\n\tset member(members) {\n\t\tmembers = members.map(member => startStringWith(member, 'mailto:'))\n\t\tthis.updateParameterIfExist('MEMBER', members)\n\t}\n\n\t/**\n\t * Is this attendee the organizer?\n\t *\n\t * @return {boolean}\n\t */\n\tisOrganizer() {\n\t\treturn this._name === 'ORGANIZER'\n\t}\n\n\t/**\n\t * Creates a new AttendeeProperty from name and email\n\t *\n\t * @param {string} name The display name\n\t * @param {string} email The email address\n\t * @param {boolean=} isOrganizer Whether this is the organizer or an attendee\n\t * @return {AttendeeProperty}\n\t */\n\tstatic fromNameAndEMail(name, email, isOrganizer = false) {\n\t\tconst propertyName = isOrganizer\n\t\t\t? 'ORGANIZER'\n\t\t\t: 'ATTENDEE'\n\n\t\temail = startStringWith(email, 'mailto:')\n\t\treturn new AttendeeProperty(propertyName, email, [['CN', name]])\n\t}\n\n\t/**\n\t * Creates a new AttendeeProperty from name, email, role, userType and rsvp\n\t *\n\t * @param {string} name The display name\n\t * @param {string} email The email address\n\t * @param {string} role The role\n\t * @param {string} userType The type of user\n\t * @param {boolean} rsvp Whether to send out an invitation\n\t * @param {boolean=} isOrganizer Whether this is the organizer or an attendee\n\t * @return {AttendeeProperty}\n\t */\n\tstatic fromNameEMailRoleUserTypeAndRSVP(name, email, role, userType, rsvp, isOrganizer = false) {\n\t\tconst propertyName = isOrganizer\n\t\t\t? 'ORGANIZER'\n\t\t\t: 'ATTENDEE'\n\n\t\temail = startStringWith(email, 'mailto:')\n\t\treturn new AttendeeProperty(propertyName, email, [\n\t\t\t['CN', name],\n\t\t\t['ROLE', role],\n\t\t\t['CUTYPE', userType],\n\t\t\t['RSVP', rsvp ? 'TRUE' : 'FALSE'],\n\t\t])\n\t}\n\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport Property from './property.js'\nimport ICAL from 'ical.js'\n\nICAL.design.icalendar.property.conference = {\n\tdefaultType: 'uri',\n}\n\nICAL.design.icalendar.param.feature = {\n\tvalueType: 'cal-address',\n\tmultiValue: ',',\n}\n\n/**\n * @class ConferenceProperty\n *\n * @url https://tools.ietf.org/html/rfc7986#section-5.11\n */\nexport default class ConferenceProperty extends Property {\n\n\t/**\n\t * Iterator that iterates over all supported features\n\t * of the conference system\n\t */\n\t* getFeatureIterator() {\n\t\tif (!this.hasParameter('FEATURE')) {\n\t\t\treturn\n\t\t}\n\n\t\tconst parameter = this.getParameter('FEATURE')\n\t\tyield * parameter.getValueIterator()\n\t}\n\n\t/**\n\t * Lists all supported features of the conference system\n\t *\n\t * @return {string[]}\n\t */\n\tlistAllFeatures() {\n\t\tif (!this.hasParameter('FEATURE')) {\n\t\t\treturn []\n\t\t}\n\n\t\treturn this.getParameter('FEATURE').value.slice()\n\t}\n\n\t/**\n\t * Adds a supported feature to the conference system\n\t *\n\t * @param {string} featureToAdd Feature to add\n\t */\n\taddFeature(featureToAdd) {\n\t\tthis._modify()\n\t\tif (!this.hasParameter('FEATURE')) {\n\t\t\tthis.updateParameterIfExist('FEATURE', [featureToAdd])\n\t\t} else {\n\t\t\tif (this.hasFeature(featureToAdd)) {\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\tconst parameter = this.getParameter('FEATURE')\n\t\t\tparameter.value.push(featureToAdd)\n\t\t}\n\t}\n\n\t/**\n\t * Removes a supported feature\n\t *\n\t * @param {string} feature The feature to remove\n\t */\n\tremoveFeature(feature) {\n\t\tthis._modify()\n\t\tif (!this.hasFeature(feature)) {\n\t\t\treturn\n\t\t}\n\n\t\tconst parameter = this.getParameter('FEATURE')\n\t\tconst index = parameter.value.indexOf(feature)\n\t\tparameter.value.splice(index, 1)\n\t}\n\n\t/**\n\t * Removes all supported features from this conference system\n\t */\n\tclearAllFeatures() {\n\t\tthis.deleteParameter('FEATURE')\n\t}\n\n\t/**\n\t * Check if this conference system supports a feature\n\t *\n\t * @param {string} feature The feature to check\n\t * @return {boolean}\n\t */\n\thasFeature(feature) {\n\t\tif (!this.hasParameter('FEATURE')) {\n\t\t\treturn false\n\t\t}\n\n\t\tconst parameter = this.getParameter('FEATURE')\n\t\tif (!Array.isArray(parameter.value)) {\n\t\t\treturn false\n\t\t}\n\n\t\treturn parameter.value.includes(feature)\n\t}\n\n\t/**\n\t * Gets label for the conference system\n\t *\n\t * @return {string}\n\t */\n\tget label() {\n\t\treturn this.getParameterFirstValue('LABEL')\n\t}\n\n\t/**\n\t * Updates the label for the conference system\n\t *\n\t * @param {string} label The label to set\n\t */\n\tset label(label) {\n\t\tthis.updateParameterIfExist('LABEL', label)\n\t}\n\n\t/**\n\t * Gets the uri for this conference system\n\t */\n\tget uri() {\n\t\treturn this.value\n\t}\n\n\t/**\n\t * Sets the uri for this conference system\n\t *\n\t * @param {string} uri The URI to set\n\t */\n\tset uri(uri) {\n\t\tthis.value = uri\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\ttoICALJs() {\n\t\tconst icalProperty = super.toICALJs()\n\t\ticalProperty.setParameter('value', 'URI')\n\n\t\treturn icalProperty\n\t}\n\n\t/**\n\t * Creates a new ConferenceProperty based on URI, label and features\n\t *\n\t * @param {string} uri URI of the Conference\n\t * @param {string=} label Label of the conference\n\t * @param {string[]=} features Features of the conference\n\t * @return {ConferenceProperty}\n\t */\n\tstatic fromURILabelAndFeatures(uri, label = null, features = null) {\n\t\tconst property = new ConferenceProperty('CONFERENCE', uri)\n\n\t\tif (label) {\n\t\t\tproperty.updateParameterIfExist('label', label)\n\t\t}\n\n\t\tif (features) {\n\t\t\tproperty.updateParameterIfExist('feature', features)\n\t\t}\n\n\t\treturn property\n\t}\n\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport Property from './property.js'\n\n/**\n * @class FreeBusyProperty\n * @classdesc\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.2.6\n */\nexport default class FreeBusyProperty extends Property {\n\n\t/**\n\t * Gets the type of this FreeBusyProperty\n\t *\n\t * @return {string}\n\t */\n\tget type() {\n\t\tconst allowed = ['FREE', 'BUSY', 'BUSY-UNAVAILABLE', 'BUSY-TENTATIVE']\n\t\tconst defaultValue = 'BUSY'\n\n\t\tif (this.hasParameter('FBTYPE')) {\n\t\t\tconst value = this.getParameterFirstValue('FBTYPE')\n\t\t\tif (allowed.includes(value)) {\n\t\t\t\treturn value\n\t\t\t}\n\t\t}\n\n\t\treturn defaultValue\n\t}\n\n\t/**\n\t * Sets the type of this FreeBusyProperty\n\t *\n\t * @param {string} type The type of information (e.g. FREE, BUSY, etc.)\n\t */\n\tset type(type) {\n\t\tthis.updateParameterIfExist('FBTYPE', type)\n\t}\n\n\t/**\n\t * Creates a new FreeBusyProperty based on period and type\n\t *\n\t * @param {PeriodValue} period The period for FreeBusy Information\n\t * @param {string} type The type of the period\n\t * @return {FreeBusyProperty}\n\t */\n\tstatic fromPeriodAndType(period, type) {\n\t\treturn new FreeBusyProperty('FREEBUSY', period, [['fbtype', type]])\n\t}\n\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport Property from './property.js'\nimport { createProperty } from '../factories/icalFactory.js'\nimport { lc } from '../helpers/stringHelper.js'\n\n/**\n * @class GeoProperty\n * @classdesc\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.1.6\n */\nexport default class GeoProperty extends Property {\n\n\t/**\n\t * @inheritDoc\n\t */\n\tconstructor(name, value = [0, 0], parameters = [], root = null, parent = null) {\n\t\tsuper(name, value, parameters, root, parent)\n\t}\n\n\t/**\n\t * Gets the latitude stored in this property\n\t *\n\t * @return {number}\n\t */\n\tget latitude() {\n\t\treturn this._value[0]\n\t}\n\n\t/**\n\t * Sets the latitude stored in this property\n\t *\n\t * @param {string | number} lat Latitude\n\t */\n\tset latitude(lat) {\n\t\tthis._modifyContent()\n\t\tif (typeof lat !== 'number') {\n\t\t\tlat = parseFloat(lat)\n\t\t}\n\n\t\tthis._value[0] = lat\n\t}\n\n\t/**\n\t * Gets the longitude stored in this property\n\t */\n\tget longitude() {\n\t\treturn this._value[1]\n\t}\n\n\t/**\n\t * Sets the longitude stored in this property\n\t *\n\t * @param {string | number} long Longitude\n\t */\n\tset longitude(long) {\n\t\tthis._modifyContent()\n\t\tif (typeof long !== 'number') {\n\t\t\tlong = parseFloat(long)\n\t\t}\n\n\t\tthis._value[1] = long\n\t}\n\n\t/**\n\t * @inheritDoc\n\t *\n\t * TODO: this is an ugly hack right now.\n\t * As soon as the value is an array, we assume it's multivalue\n\t * but GEO is a (the one and only besides request-status) structured value and is also\n\t * stored inside an array.\n\t *\n\t * Calling icalProperty.setValues will throw an error\n\t */\n\ttoICALJs() {\n\t\tconst icalProperty = createProperty(lc(this.name))\n\t\ticalProperty.setValue(this.value)\n\n\t\tthis._parameters.forEach((parameter) => {\n\t\t\ticalProperty.setParameter(lc(parameter.name), parameter.value)\n\t\t})\n\n\t\treturn icalProperty\n\t}\n\n\t/**\n\t * Creates a new GeoProperty based on a latitude and a longitude value\n\t *\n\t * @param {number} lat Latitude\n\t * @param {number} long Longitude\n\t * @return {GeoProperty}\n\t */\n\tstatic fromPosition(lat, long) {\n\t\treturn new GeoProperty('GEO', [lat, long])\n\t}\n\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport AttachmentProperty from './attachmentProperty.js'\nimport BinaryValue from '../values/binaryValue.js'\n\n/**\n * @class ImageProperty\n *\n * @url https://tools.ietf.org/html/rfc7986#section-5.10\n */\nexport default class ImageProperty extends AttachmentProperty {\n\n\t/**\n\t * Gets the image-type\n\t */\n\tget display() {\n\t\treturn this.getParameterFirstValue('DISPLAY') || 'BADGE'\n\t}\n\n\t/**\n\t * Gets the image-type\n\t *\n\t * @param {string} display The display-type image is optimized for\n\t */\n\tset display(display) {\n\t\tthis.updateParameterIfExist('DISPLAY', display)\n\t}\n\n\t/**\n\t * Creates a new ImageProperty based on data\n\t *\n\t * @param {string} data The data of the image\n\t * @param {string=} display The display-type it's optimized for\n\t * @param {string=} formatType The mime-type of the image\n\t * @return {ImageProperty}\n\t */\n\tstatic fromData(data, display = null, formatType = null) {\n\t\tconst binaryValue = BinaryValue.fromDecodedValue(data)\n\t\tconst property = new ImageProperty('IMAGE', binaryValue)\n\n\t\tif (display) {\n\t\t\tproperty.display = display\n\t\t}\n\n\t\tif (formatType) {\n\t\t\tproperty.formatType = formatType\n\t\t}\n\n\t\treturn property\n\t}\n\n\t/**\n\t * Creates a new ImageProperty based on a link\n\t *\n\t * @param {string} uri The uri of the image\n\t * @param {string=} display The display-type it's optimized for\n\t * @param {string=} formatType The mime-type of the image\n\t * @return {ImageProperty}\n\t */\n\tstatic fromLink(uri, display = null, formatType = null) {\n\t\tconst property = new ImageProperty('IMAGE', uri)\n\n\t\tif (display) {\n\t\t\tproperty.display = display\n\t\t}\n\n\t\tif (formatType) {\n\t\t\tproperty.formatType = formatType\n\t\t}\n\n\t\treturn property\n\t}\n\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport Property from './property.js'\n\n/**\n * @class RelationProperty\n * @classdesc\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.4.5\n */\nexport default class RelationProperty extends Property {\n\n\t/**\n\t * Get's the relation-type of this related-to property\n\t *\n\t * @return {string}\n\t */\n\tget relationType() {\n\t\tconst allowed = ['PARENT', 'CHILD', 'SIBLING']\n\t\tconst defaultValue = 'PARENT'\n\n\t\tif (!this.hasParameter('RELTYPE')) {\n\t\t\treturn defaultValue\n\t\t} else {\n\t\t\tconst value = this.getParameterFirstValue('RELTYPE')\n\t\t\tif (allowed.includes(value)) {\n\t\t\t\treturn value\n\t\t\t}\n\n\t\t\treturn defaultValue\n\t\t}\n\t}\n\n\t/**\n\t * Sets a new relation type\n\t *\n\t * @param {string} relationType The type of relation (e.g. SIBLING, PARENT, etc.)\n\t */\n\tset relationType(relationType) {\n\t\tthis.updateParameterIfExist('RELTYPE', relationType)\n\t}\n\n\t/**\n\t * Gets Id of related object\n\t *\n\t * @return {string}\n\t */\n\tget relatedId() {\n\t\treturn this.value\n\t}\n\n\t/**\n\t * Sets a new related id\n\t *\n\t * @param {string} relatedId The Id of the related document\n\t */\n\tset relatedId(relatedId) {\n\t\tthis.value = relatedId\n\t}\n\n\t/**\n\t * Creates a new RELATED-TO property based on a relation-type and id\n\t *\n\t * @param {string} relType The type of the relation (e.g. SIBLING, CHILD)\n\t * @param {string} relId The Id of the related document\n\t * @return {RelationProperty}\n\t */\n\tstatic fromRelTypeAndId(relType, relId) {\n\t\treturn new RelationProperty('RELATED-TO', relId, [['RELTYPE', relType]])\n\t}\n\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport Property from './property.js'\nimport { createProperty } from '../factories/icalFactory.js'\nimport { lc } from '../helpers/stringHelper.js'\n\n/**\n * @class RequestStatusProperty\n * @classdesc\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.8.3\n */\nexport default class RequestStatusProperty extends Property {\n\n\t/**\n\t * @inheritDoc\n\t */\n\tconstructor(name, value = ['1', 'Pending'], parameters = [], root = null, parent = null) {\n\t\tsuper(name, value, parameters, root, parent)\n\t}\n\n\t/**\n\t * Gets the status code of the request status\n\t *\n\t * @return {number}\n\t */\n\tget statusCode() {\n\t\treturn parseFloat(this.value[0])\n\t}\n\n\t/**\n\t * Sets the status code of the request status\n\t *\n\t * @param {number} statusCode The statusCode of the request\n\t */\n\tset statusCode(statusCode) {\n\t\tthis._modifyContent()\n\n\t\tthis.value[0] = statusCode.toString()\n\n\t\t// This makes sure 2.0 is actually saved as 2.0, not 2\n\t\tif (statusCode === Math.floor(statusCode)) {\n\t\t\tthis.value[0] += '.0'\n\t\t}\n\t}\n\n\t/**\n\t * Gets the status message of the request status\n\t *\n\t * @return {string}\n\t */\n\tget statusMessage() {\n\t\treturn this.value[1]\n\t}\n\n\t/**\n\t * Sets the status message of the request status\n\t *\n\t * @param {string} statusMessage The message of the request\n\t */\n\tset statusMessage(statusMessage) {\n\t\tthis._modifyContent()\n\t\tthis.value[1] = statusMessage\n\t}\n\n\t/**\n\t * Gets the exception data of the request status if available\n\t *\n\t * @return {null | string}\n\t */\n\tget exceptionData() {\n\t\tif (!this.value[2]) {\n\t\t\treturn null\n\t\t}\n\n\t\treturn this.value[2]\n\t}\n\n\t/**\n\t * Sets the exception dtat of the request status\n\t *\n\t * @param {string} exceptionData The additional exception-data\n\t */\n\tset exceptionData(exceptionData) {\n\t\tthis._modifyContent()\n\t\tthis.value[2] = exceptionData\n\t}\n\n\t/**\n\t * Check if request is pending\n\t *\n\t * @return {boolean}\n\t */\n\tisPending() {\n\t\treturn this.statusCode >= 1 && this.statusCode < 2\n\t}\n\n\t/**\n\t * Check if request was successful\n\t *\n\t * @return {boolean}\n\t */\n\tisSuccessful() {\n\t\treturn this.statusCode >= 2 && this.statusCode < 3\n\t}\n\n\t/**\n\t * Check if a client error occurred\n\t *\n\t * @return {boolean}\n\t */\n\tisClientError() {\n\t\treturn this.statusCode >= 3 && this.statusCode < 4\n\t}\n\n\t/**\n\t * Check if a scheduling error occurred\n\t *\n\t * @return {boolean}\n\t */\n\tisSchedulingError() {\n\t\treturn this.statusCode >= 4 && this.statusCode < 5\n\t}\n\n\t/**\n\t * @inheritDoc\n\t *\n\t * TODO: this is an ugly hack right now.\n\t * As soon as the value is an array, we assume it's multivalue\n\t * but REQUEST-STATUS is a (the one and only besides GEO) structured value and is also\n\t * stored inside an array.\n\t *\n\t * Calling icalProperty.setValues will throw an error\n\t */\n\ttoICALJs() {\n\t\tconst icalProperty = createProperty(lc(this.name))\n\t\ticalProperty.setValue(this.value)\n\n\t\tthis._parameters.forEach((parameter) => {\n\t\t\ticalProperty.setParameter(lc(parameter.name), parameter.value)\n\t\t})\n\n\t\treturn icalProperty\n\t}\n\n\t/**\n\t * Creates a new RequestStatusProperty from a code and a status message\n\t *\n\t * @param {number} code The status-code of the request\n\t * @param {string} message The message of the request\n\t * @return {RequestStatusProperty}\n\t */\n\tstatic fromCodeAndMessage(code, message) {\n\t\treturn new RequestStatusProperty('REQUEST-STATUS', [code.toString(), message])\n\t}\n\n}\n\n// All request statuses registered in RFC 5546\nRequestStatusProperty.SUCCESS = [2.0, 'Success']\nRequestStatusProperty.SUCCESS_FALLBACK = [2.1, 'Success, but fallback taken on one or more property values.']\nRequestStatusProperty.SUCCESS_PROP_IGNORED = [2.2, 'Success; invalid property ignored.']\nRequestStatusProperty.SUCCESS_PROPPARAM_IGNORED = [2.3, 'Success; invalid property parameter ignored.']\nRequestStatusProperty.SUCCESS_NONSTANDARD_PROP_IGNORED = [2.4, 'Success; unknown, non-standard property ignored.']\nRequestStatusProperty.SUCCESS_NONSTANDARD_PROPPARAM_IGNORED = [2.5, 'Success; unknown, non-standard property value ignored.']\nRequestStatusProperty.SUCCESS_COMP_IGNORED = [2.6, 'Success; invalid calendar component ignored.']\nRequestStatusProperty.SUCCESS_FORWARDED = [2.7, 'Success; request forwarded to Calendar User.']\nRequestStatusProperty.SUCCESS_REPEATING_IGNORED = [2.8, 'Success; repeating event ignored. Scheduled as a single component.']\nRequestStatusProperty.SUCCESS_TRUNCATED_END = [2.9, 'Success; truncated end date time to date boundary.']\nRequestStatusProperty.SUCCESS_REPEATING_VTODO_IGNORED = [2.10, 'Success; repeating VTODO ignored.  Scheduled as a single VTODO.']\nRequestStatusProperty.SUCCESS_UNBOUND_RRULE_CLIPPED = [2.11, 'Success; unbounded RRULE clipped at some finite number of instances.']\n\nRequestStatusProperty.CLIENT_INVALID_PROPNAME = [3.0, 'Invalid property name.']\nRequestStatusProperty.CLIENT_INVALID_PROPVALUE = [3.1, 'Invalid property value.']\nRequestStatusProperty.CLIENT_INVALID_PROPPARAM = [3.2, 'Invalid property parameter.']\nRequestStatusProperty.CLIENT_INVALID_PROPPARAMVALUE = [3.3, 'Invalid property parameter value.']\nRequestStatusProperty.CLIENT_INVALUD_CALENDAR_COMP_SEQ = [3.4, 'Invalid calendar component sequence.']\nRequestStatusProperty.CLIENT_INVALID_DATE_TIME = [3.5, 'Invalid date or time.']\nRequestStatusProperty.CLIENT_INVALID_RRULE = [3.6, 'Invalid rule.']\nRequestStatusProperty.CLIENT_INVALID_CU = [3.7, 'Invalid Calendar User.']\nRequestStatusProperty.CLIENT_NO_AUTHORITY = [3.8, 'No authority.']\nRequestStatusProperty.CLIENT_UNSUPPORTED_VERSION = [3.9, 'Unsupported version.']\nRequestStatusProperty.CLIENT_TOO_LARGE = [3.10, 'Request entity too large.']\nRequestStatusProperty.CLIENT_REQUIRED_COMP_OR_PROP_MISSING = [3.11, 'Required component or property missing.']\nRequestStatusProperty.CLIENT_UNKNOWN_COMP_OR_PROP = [3.12, 'Unknown component or property found.']\nRequestStatusProperty.CLIENT_UNSUPPORTED_COMP_OR_PROP = [3.13, 'Unsupported component or property found.']\nRequestStatusProperty.CLIENT_UNSUPPORTED_CAPABILITY = [3.14, 'Unsupported capability.']\n\nRequestStatusProperty.SCHEDULING_EVENT_CONFLICT = [4.0, 'Event conflict.  Date/time is busy.']\n\nRequestStatusProperty.SERVER_REQUEST_NOT_SUPPORTED = [5.0, 'Request not supported.']\nRequestStatusProperty.SERVER_SERVICE_UNAVAILABLE = [5.1, 'Service unavailable.']\nRequestStatusProperty.SERVER_INVALID_CALENDAR_SERVICE = [5.2, 'Invalid calendar service.']\nRequestStatusProperty.SERVER_NO_SCHEDULING_FOR_USER = [5.3, 'No scheduling support for user.']\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport Property from './property.js'\n\n/**\n * @class TextProperty\n * @classdesc\n */\nexport default class TextProperty extends Property {\n\n\t/**\n\t * Gets the alternate text\n\t *\n\t * @return {string}\n\t */\n\tget alternateText() {\n\t\treturn this.getParameterFirstValue('ALTREP')\n\t}\n\n\t/**\n\t * Sets the alternate text\n\t *\n\t * @param {string} altRep The alternative text\n\t */\n\tset alternateText(altRep) {\n\t\tthis.updateParameterIfExist('ALTREP', altRep)\n\t}\n\n\t/**\n\t * Gets language of this property\n\t *\n\t * @return {string}\n\t */\n\tget language() {\n\t\treturn this.getParameterFirstValue('LANGUAGE')\n\t}\n\n\t/**\n\t * Sets language of this property\n\t *\n\t * @param {string} language The language of the text\n\t */\n\tset language(language) {\n\t\tthis.updateParameterIfExist('LANGUAGE', language)\n\t}\n\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport Property from './property.js'\nimport DurationValue from '../values/durationValue.js'\nimport DateTimeValue from '../values/dateTimeValue.js'\n\n/**\n * @class TriggerProperty\n * @classdesc\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.6.3\n */\nexport default class TriggerProperty extends Property {\n\n\t/**\n\t * Gets the related parameter\n\t *\n\t * @return {string}\n\t */\n\tget related() {\n\t\tif (!this.hasParameter('RELATED')) {\n\t\t\treturn 'START'\n\t\t}\n\n\t\treturn this.getParameterFirstValue('RELATED')\n\t}\n\n\t/**\n\t * Sets the related parameter\n\t *\n\t * @param {string} related Either START or END\n\t */\n\tset related(related) {\n\t\tthis.updateParameterIfExist('RELATED', related)\n\t}\n\n\t/**\n\t * Gets the value of this trigger\n\t * (If you override the setter, you also have to override the getter or\n\t *  it will simply be undefined)\n\t *\n\t * @return {string | number | AbstractValue | string[] | number[] | AbstractValue[]}\n\t */\n\tget value() {\n\t\treturn super.value\n\t}\n\n\t/**\n\t * Set the value of this trigger\n\t *\n\t * @param {DurationValue|DateTimeValue} value The time of trigger\n\t */\n\tset value(value) {\n\t\tsuper.value = value\n\n\t\t// If it's not a duration, remove related parameter\n\t\tif (value instanceof DateTimeValue) {\n\t\t\tthis.deleteParameter('RELATED')\n\t\t\tsuper.value = value.getInUTC()\n\t\t}\n\t}\n\n\t/**\n\t * Gets whether this alarm trigger is relative\n\t *\n\t * @return {boolean}\n\t */\n\tisRelative() {\n\t\treturn this.getFirstValue() instanceof DurationValue\n\t}\n\n\t/**\n\t * Creates a new absolute trigger\n\t *\n\t * @param {DateTimeValue} alarmTime Time to create Trigger from\n\t * @return {TriggerProperty}\n\t */\n\tstatic fromAbsolute(alarmTime) {\n\t\treturn new TriggerProperty('TRIGGER', alarmTime)\n\t}\n\n\t/**\n\t * Creates a new relative trigger\n\t *\n\t * @param {DurationValue} alarmOffset Duration to create Trigger from\n\t * @param {boolean=} relatedToStart Related to Start or end?\n\t * @return {TriggerProperty}\n\t */\n\tstatic fromRelativeAndRelated(alarmOffset, relatedToStart = true) {\n\t\treturn new TriggerProperty('TRIGGER', alarmOffset, [['RELATED', relatedToStart ? 'START' : 'END']])\n\t}\n\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @author Richard Steinmetz <richard@steinmetz.cloud>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport AttachmentProperty from './attachmentProperty.js'\nimport AttendeeProperty from './attendeeProperty.js'\nimport ConferenceProperty from './conferenceProperty.js'\nimport FreeBusyProperty from './freeBusyProperty.js'\nimport GeoProperty from './geoProperty.js'\nimport ImageProperty from './imageProperty.js'\nimport RelationProperty from './relationProperty.js'\nimport RequestStatusProperty from './requestStatusProperty.js'\nimport TextProperty from './textProperty.js'\nimport TriggerProperty from './triggerProperty.js'\nimport Property from './property.js'\nimport { uc } from '../helpers/stringHelper.js'\n\n/**\n *\n * @param {string} propName Name of the prop to get constructor for\n * @return {AttendeeProperty|GeoProperty|ConferenceProperty|Property|AttachmentProperty|ImageProperty|RelationProperty|RequestStatusProperty}\n */\nexport function getConstructorForPropertyName(propName) {\n\tswitch (uc(propName)) {\n\tcase 'ATTACH':\n\t\treturn AttachmentProperty\n\n\tcase 'ATTENDEE':\n\tcase 'ORGANIZER':\n\t\treturn AttendeeProperty\n\n\tcase 'CONFERENCE':\n\t\treturn ConferenceProperty\n\n\tcase 'FREEBUSY':\n\t\treturn FreeBusyProperty\n\n\tcase 'GEO':\n\t\treturn GeoProperty\n\n\tcase 'IMAGE':\n\t\treturn ImageProperty\n\n\tcase 'RELATED-TO':\n\t\treturn RelationProperty\n\n\tcase 'REQUEST-STATUS':\n\t\treturn RequestStatusProperty\n\n\tcase 'TRIGGER':\n\t\treturn TriggerProperty\n\n\tcase 'COMMENT':\n\tcase 'CONTACT':\n\tcase 'DESCRIPTION':\n\tcase 'LOCATION':\n\tcase 'SUMMARY':\n\t\treturn TextProperty\n\n\tdefault:\n\t\treturn Property\n\t}\n}\n\nexport {\n\tAttachmentProperty,\n\tAttendeeProperty,\n\tConferenceProperty,\n\tFreeBusyProperty,\n\tGeoProperty,\n\tImageProperty,\n\tProperty,\n\tRelationProperty,\n\tRequestStatusProperty,\n\tTextProperty,\n\tTriggerProperty,\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport lockableTrait from '../traits/lockable.js'\nimport ExpectedICalJSError from '../errors/expectedICalJSError.js'\nimport { lc, uc, ucFirst } from '../helpers/stringHelper.js'\nimport { createComponent } from '../factories/icalFactory.js'\nimport { getConstructorForPropertyName } from '../properties/index.js'\nimport Property from '../properties/property.js'\nimport Parameter from '../parameters/parameter.js'\nimport observerTrait from '../traits/observer.js'\nimport ICAL from 'ical.js'\n\n/**\n * @class AbstractComponent\n */\nexport default class AbstractComponent extends observerTrait(lockableTrait(class {})) {\n\n\t/**\n\t * Constructor\n\t *\n\t * @param {string} name - Name of component\n\t * @param {Property[]} properties - Array of properties stored inside the component\n\t * @param {AbstractComponent[]} components - Array of subcomponents stored inside this component\n\t * @param {CalendarComponent|null} root - The root of this calendar document\n\t * @param {AbstractComponent|null} parent - The parent component of this element\n\t */\n\tconstructor(name, properties = [], components = [], root = null, parent = null) {\n\t\tsuper()\n\n\t\t/**\n\t\t * Name of component\n\t\t *\n\t\t * @type {string}\n\t\t * @private\n\t\t */\n\t\tthis._name = uc(name)\n\n\t\t/**\n\t\t * All properties in this component\n\t\t *\n\t\t * @type {Map<string, Property[]>}\n\t\t * @private\n\t\t */\n\t\tthis._properties = new Map()\n\n\t\t/**\n\t\t * All subcomponents of this component\n\t\t *\n\t\t * @type {Map<string, AbstractComponent[]>}\n\t\t * @private\n\t\t */\n\t\tthis._components = new Map()\n\n\t\t/**\n\t\t * Root node of ical document\n\t\t *\n\t\t * @type {CalendarComponent|null}\n\t\t * @private\n\t\t */\n\t\tthis._root = root\n\n\t\t/**\n\t\t * Parent node\n\t\t *\n\t\t * @type {AbstractComponent|null}\n\t\t * @private\n\t\t */\n\t\tthis._parent = parent\n\n\t\tthis._setPropertiesFromConstructor(properties)\n\t\tthis._setComponentsFromConstructor(components)\n\t}\n\n\t/**\n\t * Get the component's name\n\t *\n\t * @return {string}\n\t */\n\tget name() {\n\t\treturn this._name\n\t}\n\n\t/**\n\t * Gets the root of this calendar-document\n\t *\n\t * @return {CalendarComponent}\n\t */\n\tget root() {\n\t\treturn this._root\n\t}\n\n\t/**\n\t * Sets the root of this calendar-document\n\t *\n\t * @param {CalendarComponent} root The new root element\n\t */\n\tset root(root) {\n\t\tthis._modify()\n\t\tthis._root = root\n\n\t\tfor (const property of this.getPropertyIterator()) {\n\t\t\tproperty.root = root\n\t\t}\n\n\t\tfor (const component of this.getComponentIterator()) {\n\t\t\tcomponent.root = root\n\t\t}\n\n\t}\n\n\t/**\n\t * Gets the parent component\n\t *\n\t * @return {AbstractComponent}\n\t */\n\tget parent() {\n\t\treturn this._parent\n\t}\n\n\t/**\n\t * Sets the parent component\n\t *\n\t * @param {AbstractComponent} parent The new parent element\n\t */\n\tset parent(parent) {\n\t\tthis._modify()\n\t\tthis._parent = parent\n\t}\n\n\t/**\n\t * Gets the first property that matches the given propertyName\n\t *\n\t * @param {string} propertyName Name of the property to get\n\t * @return {Property|null}\n\t */\n\tgetFirstProperty(propertyName) {\n\t\tif (!this._properties.has(uc(propertyName))) {\n\t\t\treturn null\n\t\t}\n\n\t\treturn this._properties.get(uc(propertyName))[0]\n\t}\n\n\t/**\n\t * Gets the first value of the first property matching that name\n\t *\n\t * @param {string} propertyName Name of the property to get first value of\n\t * @return {string | number | AbstractValue | string[] | number[] | AbstractValue[] | null}\n\t */\n\tgetFirstPropertyFirstValue(propertyName) {\n\t\tconst property = this.getFirstProperty(propertyName)\n\t\tif (!property) {\n\t\t\treturn null\n\t\t}\n\n\t\treturn property.getFirstValue()\n\t}\n\n\t/**\n\t * update a property if it exists,\n\t * create a new one if it doesn't\n\t *\n\t * @param {string} propertyName Name of the property to update / create\n\t * @param {string | number | AbstractValue | string[] | number[] | AbstractValue[] | null} value The value to set\n\t */\n\tupdatePropertyWithValue(propertyName, value) {\n\t\tthis._modify()\n\t\tconst property = this.getFirstProperty(propertyName)\n\t\tif (property) {\n\t\t\tproperty.value = value\n\t\t} else {\n\t\t\tconst constructor = getConstructorForPropertyName(propertyName)\n\t\t\tconst newProperty = new constructor(propertyName, value, [], this, this.root)\n\t\t\tthis.addProperty(newProperty)\n\t\t}\n\t}\n\n\t/**\n\t * Returns iterator for all properties of a given propertyName\n\t * or if no propertyName was given over all available properties\n\t *\n\t * @param {string=} propertyName Name of the property to get an iterator for\n\t */\n\t* getPropertyIterator(propertyName = null) {\n\t\tif (propertyName) {\n\t\t\tif (!this.hasProperty(propertyName)) {\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\t// this._properties.get() returns an array\n\t\t\t// [Symbol.iterator]() creates an iterator from that array\n\t\t\tyield * this._properties.get(uc(propertyName)).slice()[Symbol.iterator]()\n\t\t} else {\n\t\t\tfor (const key of this._properties.keys()) {\n\t\t\t\tyield * this.getPropertyIterator(key)\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Get all properties by name that match the given LANG parameter\n\t *\n\t * @param {string} propertyName The name of the property\n\t * @param {string | null} lang The lang to query\n\t * @private\n\t */\n\t* _getAllOfPropertyByLang(propertyName, lang) {\n\t\tfor (const property of this.getPropertyIterator(propertyName)) {\n\t\t\t// getParameterFirstValue will return null if language not set, so no language parameter will match lang=null\n\t\t\tif (property.getParameterFirstValue('LANGUAGE') === lang) {\n\t\t\t\tyield property\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Get the first property by name that matches the given LANG parameter\n\t *\n\t * @param {string} propertyName The name of the property\n\t * @param {string | null} lang The lang to query\n\t * @return {Property|null}\n\t * @private\n\t */\n\t_getFirstOfPropertyByLang(propertyName, lang) {\n\t\tconst iterator = this._getAllOfPropertyByLang(propertyName, lang)\n\t\treturn iterator.next().value || null\n\t}\n\n\t/**\n\t * Adds a property\n\t *\n\t * @param {Property} property The property to add\n\t * @return {boolean}\n\t */\n\taddProperty(property) {\n\t\tthis._modify()\n\n\t\tproperty.root = this.root\n\t\tproperty.parent = this\n\n\t\tif (this._properties.has(property.name)) {\n\t\t\tconst arr = this._properties.get(property.name)\n\t\t\tif (arr.indexOf(property) !== -1) {\n\t\t\t\t// If the property is already part of this component,\n\t\t\t\t// return false to indicate an error\n\t\t\t\treturn false\n\t\t\t}\n\n\t\t\tarr.push(property)\n\t\t} else {\n\t\t\tthis._properties.set(property.name, [property])\n\t\t}\n\n\t\tproperty.subscribe(() => this._notifySubscribers())\n\n\t\treturn true\n\t}\n\n\t/**\n\t * Checks if this component has a property of the given name\n\t *\n\t * @param {string} propertyName The name of the property\n\t * @return {boolean}\n\t */\n\thasProperty(propertyName) {\n\t\treturn this._properties.has(uc(propertyName))\n\t}\n\n\t/**\n\t * Removes the given property from this component\n\t *\n\t * @param {Property} property The property to delete\n\t * @return {boolean}\n\t */\n\tdeleteProperty(property) {\n\t\tthis._modify()\n\t\tif (!this._properties.has(property.name)) {\n\t\t\treturn false\n\t\t}\n\n\t\tconst arr = this._properties.get(property.name)\n\t\tconst index = arr.indexOf(property)\n\t\tif (index === -1) {\n\t\t\treturn false\n\t\t}\n\n\t\tif (index !== -1 && arr.length === 1) {\n\t\t\t// If this is the last property of the given name,\n\t\t\t// remove the entire array from _properties\n\t\t\t// This is required for hasProperty to work properly\n\t\t\tthis._properties.delete(property.name)\n\t\t} else {\n\t\t\tarr.splice(index, 1)\n\t\t}\n\n\t\treturn true\n\t}\n\n\t/**\n\t * Removes all properties of a given name\n\t *\n\t * @param {string} propertyName The name of the property\n\t * @return {boolean}\n\t */\n\tdeleteAllProperties(propertyName) {\n\t\tthis._modify()\n\t\treturn this._properties.delete(uc(propertyName))\n\t}\n\n\t/**\n\t * Gets the first component of a given name\n\t *\n\t * @param {string} componentName The name of the component\n\t * @return {AbstractComponent|null}\n\t */\n\tgetFirstComponent(componentName) {\n\t\tif (!this.hasComponent(componentName)) {\n\t\t\treturn null\n\t\t}\n\n\t\treturn this._components.get(uc(componentName))[0]\n\t}\n\n\t/**\n\t * Returns iterator for all components of a given componentName\n\t * or if no componentName was given over all available components\n\t *\n\t * @param {string=} componentName The name of the component\n\t */\n\t* getComponentIterator(componentName) {\n\t\tif (componentName) {\n\t\t\tif (!this.hasComponent(componentName)) {\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\t// this._components.get() returns an array\n\t\t\t// [Symbol.iterator]() creates an iterator from that array\n\t\t\tyield * this._components.get(uc(componentName)).slice()[Symbol.iterator]()\n\t\t} else {\n\t\t\tfor (const key of this._components.keys()) {\n\t\t\t\tyield * this.getComponentIterator(key)\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Adds a new component to this component\n\t *\n\t * @param {AbstractComponent} component The component to add\n\t * @return {boolean}\n\t */\n\taddComponent(component) {\n\t\tthis._modify()\n\n\t\tcomponent.root = this.root\n\t\tcomponent.parent = this\n\n\t\tif (this._components.has(component.name)) {\n\t\t\tconst arr = this._components.get(component.name)\n\t\t\tif (arr.indexOf(component) !== -1) {\n\t\t\t\t// If the property is already part of this component,\n\t\t\t\t// return false to indicate an error\n\t\t\t\treturn false\n\t\t\t}\n\n\t\t\tarr.push(component)\n\t\t} else {\n\t\t\tthis._components.set(component.name, [component])\n\t\t}\n\n\t\tcomponent.subscribe(() => this._notifySubscribers())\n\n\t\treturn true\n\t}\n\n\t/**\n\t * Checks if this component has a component of the given name\n\t *\n\t * @param {string} componentName The name of the component\n\t * @return {boolean}\n\t */\n\thasComponent(componentName) {\n\t\treturn this._components.has(uc(componentName))\n\t}\n\n\t/**\n\t * Removes the given component from this component\n\t *\n\t * @param {AbstractComponent} component The component to delete\n\t * @return {boolean}\n\t */\n\tdeleteComponent(component) {\n\t\tthis._modify()\n\t\tif (!this._components.has(component.name)) {\n\t\t\treturn false\n\t\t}\n\n\t\tconst arr = this._components.get(component.name)\n\t\tconst index = arr.indexOf(component)\n\t\tif (index === -1) {\n\t\t\treturn false\n\t\t}\n\n\t\tif (index !== -1 && arr.length === 1) {\n\t\t\t// If this is the last component of the given name,\n\t\t\t// remove the entire array from _components\n\t\t\t// This is required for hasComponent to work properly\n\t\t\tthis._components.delete(component.name)\n\t\t} else {\n\t\t\tarr.splice(index, 1)\n\t\t}\n\n\t\treturn true\n\t}\n\n\t/**\n\t * Removes all components of a given name\n\t *\n\t * @param {string} componentName The name of the component\n\t * @return {boolean}\n\t */\n\tdeleteAllComponents(componentName) {\n\t\tthis._modify()\n\t\treturn this._components.delete(uc(componentName))\n\t}\n\n\t/**\n\t * Marks this parameter is immutable\n\t * locks it against further modification\n\t */\n\tlock() {\n\t\tsuper.lock()\n\n\t\tfor (const property of this.getPropertyIterator()) {\n\t\t\tproperty.lock()\n\t\t}\n\n\t\tfor (const component of this.getComponentIterator()) {\n\t\t\tcomponent.lock()\n\t\t}\n\t}\n\n\t/**\n\t * Marks this parameter as mutable\n\t * allowing further modification\n\t */\n\tunlock() {\n\t\tsuper.unlock()\n\n\t\tfor (const property of this.getPropertyIterator()) {\n\t\t\tproperty.unlock()\n\t\t}\n\n\t\tfor (const component of this.getComponentIterator()) {\n\t\t\tcomponent.unlock()\n\t\t}\n\t}\n\n\t/**\n\t * Creates a copy of this parameter\n\t *\n\t * @return {AbstractComponent}\n\t */\n\tclone() {\n\t\tconst properties = []\n\t\tfor (const property of this.getPropertyIterator()) {\n\t\t\tproperties.push(property.clone())\n\t\t}\n\n\t\tconst components = []\n\t\tfor (const component of this.getComponentIterator()) {\n\t\t\tcomponents.push(component.clone())\n\t\t}\n\n\t\treturn new this.constructor(this.name, properties, components, this.root, this.parent)\n\t}\n\n\t/**\n\t * Adds properties from constructor to this._properties\n\t *\n\t * @param {Property[]} properties Array of properties\n\t * @private\n\t */\n\t_setPropertiesFromConstructor(properties) {\n\t\tfor (let property of properties) {\n\t\t\tif (Array.isArray(property)) {\n\t\t\t\tconst constructor = getConstructorForPropertyName(property[0])\n\t\t\t\tproperty = new constructor(property[0], property[1])\n\t\t\t}\n\n\t\t\tthis.addProperty(property)\n\t\t}\n\t}\n\n\t/**\n\t * Adds components from constructor to this._components\n\t *\n\t * @param {AbstractComponent[]} components Array of components\n\t * @private\n\t */\n\t_setComponentsFromConstructor(components) {\n\t\tfor (const component of components) {\n\t\t\tthis.addComponent(component)\n\t\t}\n\t}\n\n\t/**\n\t * Creates a new Component based on an ical object\n\t *\n\t * @param {ICAL.Component} icalValue The ical.js component to initialise from\n\t * @param {CalendarComponent=} root The root of the Calendar Document\n\t * @param {AbstractComponent=} parent The parent element of this component\n\t * @return {AbstractComponent}\n\t */\n\tstatic fromICALJs(icalValue, root = null, parent = null) {\n\t\tif (!(icalValue instanceof ICAL.Component)) {\n\t\t\tthrow new ExpectedICalJSError()\n\t\t}\n\n\t\tconst name = icalValue.name\n\t\tconst newComponent = new this(name, [], [], root, parent)\n\n\t\tfor (const icalProp of icalValue.getAllProperties()) {\n\t\t\tconst constructor = getConstructorForPropertyName(icalProp.name)\n\t\t\tconst property = constructor.fromICALJs(icalProp, root, newComponent)\n\t\t\tnewComponent.addProperty(property)\n\t\t}\n\n\t\tfor (const icalComp of icalValue.getAllSubcomponents()) {\n\t\t\tconst constructor = this._getConstructorForComponentName(icalComp.name)\n\t\t\tconst component = constructor.fromICALJs(icalComp, root, newComponent)\n\t\t\tnewComponent.addComponent(component)\n\t\t}\n\n\t\treturn newComponent\n\t}\n\n\t/**\n\t * Gets a constructor for a give component name\n\t *\n\t * @param {string} componentName The name of the component\n\t * @return {AbstractComponent}\n\t * @protected\n\t */\n\tstatic _getConstructorForComponentName(componentName) {\n\t\treturn AbstractComponent\n\t}\n\n\t/**\n\t * turns this Component into an ICAL.js component\n\t *\n\t * @return {ICAL.Component}\n\t */\n\ttoICALJs() {\n\t\tconst component = createComponent(lc(this.name))\n\n\t\tfor (const prop of this.getPropertyIterator()) {\n\t\t\tcomponent.addProperty(prop.toICALJs())\n\t\t}\n\t\tfor (const comp of this.getComponentIterator()) {\n\t\t\tcomponent.addSubcomponent(comp.toICALJs())\n\t\t}\n\n\t\treturn component\n\t}\n\n}\n\n/**\n * Advertise properties that may at most occur once\n *\n * Properties, which may at most occur once, get a simple getter and setter\n *\n * @param {object} prototype The object's prototype\n * @param {object} options The options for advertising properties\n * @param {boolean} advertiseValueOnly Whether to advertise the value only or the entire property\n */\nexport function advertiseSingleOccurrenceProperty(prototype, options, advertiseValueOnly = true) {\n\toptions = getDefaultOncePropConfig(options)\n\n\tObject.defineProperty(prototype, options.name, {\n\t\tget() {\n\t\t\tconst value = this.getFirstPropertyFirstValue(options.iCalendarName)\n\n\t\t\tif (!value) {\n\t\t\t\treturn options.defaultValue\n\t\t\t} else {\n\t\t\t\tif (Array.isArray(options.allowedValues) && !options.allowedValues.includes(value)) {\n\t\t\t\t\treturn options.unknownValue\n\t\t\t\t}\n\n\t\t\t\treturn value\n\t\t\t}\n\t\t},\n\t\tset(value) {\n\t\t\tthis._modify()\n\n\t\t\tif (value === null) {\n\t\t\t\tthis.deleteAllProperties(options.iCalendarName)\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\tif (Array.isArray(options.allowedValues) && !options.allowedValues.includes(value)) {\n\t\t\t\tthrow new TypeError('Illegal value')\n\t\t\t}\n\t\t\tthis.updatePropertyWithValue(options.iCalendarName, value)\n\t\t},\n\t})\n}\n\n/**\n * Advertise properties that may occur more than once\n *\n * Properties, which may occur more than once, won't get simple getter / setter,\n * but rather a more advanced set of get{name}Iterator, get{name}List, add{name},\n * remove{name} and clearAll{name} methods\n *\n * @param {object} prototype The object's prototype\n * @param {object} options The options for advertising properties\n */\nexport function advertiseMultipleOccurrenceProperty(prototype, options) {\n\toptions = getDefaultMultiplePropConfig(options)\n\n\tprototype['get' + ucFirst(options.name) + 'Iterator'] = function * () {\n\t\tyield * this.getPropertyIterator(options.iCalendarName)\n\t}\n\n\tprototype['get' + ucFirst(options.name) + 'List'] = function() {\n\t\treturn Array.from(this['get' + ucFirst(options.name) + 'Iterator']())\n\t}\n\n\tprototype['remove' + ucFirst(options.name)] = function(property) {\n\t\tthis.deleteProperty(property)\n\t}\n\n\tprototype['clearAll' + ucFirst(options.pluralName)] = function() {\n\t\tthis.deleteAllProperties(options.iCalendarName)\n\t}\n}\n\n/**\n * advertises a multi-value string property enabling simple access by language\n * This is used for:\n * - CATEGORIES\n * - RESOURCES\n *\n * @param {object} prototype The object's prototype\n * @param {object} options The options for advertising properties\n */\nexport function advertiseMultiValueStringPropertySeparatedByLang(prototype, options) {\n\toptions = getDefaultMultiplePropConfig(options)\n\n\tprototype['get' + ucFirst(options.name) + 'Iterator'] = function * (lang = null) {\n\t\tfor (const property of this._getAllOfPropertyByLang(options.iCalendarName, lang)) {\n\t\t\tyield * property.getValueIterator()\n\t\t}\n\t}\n\n\tprototype['get' + ucFirst(options.name) + 'List'] = function(lang = null) {\n\t\treturn Array.from(this['get' + ucFirst(options.name) + 'Iterator'](lang))\n\t}\n\n\tprototype['add' + ucFirst(options.name)] = function(value, lang = null) {\n\t\tconst property = this._getFirstOfPropertyByLang(options.iCalendarName, lang)\n\t\tif (property) {\n\t\t\tproperty.addValue(value)\n\t\t} else {\n\t\t\tconst newProperty = new Property(options.iCalendarName, [value])\n\t\t\tif (lang) {\n\t\t\t\tconst languageParameter = new Parameter('LANGUAGE', lang)\n\t\t\t\tnewProperty.setParameter(languageParameter)\n\t\t\t}\n\n\t\t\tthis.addProperty(newProperty)\n\t\t}\n\t}\n\n\tprototype['remove' + ucFirst(options.name)] = function(value, lang = null) {\n\t\tfor (const property of this._getAllOfPropertyByLang(options.iCalendarName, lang)) {\n\t\t\tif (property.isMultiValue() && property.hasValue(value)) {\n\t\t\t\tif (property.value.length === 1) {\n\t\t\t\t\tthis.deleteProperty(property)\n\t\t\t\t\treturn true\n\t\t\t\t}\n\n\t\t\t\tproperty.removeValue(value)\n\t\t\t\treturn true\n\t\t\t}\n\t\t}\n\n\t\treturn false\n\t}\n\n\tprototype['clearAll' + ucFirst(options.pluralName)] = function(lang = null) {\n\t\tfor (const property of this._getAllOfPropertyByLang(options.iCalendarName, lang)) {\n\t\t\tthis.deleteProperty(property)\n\t\t}\n\t}\n}\n\n/**\n * advertise a component\n *\n * @param {object} prototype The object's prototype\n * @param {object} options The options for advertising components\n */\nexport function advertiseComponent(prototype, options) {\n\toptions = getDefaultMultipleCompConfig(options)\n\n\tprototype['get' + ucFirst(options.name) + 'Iterator'] = function * () {\n\t\tyield * this.getComponentIterator(options.iCalendarName)\n\t}\n\n\tprototype['get' + ucFirst(options.name) + 'List'] = function() {\n\t\treturn Array.from(this['get' + ucFirst(options.name) + 'Iterator']())\n\t}\n\n\tprototype['remove' + ucFirst(options.name)] = function(component) {\n\t\tthis.deleteComponent(component)\n\t}\n\n\tprototype['clearAll' + ucFirst(options.pluralName)] = function() {\n\t\tthis.deleteAllComponents(options.iCalendarName)\n\t}\n}\n\n/**\n * Fill up the options object for advertiseProperty\n *\n * @param {object | string} options The options object\n * @param {string} options.name Advertised name of the property\n * @param {string=} options.iCalendarName The iCalendar name of the property\n * @param {string[]=} options.allowedValues A list of allowed values\n * @param {string | number=} options.defaultValue The default value if unset\n * @param {string | number=} options.unknownValue The fallback value if unknown value\n * @return {object}\n */\nfunction getDefaultOncePropConfig(options) {\n\tif (typeof options === 'string') {\n\t\toptions = {\n\t\t\tname: options,\n\t\t}\n\t}\n\n\treturn Object.assign({}, {\n\t\tiCalendarName: uc(options.name),\n\t\tpluralName: options.name + 's',\n\t\tallowedValues: null,\n\t\tdefaultValue: null,\n\t\tunknownValue: null,\n\t}, options)\n}\n\n/**\n * Fill up the options object for advertiseProperty\n *\n * @param {object | string} options The options object\n * @param {string} options.name Advertised name of property\n * @param {string=} options.iCalendarName The iCalendar name of the property\n * @param {boolean=} options.customAddMethod Whether or not to use a custom add method\n * @return {object}\n */\nfunction getDefaultMultiplePropConfig(options) {\n\tif (typeof options === 'string') {\n\t\toptions = {\n\t\t\tname: options,\n\t\t}\n\t}\n\n\treturn Object.assign({}, {\n\t\tiCalendarName: uc(options.name),\n\t\tpluralName: options.name + 's',\n\t}, options)\n}\n\n/**\n * Fill up the options object for advertiseComponent\n *\n * @param {object | string} options Options destructuring object\n * @param {string} options.name Advertised name of component\n * @param {string=} options.iCalendarName The iCalendar name of the component\n * @param {boolean=} options.customAddMethod Whether or not to use a custom add method\n * @return {object}\n */\nfunction getDefaultMultipleCompConfig(options) {\n\tif (typeof options === 'string') {\n\t\toptions = {\n\t\t\tname: options,\n\t\t}\n\t}\n\n\treturn Object.assign({}, {\n\t\tiCalendarName: 'V' + uc(options.name),\n\t\tpluralName: options.name + 's',\n\t}, options)\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\n/**\n * Gets a new DateObject set to now\n *\n * @return {Date}\n */\nexport function dateFactory() {\n\treturn new Date()\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nexport default class RecurringWithoutDtStartError extends Error {}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport Property from '../properties/property.js'\nimport { uc } from '../helpers/stringHelper.js'\nimport DateTimeValue from '../values/dateTimeValue.js'\nimport ModificationNotAllowedError from '../errors/modificationNotAllowedError.js'\nimport RecurringWithoutDtStartError from '../errors/recurringWithoutDtStartError.js'\nimport PeriodValue from '../values/periodValue.js'\nimport ICAL from 'ical.js'\n\n/**\n * @class RecurrenceHelper\n * @classdesc\n *\n * TODO: This needs caching\n */\nexport default class RecurrenceManager {\n\n\t/**\n\t * Constructor\n\t *\n\t * @param {AbstractRecurringComponent} masterItem The master-item of the recurrence-set\n\t */\n\tconstructor(masterItem) {\n\n\t\t/**\n\t\t *\n\t\t * @type {AbstractRecurringComponent}\n\t\t * @private\n\t\t */\n\t\tthis._masterItem = masterItem\n\n\t\t/**\n\t\t * Set of Recurrence exception items\n\t\t *\n\t\t * Number is the unix time representation of the recurrence ID\n\t\t *\n\t\t * @type {Map<number, AbstractRecurringComponent>}\n\t\t * @private\n\t\t */\n\t\tthis._recurrenceExceptionItems = new Map()\n\n\t\t/**\n\t\t * A sorted index of recurrence ids with range\n\t\t *\n\t\t * @type {number[]}\n\t\t * @private\n\t\t */\n\t\tthis._rangeRecurrenceExceptionItemsIndex = []\n\n\t\t/**\n\t\t * Cached difference of dtstart and recurrenceId for recurrence exceptions with range\n\t\t *\n\t\t * @type {Map<number, DurationValue>}\n\t\t * @private\n\t\t */\n\t\tthis._rangeRecurrenceExceptionItemsDiffCache = new Map()\n\n\t\t/**\n\t\t * Set of Recurrence exception items that have a RANGE of THISANDFUTURE\n\t\t *\n\t\t * Number is the unix time representation of the recurrence ID\n\t\t *\n\t\t * @type {Map<number, AbstractRecurringComponent>}\n\t\t * @private\n\t\t */\n\t\tthis._rangeRecurrenceExceptionItems = new Map()\n\t}\n\n\t/**\n\t *\n\t * @return {AbstractRecurringComponent}\n\t */\n\tget masterItem() {\n\t\treturn this._masterItem\n\t}\n\n\t/**\n\t *\n\t * @param {AbstractRecurringComponent} masterItem The master-item of the recurrence-set\n\t */\n\tset masterItem(masterItem) {\n\t\tthis._masterItem = masterItem\n\t}\n\n\t/**\n\t * Gets an iterator over all registered recurrence exceptions of this calendar-document\n\t */\n\t* getRecurrenceExceptionIterator() {\n\t\tyield * this._recurrenceExceptionItems.values()\n\t}\n\n\t/**\n\t * Gets a list of all registered recurrence-exceptions of this calendar-document\n\t *\n\t * @return {AbstractRecurringComponent[]}\n\t */\n\tgetRecurrenceExceptionList() {\n\t\treturn Array.from(this.getRecurrenceExceptionIterator())\n\t}\n\n\t/**\n\t * Checks if there is a recurrence Exception for a given recurrenceId\n\t *\n\t * @param {DateTimeValue | number} recurrenceId The recurrenceId to check\n\t * @return {boolean}\n\t */\n\thasRecurrenceExceptionForId(recurrenceId) {\n\t\tif (recurrenceId instanceof DateTimeValue) {\n\t\t\trecurrenceId = recurrenceId.unixTime\n\t\t} else if (recurrenceId instanceof ICAL.Time) {\n\t\t\trecurrenceId = recurrenceId.toUnixTime()\n\t\t}\n\n\t\treturn this._recurrenceExceptionItems.has(recurrenceId)\n\t}\n\n\t/**\n\t * Gets the recurrence exception for a given recurrence Id\n\t *\n\t * @param {DateTimeValue | number} recurrenceId The recurrenceId to get\n\t * @return {AbstractRecurringComponent|null}\n\t */\n\tgetRecurrenceException(recurrenceId) {\n\t\tif (recurrenceId instanceof DateTimeValue) {\n\t\t\trecurrenceId = recurrenceId.unixTime\n\t\t} else if (recurrenceId instanceof ICAL.Time) {\n\t\t\trecurrenceId = recurrenceId.toUnixTime()\n\t\t}\n\n\t\treturn this._recurrenceExceptionItems.get(recurrenceId) || null\n\t}\n\n\t/**\n\t * Check if there is a recurrence-exception with a range for a given recurrence-id\n\t *\n\t * @param {DateTimeValue | number} recurrenceId The recurrenceId to check\n\t * @return {boolean}\n\t */\n\thasRangeRecurrenceExceptionForId(recurrenceId) {\n\t\tif (recurrenceId instanceof DateTimeValue) {\n\t\t\trecurrenceId = recurrenceId.unixTime\n\t\t} else if (recurrenceId instanceof ICAL.Time) {\n\t\t\trecurrenceId = recurrenceId.toUnixTime()\n\t\t}\n\n\t\tif (this._rangeRecurrenceExceptionItemsIndex.length === 0) {\n\t\t\treturn false\n\t\t}\n\n\t\treturn this._rangeRecurrenceExceptionItemsIndex[0] < recurrenceId\n\t}\n\n\t/**\n\t * Get recurrence-exception with range that's affecting the given recurrence-id\n\t *\n\t * @param {DateTimeValue | number} recurrenceId The recurrenceId to get\n\t * @return {AbstractRecurringComponent|null}\n\t */\n\tgetRangeRecurrenceExceptionForId(recurrenceId) {\n\t\tif (recurrenceId instanceof DateTimeValue) {\n\t\t\trecurrenceId = recurrenceId.unixTime\n\t\t} else if (recurrenceId instanceof ICAL.Time) {\n\t\t\trecurrenceId = recurrenceId.toUnixTime()\n\t\t}\n\n\t\tconst index = ICAL.helpers.binsearchInsert(\n\t\t\tthis._rangeRecurrenceExceptionItemsIndex,\n\t\t\trecurrenceId,\n\t\t\t(a, b) => a - b\n\t\t)\n\n\t\tif (index === 0) {\n\t\t\treturn null\n\t\t}\n\n\t\tconst key = this._rangeRecurrenceExceptionItemsIndex[index - 1]\n\t\treturn this._rangeRecurrenceExceptionItems.get(key)\n\t}\n\n\t/**\n\t * Gets the difference between recurrence-id and start\n\t * Mostly needed to handle recurrence-exceptions with range\n\t *\n\t * @param {DateTimeValue | number} recurrenceId The recurrenceId to get\n\t * @return {DurationValue|null}\n\t */\n\tgetRangeRecurrenceExceptionDiff(recurrenceId) {\n\t\tif (recurrenceId instanceof DateTimeValue) {\n\t\t\trecurrenceId = recurrenceId.unixTime\n\t\t} else if (recurrenceId instanceof ICAL.Time) {\n\t\t\trecurrenceId = recurrenceId.toUnixTime()\n\t\t}\n\n\t\tif (this._rangeRecurrenceExceptionItemsDiffCache.has(recurrenceId)) {\n\t\t\treturn this._rangeRecurrenceExceptionItemsDiffCache.get(recurrenceId)\n\t\t}\n\n\t\tconst recurrenceException = this.getRangeRecurrenceExceptionForId(recurrenceId)\n\t\tif (!recurrenceException) {\n\t\t\treturn null\n\t\t}\n\n\t\tconst originalRecurrenceId = recurrenceException.recurrenceId\n\t\tconst originalModifiedStart = recurrenceException.startDate\n\n\t\tconst difference = originalModifiedStart.subtractDateWithTimezone(originalRecurrenceId)\n\t\tdifference.lock()\n\n\t\tthis._rangeRecurrenceExceptionItemsDiffCache.set(recurrenceId, difference)\n\t\treturn difference\n\t}\n\n\t/**\n\t * Adds a new recurrence-exception to this calendar-document\n\t *\n\t * @param {AbstractRecurringComponent} recurrenceExceptionItem The recurrence-exception-item to relate to recurrence-set\n\t */\n\trelateRecurrenceException(recurrenceExceptionItem) {\n\t\tthis._modify()\n\t\tconst key = this._getRecurrenceIdKey(recurrenceExceptionItem)\n\n\t\tthis._recurrenceExceptionItems.set(key, recurrenceExceptionItem)\n\t\tif (recurrenceExceptionItem.modifiesFuture()) {\n\t\t\tthis._rangeRecurrenceExceptionItems.set(key, recurrenceExceptionItem)\n\t\t\tconst index = ICAL.helpers.binsearchInsert(\n\t\t\t\tthis._rangeRecurrenceExceptionItemsIndex,\n\t\t\t\tkey,\n\t\t\t\t(a, b) => a - b\n\t\t\t)\n\n\t\t\tthis._rangeRecurrenceExceptionItemsIndex.splice(index, 0, key)\n\t\t}\n\n\t\trecurrenceExceptionItem.recurrenceManager = this\n\t}\n\n\t/**\n\t * Removes a recurrence exception by the item itself\n\t *\n\t * @param {AbstractRecurringComponent} recurrenceExceptionItem The recurrence-exception remove\n\t */\n\tremoveRecurrenceException(recurrenceExceptionItem) {\n\t\tconst key = this._getRecurrenceIdKey(recurrenceExceptionItem)\n\t\tthis.removeRecurrenceExceptionByRecurrenceId(key)\n\t}\n\n\t/**\n\t * Removes a recurrence exception by it's unix-time\n\t *\n\t * @param {number} recurrenceId The recurrence-exception to remove\n\t */\n\tremoveRecurrenceExceptionByRecurrenceId(recurrenceId) {\n\t\tthis._modify()\n\t\tthis._recurrenceExceptionItems.delete(recurrenceId)\n\t\tthis._rangeRecurrenceExceptionItems.delete(recurrenceId)\n\t\tthis._rangeRecurrenceExceptionItemsDiffCache.delete(recurrenceId)\n\n\t\tconst index = this._rangeRecurrenceExceptionItemsIndex.indexOf(recurrenceId)\n\t\tif (index !== -1) {\n\t\t\tthis._rangeRecurrenceExceptionItemsIndex.splice(index, 1)\n\t\t}\n\t}\n\n\t/**\n\t *\n\t * @param {AbstractRecurringComponent} recurrenceExceptionItem Object to get key from\n\t * @return {number}\n\t * @private\n\t */\n\t_getRecurrenceIdKey(recurrenceExceptionItem) {\n\t\treturn recurrenceExceptionItem\n\t\t\t.recurrenceId\n\t\t\t.unixTime\n\t}\n\n\t/**\n\t * Gets an iterator over all recurrence rules\n\t */\n\t* getRecurrenceRuleIterator() {\n\t\tfor (const property of this._masterItem.getPropertyIterator('RRULE')) {\n\t\t\tyield property.getFirstValue()\n\t\t}\n\t}\n\n\t/**\n\t * Gets a list of all recurrence rules\n\t *\n\t * @return {RecurValue[]}\n\t */\n\tgetRecurrenceRuleList() {\n\t\treturn Array.from(this.getRecurrenceRuleIterator())\n\t}\n\n\t/**\n\t * Adds a new recurrence rule\n\t *\n\t * @param {RecurValue} recurrenceRule The RRULE to add\n\t */\n\taddRecurrenceRule(recurrenceRule) {\n\t\tthis._modify()\n\t\tthis.resetCache()\n\n\t\tconst property = new Property('RRULE', recurrenceRule)\n\t\tthis._masterItem.addProperty(property)\n\t}\n\n\t/**\n\t * Removes a recurrence rule\n\t *\n\t * @param {RecurValue} recurrenceRule The RRULE to remove\n\t */\n\tremoveRecurrenceRule(recurrenceRule) {\n\t\tthis._modify()\n\t\tthis.resetCache()\n\n\t\tfor (const property of this._masterItem.getPropertyIterator('RRULE')) {\n\t\t\tif (property.getFirstValue() === recurrenceRule) {\n\t\t\t\tthis._masterItem.deleteProperty(property)\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Removes all recurrence rules\n\t */\n\tclearAllRecurrenceRules() {\n\t\tthis._modify()\n\t\tthis.resetCache()\n\n\t\tthis._masterItem.deleteAllProperties('RRULE')\n\t}\n\n\t/**\n\t * Gets an iterator over all recurrence\n\t *\n\t * @param {boolean} isNegative Whether or not to get EXDATES\n\t * @param {string} valueType Limit type of EXDATES\n\t */\n\t* getRecurrenceDateIterator(isNegative = false, valueType = null) {\n\t\tfor (const property of this._getPropertiesForRecurrenceDate(isNegative, valueType)) {\n\t\t\tyield * property.getValueIterator()\n\t\t}\n\t}\n\n\t/**\n\t *\n\t * @param {boolean} isNegative Whether or not to get EXDATES\n\t * @param {string} valueType Limit type of EXDATES\n\t * @return {(DateTimeValue|PeriodValue)[]}\n\t */\n\tlistAllRecurrenceDates(isNegative = false, valueType = null) {\n\t\treturn Array.from(this.getRecurrenceDateIterator(isNegative, valueType))\n\t}\n\n\t/**\n\t * This adds a new recurrence-date value.\n\t * It automatically adds it to the first property of the same value-type\n\t * or creates a new one if necessary\n\t *\n\t * @param {boolean} isNegative Whether we are dealing with an EXDATE or RDATE\n\t * @param {DateTimeValue|PeriodValue} value EXDATE to add\n\t */\n\taddRecurrenceDate(isNegative = false, value) {\n\t\tthis._modify()\n\t\tthis.resetCache()\n\n\t\t// Only add DateTime Value if its of the same timezone\n\t\tlet timezoneId = null\n\t\tif (value instanceof DateTimeValue && !value.isDate) {\n\t\t\ttimezoneId = value.timezoneId\n\t\t}\n\n\t\tconst valueType = this._getValueTypeByValue(value)\n\t\tconst iterator = this._getPropertiesForRecurrenceDate(isNegative, valueType, timezoneId)\n\n\t\tconst first = iterator.next.value\n\t\tif (first instanceof Property) {\n\t\t\tconst propertyValue = first.value\n\t\t\tpropertyValue.push(value)\n\t\t\tthis.masterItem.markPropertyAsDirty(isNegative ? 'EXDATE' : 'RDATE')\n\t\t} else {\n\t\t\tconst propertyName = this._getPropertyNameByIsNegative(isNegative)\n\t\t\tconst property = new Property(propertyName, value)\n\t\t\tthis._masterItem.addProperty(property)\n\t\t}\n\t}\n\n\t/**\n\t * Checks if a recurrenceID is an RDATE or EXDATE\n\t *\n\t * @param {boolean} isNegative Whether we are dealing with an EXDATE or RDATE\n\t * @param {DateTimeValue} recurrenceId Recurrence-Id to check\n\t * @return {boolean}\n\t */\n\thasRecurrenceDate(isNegative = false, recurrenceId) {\n\t\tfor (let value of this.getRecurrenceDateIterator(isNegative)) {\n\t\t\tif (value instanceof PeriodValue) {\n\t\t\t\tvalue = value.start\n\t\t\t}\n\n\t\t\tif (value.compare(recurrenceId) === 0) {\n\t\t\t\treturn true\n\t\t\t}\n\t\t}\n\n\t\treturn false\n\t}\n\n\t/**\n\t *\n\t * @param {boolean} isNegative Whether we are dealing with an EXDATE or RDATE\n\t * @param {DateTimeValue} recurrenceId Recurrence-Id to get\n\t * @return {null|DateTimeValue|PeriodValue}\n\t */\n\tgetRecurrenceDate(isNegative = false, recurrenceId) {\n\t\tfor (const value of this.getRecurrenceDateIterator(isNegative)) {\n\t\t\tlet valueToCheck = value\n\t\t\tif (valueToCheck instanceof PeriodValue) {\n\t\t\t\tvalueToCheck = valueToCheck.start\n\t\t\t}\n\n\t\t\tif (valueToCheck.compare(recurrenceId) === 0) {\n\t\t\t\treturn value\n\t\t\t}\n\t\t}\n\n\t\treturn null\n\t}\n\n\t/**\n\t * This deletes a recurrence-date value from this recurrence-set\n\t *\n\t * @param {boolean} isNegative Whether we are dealing with an EXDATE or RDATE\n\t * @param {DateTimeValue|PeriodValue} value The EXDATE/RDATE to remove\n\t */\n\tremoveRecurrenceDate(isNegative = false, value) {\n\t\tthis._modify()\n\t\tthis.resetCache()\n\n\t\tconst valueType = this._getValueTypeByValue(value)\n\t\tfor (const property of this._getPropertiesForRecurrenceDate(isNegative, valueType)) {\n\t\t\tfor (const valueToCheck of property.getValueIterator()) {\n\t\t\t\tif (value === valueToCheck) {\n\t\t\t\t\tconst allValues = property.value\n\n\t\t\t\t\tif (allValues.length === 1) {\n\t\t\t\t\t\tthis.masterItem.deleteProperty(property)\n\t\t\t\t\t\tcontinue\n\t\t\t\t\t}\n\n\t\t\t\t\tconst index = allValues.indexOf(value)\n\t\t\t\t\tallValues.splice(index, 1)\n\t\t\t\t\tthis.masterItem.markPropertyAsDirty(isNegative ? 'EXDATE' : 'RDATE')\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Clears all recurrence-date information\n\t *\n\t * @param {boolean} isNegative Whether we are dealing with an EXDATE or RDATE\n\t * @param {string} valueType The type of RDATEs/EXDATEs to remove\n\t */\n\tclearAllRecurrenceDates(isNegative = false, valueType = null) {\n\t\tthis._modify()\n\t\tthis.resetCache()\n\n\t\tfor (const property of this._getPropertiesForRecurrenceDate(isNegative, valueType)) {\n\t\t\tthis._masterItem.deleteProperty(property)\n\t\t}\n\t}\n\n\t/**\n\t * Gets the property name for recurrence dates based on the isNegative boolean\n\t *\n\t * @param {boolean} isNegative Whether we are dealing with an EXDATE or RDATE\n\t * @return {string}\n\t * @private\n\t */\n\t_getPropertyNameByIsNegative(isNegative) {\n\t\treturn isNegative\n\t\t\t? 'EXDATE'\n\t\t\t: 'RDATE'\n\t}\n\n\t/**\n\t * Gets the value type based on the provided value\n\t *\n\t * @param {PeriodValue|DateTimeValue} value The value to get type of property from\n\t * @return {string}\n\t * @private\n\t */\n\t_getValueTypeByValue(value) {\n\t\tif (value instanceof PeriodValue) {\n\t\t\treturn 'PERIOD'\n\t\t} else if (value.isDate) {\n\t\t\treturn 'DATE'\n\t\t} else {\n\t\t\treturn 'DATETIME'\n\t\t}\n\t}\n\n\t/**\n\t *\n\t * @param {boolean} isNegative Whether we are dealing with an EXDATE or RDATE\n\t * @param {string | null} valueType The type of values to get\n\t * @param {ICAL.Timezone=} timezoneId Filter by timezone\n\t * @private\n\t */\n\t* _getPropertiesForRecurrenceDate(isNegative, valueType, timezoneId = null) {\n\t\tconst propertyName = this._getPropertyNameByIsNegative(isNegative)\n\n\t\tfor (const property of this._masterItem.getPropertyIterator(propertyName)) {\n\t\t\tif (valueType === null) {\n\t\t\t\tyield property\n\t\t\t} else if (uc(valueType) === 'PERIOD' && property.getFirstValue() instanceof PeriodValue) {\n\t\t\t\tyield property\n\t\t\t} else if (uc(valueType) === 'DATE' && property.getFirstValue().isDate) {\n\t\t\t\tyield property\n\t\t\t} else if (uc(valueType) === 'DATETIME' && !property.getFirstValue().isDate) {\n\t\t\t\tif (timezoneId === null || property.getFirstValue().timezoneId === timezoneId) {\n\t\t\t\t\tyield property\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Checks if the entire set of recurrence rules is finite\n\t *\n\t * @return {boolean}\n\t */\n\tisFinite() {\n\t\treturn this.getRecurrenceRuleList().every((rule) => rule.isFinite())\n\t}\n\n\t/**\n\t * @return {boolean}\n\t */\n\tisEmptyRecurrenceSet() {\n\t\treturn this._getRecurExpansionObject().next() === undefined\n\t}\n\n\t/**\n\t * Gets the occurrence at the exact given recurrenceId\n\t *\n\t * @param {DateTimeValue} recurrenceId RecurrenceId to get\n\t * @return {AbstractRecurringComponent|null}\n\t */\n\tgetOccurrenceAtExactly(recurrenceId) {\n\t\tif (!this.masterItem.isRecurring()) {\n\t\t\tif (this.masterItem.getReferenceRecurrenceId().compare(recurrenceId) === 0) {\n\t\t\t\treturn this.masterItem\n\t\t\t}\n\n\t\t\treturn null\n\t\t}\n\n\t\tconst iterator = this._getRecurExpansionObject()\n\t\tconst icalRecurrenceId = recurrenceId.toICALJs()\n\n\t\tlet next\n\t\twhile ((next = iterator.next())) {\n\t\t\tif (next.compare(icalRecurrenceId) === 0) {\n\t\t\t\t// It's a match 🔥\n\t\t\t\treturn this._getOccurrenceAtRecurrenceId(DateTimeValue.fromICALJs(next))\n\t\t\t}\n\n\t\t\tif (next.compare(icalRecurrenceId) === 1) {\n\t\t\t\t// We hit an occurrence in the future, return null\n\t\t\t\treturn null\n\t\t\t}\n\t\t}\n\n\t\treturn null\n\t}\n\n\t/**\n\t * Gets the closest occurrence to the given recurrenceId.\n\t * That's either the closest in the future, or in case the\n\t * recurrence-set ends before recurrenceId, the last one\n\t *\n\t * This function works solely on the basis of recurrence-ids.\n\t * It ignores the actual date of recurrence-exceptions.\n\t * Ideally we should fix it and provide a similar implementation\n\t * like getAllOccurrencesBetweenIterator, but for now it's the\n\t * accepted behavior.\n\t *\n\t * @param {DateTimeValue} recurrenceId RecurrenceId to get\n\t * @return {AbstractRecurringComponent}\n\t */\n\tgetClosestOccurrence(recurrenceId) {\n\t\tif (!this.masterItem.isRecurring()) {\n\t\t\treturn this.masterItem\n\t\t}\n\n\t\tconst iterator = this._getRecurExpansionObject()\n\t\trecurrenceId = recurrenceId.toICALJs()\n\n\t\tlet previous = null\n\t\tlet next\n\t\twhile ((next = iterator.next())) {\n\t\t\tif (next.compare(recurrenceId) === -1) {\n\t\t\t\tprevious = next\n\t\t\t} else {\n\t\t\t\t// This is the case when it's either equal or in the future\n\t\t\t\tconst dateTimeValue = DateTimeValue.fromICALJs(next)\n\t\t\t\treturn this._getOccurrenceAtRecurrenceId(dateTimeValue)\n\t\t\t}\n\t\t}\n\n\t\tconst dateTimeValue = DateTimeValue.fromICALJs(previous)\n\t\treturn this._getOccurrenceAtRecurrenceId(dateTimeValue)\n\t}\n\n\t/**\n\t * Counts all occurrences in the given time-range.\n\t * This function works solely on the basis of recurrence-ids.\n\t * Start and end are inclusive.\n\t *\n\t * @param {DateTimeValue} queriedTimeRangeStart Start of time-range\n\t * @param {DateTimeValue} queriedTimeRangeEnd End of time-range\n\t * @return {number} Count of occurrences in the given time-range\n\t */\n\tcountAllOccurrencesBetween(queriedTimeRangeStart, queriedTimeRangeEnd) {\n\t\tif (!this.masterItem.isRecurring()) {\n\t\t\tif (typeof this.masterItem.isInTimeFrame === 'function'\n\t\t\t\t&& !this.masterItem.isInTimeFrame(queriedTimeRangeStart, queriedTimeRangeEnd)) {\n\t\t\t\treturn 0\n\t\t\t}\n\n\t\t\treturn 1\n\t\t}\n\n\t\tconst iterator = this._getRecurExpansionObject()\n\t\tconst queriedICALJsTimeRangeStart = queriedTimeRangeStart.toICALJs()\n\t\tconst queriedICALJsTimeRangeEnd = queriedTimeRangeEnd.toICALJs()\n\n\t\tlet count = 0\n\t\tlet next\n\t\twhile ((next = iterator.next())) {\n\t\t\tif (next.compare(queriedICALJsTimeRangeStart) === -1) {\n\t\t\t\tcontinue\n\t\t\t}\n\n\t\t\tif (next.compare(queriedICALJsTimeRangeEnd) === 1) {\n\t\t\t\tbreak\n\t\t\t}\n\n\t\t\tcount += 1\n\t\t}\n\t\treturn count\n\t}\n\n\t/**\n\t * Get all occurrences between start and end\n\t * Start and End are inclusive\n\t *\n\t * @param {DateTimeValue} queriedTimeRangeStart Start of time-range\n\t * @param {DateTimeValue} queriedTimeRangeEnd End of time-range\n\t */\n\t* getAllOccurrencesBetweenIterator(queriedTimeRangeStart, queriedTimeRangeEnd) {\n\t\tif (!this.masterItem.isRecurring()) {\n\t\t\tif (typeof this.masterItem.isInTimeFrame !== 'function') {\n\t\t\t\tyield this.masterItem\n\t\t\t}\n\t\t\tif (this.masterItem.isInTimeFrame(queriedTimeRangeStart, queriedTimeRangeEnd)) {\n\t\t\t\tyield this.masterItem\n\t\t\t}\n\n\t\t\treturn\n\t\t}\n\n\t\tconst iterator = this._getRecurExpansionObject()\n\t\tconst queriedICALJsTimeRangeStart = queriedTimeRangeStart.toICALJs()\n\t\tconst queriedICALJsTimeRangeEnd = queriedTimeRangeEnd.toICALJs()\n\n\t\tconst recurrenceIdKeys = Array.from(this._recurrenceExceptionItems.keys())\n\t\tconst maximumRecurrenceId = Math.max.apply(Math, recurrenceIdKeys)\n\n\t\tlet next\n\t\twhile ((next = iterator.next())) {\n\t\t\t// We have to get the real occurrence to resolve RECURRENCE-IDs\n\t\t\tconst dateTimeValue = DateTimeValue.fromICALJs(next)\n\t\t\tconst occurrence = this._getOccurrenceAtRecurrenceId(dateTimeValue)\n\n\t\t\t// Check what type of recurrence object we are dealing with\n\t\t\t// Depending on that, the time to compare to changes\n\t\t\t// If we are dealing events, we have to compare to the end-date\n\t\t\t// If we are dealing with tasks, we will have to compare to the due-date\n\t\t\t// etc.\n\t\t\t// For now we are only implementing events, other components will come later\n\t\t\tlet compareDate = null\n\t\t\tswitch (uc(occurrence.name)) {\n\t\t\tcase 'VEVENT':\n\t\t\tcase 'VTODO':\n\t\t\t\tcompareDate = occurrence.endDate.toICALJs()\n\t\t\t\tbreak\n\n\t\t\tcase 'VJOURNAL':\n\t\t\tdefault:\n\t\t\t\tcompareDate = next\n\t\t\t\tbreak\n\t\t\t}\n\n\t\t\t// If the date we are comparing to is before our time-range,\n\t\t\t// we don't want to yield this event\n\t\t\tif (compareDate.compare(queriedICALJsTimeRangeStart) === -1) {\n\t\t\t\tcontinue\n\t\t\t}\n\n\t\t\t// If we have an object that is:\n\t\t\t// 1. either\n\t\t\t// 1.1 - no recurrence exception\n\t\t\t//     or\n\t\t\t// 1.2 - a recurrence-exception that modifies the future\n\t\t\t// and\n\t\t\t// 2. starts after the queried time-range ends, then we stop expanding\n\t\t\tconst startDate = occurrence.startDate.toICALJs()\n\t\t\tif ((!occurrence.isRecurrenceException() || occurrence.modifiesFuture()) && startDate.compare(queriedICALJsTimeRangeEnd) === 1) {\n\t\t\t\t// Just break if there are no recurrence-exceptions\n\t\t\t\tif (this._recurrenceExceptionItems.size === 0) {\n\t\t\t\t\tbreak\n\t\t\t\t}\n\n\t\t\t\t// Keep iterating until our currently checked recurrenceId\n\t\t\t\t// is bigger than the maximum recurrence-id that we have.\n\t\t\t\tif (next.toUnixTime() > maximumRecurrenceId) {\n\t\t\t\t\tbreak\n\t\t\t\t} else {\n\t\t\t\t\tcontinue\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (typeof occurrence.isInTimeFrame !== 'function') {\n\t\t\t\tyield occurrence\n\t\t\t}\n\t\t\tif (occurrence.isInTimeFrame(queriedTimeRangeStart, queriedTimeRangeEnd)) {\n\t\t\t\tyield occurrence\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Get all occurrences between start and end\n\t *\n\t * @param {DateTimeValue} start Start of time-range\n\t * @param {DateTimeValue} end End of time-range\n\t * @return {(*|null)[]}\n\t */\n\tgetAllOccurrencesBetween(start, end) {\n\t\treturn Array.from(this.getAllOccurrencesBetweenIterator(start, end))\n\t}\n\n\t/**\n\t * Update the UID of all components in the recurrence set\n\t *\n\t * @param {string} newUID The new UID of the calendar-document\n\t */\n\tupdateUID(newUID) {\n\t\tthis._masterItem.updatePropertyWithValue('UID', newUID)\n\n\t\tfor (const recurrenceExceptionItem of this.getRecurrenceExceptionIterator()) {\n\t\t\trecurrenceExceptionItem.updatePropertyWithValue('UID', newUID)\n\t\t}\n\t}\n\n\t/**\n\t * Updates the recurrence-information accordingly,\n\t * whenever the start-date of the master-item changes\n\t *\n\t * @param {DateTimeValue} newStartDate The new start-date\n\t * @param {DateTimeValue} oldStartDate The old start-date\n\t */\n\tupdateStartDateOfMasterItem(newStartDate, oldStartDate) {\n\t\tconst difference = newStartDate.subtractDateWithTimezone(oldStartDate)\n\n\t\t// update EXDATE\n\t\tfor (const exdate of this.getRecurrenceDateIterator(true)) {\n\t\t\t// If this EXDATE matches an RDATE, don't update, because we don't update RDATEs\n\t\t\tif (this.hasRecurrenceDate(false, exdate)) {\n\t\t\t\tcontinue\n\t\t\t}\n\n\t\t\t// EXDATE are always either DATE or DATETIME,\n\t\t\t// no need to check for PERIOD\n\t\t\texdate.addDuration(difference)\n\t\t}\n\n\t\tfor (const recurrenceException of this.getRecurrenceExceptionIterator()) {\n\t\t\t// We don't edit RDATES, so don't update recurrence-ids if they\n\t\t\t// are based on an RDATE\n\t\t\tif (this.hasRecurrenceDate(false, recurrenceException.recurrenceId)) {\n\t\t\t\tcontinue\n\t\t\t}\n\n\t\t\tthis.removeRecurrenceException(recurrenceException)\n\t\t\trecurrenceException.recurrenceId.addDuration(difference)\n\t\t\tthis.relateRecurrenceException(recurrenceException)\n\t\t}\n\n\t\t// update UNTIL of recurrence-rules\n\t\tfor (const rrule of this.getRecurrenceRuleIterator()) {\n\t\t\tif (rrule.until) {\n\t\t\t\trrule.until.addDuration(difference)\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Gets an object for the given recurrenceId\n\t * It does not verify that the given recurrenceId\n\t * is actually a valid recurrence of this calendar-document\n\t *\n\t * @param {DateTimeValue} recurrenceId Recurrence-Id to get\n\t * @return {AbstractRecurringComponent}\n\t * @private\n\t */\n\t_getOccurrenceAtRecurrenceId(recurrenceId) {\n\t\tif (this.hasRecurrenceExceptionForId(recurrenceId)) {\n\t\t\tconst recurrenceException = this.getRecurrenceException(recurrenceId)\n\n\t\t\tif (!recurrenceException.canCreateRecurrenceExceptions()) {\n\t\t\t\treturn recurrenceException\n\t\t\t}\n\n\t\t\treturn recurrenceException\n\t\t\t\t.forkItem(recurrenceId)\n\t\t} else if (this.hasRangeRecurrenceExceptionForId(recurrenceId)) {\n\t\t\tconst rangeRecurrenceException = this.getRangeRecurrenceExceptionForId(recurrenceId)\n\t\t\tconst difference = this.getRangeRecurrenceExceptionDiff(recurrenceId)\n\n\t\t\treturn rangeRecurrenceException\n\t\t\t\t.forkItem(recurrenceId, difference)\n\t\t} else if (recurrenceId.compare(this._masterItem.startDate) === 0) {\n\t\t\tif (!this._masterItem.canCreateRecurrenceExceptions()) {\n\t\t\t\treturn this._masterItem\n\t\t\t}\n\n\t\t\treturn this._masterItem\n\t\t\t\t.forkItem(recurrenceId)\n\t\t} else {\n\t\t\treturn this._masterItem\n\t\t\t\t.forkItem(recurrenceId)\n\t\t}\n\t}\n\n\t/**\n\t * Resets the internal recur-expansion object.\n\t * This is necessary after each modification of the\n\t * recurrence-information\n\t */\n\tresetCache() {\n\t\t// TODO - implement me\n\t}\n\n\t/**\n\t * Gets a new ICAL.RecurExpansion object\n\t *\n\t * Inspired by how ICAL.JS RecurExpansion\n\t * serialises and unserialises its state\n\t *\n\t * @return {ICAL.RecurExpansion}\n\t * @private\n\t */\n\t_getRecurExpansionObject() {\n\t\tif (this._masterItem.startDate === null) {\n\t\t\tthrow new RecurringWithoutDtStartError()\n\t\t}\n\n\t\tconst dtstart = this._masterItem.startDate.toICALJs()\n\t\tlet last = dtstart.clone()\n\t\tconst ruleIterators = []\n\t\tlet ruleDateInc\n\t\tconst ruleDates = []\n\t\tlet ruleDate = null\n\t\tconst exDates = []\n\t\tconst complete = false\n\n\t\tfor (const ruleValue of this.getRecurrenceRuleIterator()) {\n\t\t\truleIterators.push(ruleValue.toICALJs().iterator(dtstart))\n\t\t\truleIterators[ruleIterators.length - 1].next()\n\t\t}\n\n\t\tfor (let rDateValue of this.getRecurrenceDateIterator()) {\n\t\t\tif (rDateValue instanceof PeriodValue) {\n\t\t\t\trDateValue = rDateValue.start\n\t\t\t}\n\n\t\t\trDateValue = rDateValue.toICALJs()\n\t\t\tconst index = ICAL.helpers.binsearchInsert(\n\t\t\t\truleDates,\n\t\t\t\trDateValue,\n\t\t\t\t(a, b) => a.compare(b)\n\t\t\t)\n\n\t\t\truleDates.splice(index, 0, rDateValue)\n\t\t}\n\n\t\t// Is the first RDATE prior to our current DTSTART?\n\t\tif (ruleDates.length > 0 && ruleDates[0].compare(dtstart) === -1) {\n\t\t\truleDateInc = 0\n\t\t\tlast = ruleDates[0].clone()\n\t\t} else {\n\t\t\truleDateInc = ICAL.helpers.binsearchInsert(\n\t\t\t\truleDates,\n\t\t\t\tdtstart,\n\t\t\t\t(a, b) => a.compare(b)\n\t\t\t)\n\t\t\truleDate = exDates[ruleDateInc]\n\t\t}\n\n\t\tfor (let exDateValue of this.getRecurrenceDateIterator(true)) {\n\t\t\texDateValue = exDateValue.toICALJs()\n\t\t\tconst index = ICAL.helpers.binsearchInsert(\n\t\t\t\texDates,\n\t\t\t\texDateValue,\n\t\t\t\t(a, b) => a.compare(b)\n\t\t\t)\n\t\t\texDates.splice(index, 0, exDateValue)\n\t\t}\n\n\t\tconst exDateInc = ICAL.helpers.binsearchInsert(\n\t\t\texDates,\n\t\t\tdtstart,\n\t\t\t(a, b) => a.compare(b)\n\t\t)\n\t\tconst exDate = exDates[exDateInc]\n\n\t\treturn new ICAL.RecurExpansion({\n\t\t\tdtstart,\n\t\t\tlast,\n\t\t\truleIterators,\n\t\t\truleDateInc,\n\t\t\texDateInc,\n\t\t\truleDates,\n\t\t\truleDate,\n\t\t\texDates,\n\t\t\texDate,\n\t\t\tcomplete,\n\t\t})\n\t}\n\n\t/**\n\t * @private\n\t */\n\t_modify() {\n\t\tif (this._masterItem.isLocked()) {\n\t\t\tthrow new ModificationNotAllowedError()\n\t\t}\n\t}\n\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nimport ICAL from 'ical.js'\n\n/**\n * @class Timezone\n */\nexport default class Timezone {\n\n\t/**\n\t * Constructor\n\t *\n\t * @param {string | ICAL.Timezone | ICAL.Component} timezoneId Id of the timezone\n\t * @param {string?} ics The iCalendar timezone definition\n\t */\n\tconstructor(timezoneId, ics) {\n\n\t\t/**\n\t\t * Id of the timezone, used before initialising\n\t\t *\n\t\t * @type {string}\n\t\t * @private\n\t\t */\n\t\tthis._timezoneId = null\n\n\t\t/**\n\t\t * ICS representation of the timezone, used before initialising\n\t\t *\n\t\t * @type {string}\n\t\t * @private\n\t\t */\n\t\tthis._ics = null\n\n\t\t/**\n\t\t * @type {ICAL.Timezone|null}\n\t\t */\n\t\tthis._innerValue = null\n\n\t\t/**\n\t\t *\n\t\t * @type {boolean}\n\t\t * @private\n\t\t */\n\t\tthis._initialized = false\n\n\t\t// If the first parameter is already\n\t\t// an instance of ICAL.Timezone,\n\t\t// skip lazy loading\n\t\tif (timezoneId instanceof ICAL.Timezone) {\n\t\t\tthis._innerValue = timezoneId\n\t\t\tthis._initialized = true\n\t\t} else if (timezoneId instanceof ICAL.Component) {\n\t\t\tthis._innerValue = new ICAL.Timezone(timezoneId)\n\t\t\tthis._initialized = true\n\t\t} else {\n\t\t\tthis._timezoneId = timezoneId\n\t\t\tthis._ics = ics\n\t\t}\n\t}\n\n\t/**\n\t * Gets the timezone id\n\t *\n\t * @return {string}\n\t */\n\tget timezoneId() {\n\t\tif (this._initialized) {\n\t\t\treturn this._innerValue.tzid\n\t\t}\n\n\t\treturn this._timezoneId\n\t}\n\n\t/**\n\t * Gets the UTC Offset for a given date in this timezone\n\t *\n\t * @param {number} year Year of the date\n\t * @param {number} month Month of the date (1-based)\n\t * @param {number} day Day of the date\n\t * @param {number} hour Hour of the date\n\t * @param {number} minute Minute of the date\n\t * @param {number} second Second of the date\n\t * @return {number}\n\t */\n\toffsetForArray(year, month, day, hour, minute, second) {\n\t\tthis._initialize()\n\n\t\tconst time = new ICAL.Time({\n\t\t\tyear,\n\t\t\tmonth,\n\t\t\tday,\n\t\t\thour,\n\t\t\tminute,\n\t\t\tsecond,\n\t\t\tisDate: false,\n\t\t})\n\t\treturn this._innerValue.utcOffset(time)\n\t}\n\n\t/**\n\t * Converts a timestamp to an array of year, month, day, hour, minute, second.\n\t *\n\t * @param {number} ms Timestamp in milliseconds\n\t * @return {number[]}\n\t */\n\ttimestampToArray(ms) {\n\t\tthis._initialize()\n\n\t\t// just create a dummy object because fromUnixTime is not exposed on ICAL.Time\n\t\tconst time = ICAL.Time.fromData({\n\t\t\tyear: 1970,\n\t\t\tmonth: 1,\n\t\t\tday: 1,\n\t\t\thour: 0,\n\t\t\tminute: 0,\n\t\t\tsecond: 0,\n\t\t})\n\t\ttime.fromUnixTime(Math.floor(ms / 1000))\n\n\t\tconst local = time.convertToZone(this._innerValue)\n\t\treturn [\n\t\t\tlocal.year,\n\t\t\tlocal.month, // THIS is 1-based !\n\t\t\tlocal.day,\n\t\t\tlocal.hour,\n\t\t\tlocal.minute,\n\t\t\tlocal.second,\n\t\t]\n\t}\n\n\t/**\n\t * Returns\n\t *\n\t * @return {ICAL.Timezone}\n\t */\n\ttoICALTimezone() {\n\t\tthis._initialize()\n\t\treturn this._innerValue\n\t}\n\n\t/**\n\t * Returns the corresponding ICAL.\n\t *\n\t * @return {ICAL.Component}\n\t */\n\ttoICALJs() {\n\t\tthis._initialize()\n\t\treturn this._innerValue.component\n\t}\n\n\t/**\n\t * Initialises the inner ICAL.Timezone component\n\t *\n\t * @private\n\t */\n\t_initialize() {\n\t\tif (!this._initialized) {\n\t\t\tconst jCal = ICAL.parse(this._ics)\n\t\t\tconst icalComp = new ICAL.Component(jCal)\n\t\t\tthis._innerValue = new ICAL.Timezone(icalComp)\n\t\t\tthis._initialized = true\n\t\t}\n\t}\n\n}\n\nTimezone.utc = new Timezone(ICAL.Timezone.utcTimezone)\nTimezone.floating = new Timezone(ICAL.Timezone.localTimezone)\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport AbstractComponent, {\n\tadvertiseMultipleOccurrenceProperty,\n\tadvertiseSingleOccurrenceProperty,\n} from '../abstractComponent.js'\nimport AttendeeProperty from '../../properties/attendeeProperty.js'\nimport TriggerProperty from '../../properties/triggerProperty.js'\n\n/**\n * @class AlarmComponent\n * @classdesc\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.6.6\n */\nexport default class AlarmComponent extends AbstractComponent {\n\n\t/**\n\t * Adds a new attendee based on their name and email-address\n\t *\n\t * @param {string} name - Name of the attendee\n\t * @param {string} email - E-Mail address of the attendee\n\t * @return {boolean}\n\t */\n\taddAttendeeFromNameAndEMail(name, email) {\n\t\tconst attendeeProperty = AttendeeProperty.fromNameAndEMail(name, email)\n\t\treturn this.addProperty(attendeeProperty)\n\t}\n\n\t/**\n\t * Gets the trigger property\n\t *\n\t * @url https://tools.ietf.org/html/rfc5545#section-3.8.6.3\n\t *\n\t * @return {TriggerProperty}\n\t */\n\tget trigger() {\n\t\treturn this.getFirstProperty('TRIGGER')\n\t}\n\n\t/**\n\t * Sets an absolute alarm\n\t *\n\t * @param {DateTimeValue} alarmTime - Absolute time for the trigger\n\t */\n\tsetTriggerFromAbsolute(alarmTime) {\n\t\tconst triggerProperty = TriggerProperty.fromAbsolute(alarmTime)\n\t\tthis.deleteAllProperties('TRIGGER')\n\t\tthis.addProperty(triggerProperty)\n\t}\n\n\t/**\n\t * Sets a relative trigger\n\t *\n\t * @param {DurationValue} alarmOffset - Relative time of the trigger, either related to start or end\n\t * @param {boolean=} relatedToStart - Related to Start or end?\n\t */\n\tsetTriggerFromRelative(alarmOffset, relatedToStart = true) {\n\t\tconst triggerProperty = TriggerProperty.fromRelativeAndRelated(alarmOffset, relatedToStart)\n\t\tthis.deleteAllProperties('TRIGGER')\n\t\tthis.addProperty(triggerProperty)\n\t}\n\n}\n\n/**\n * Action to be taken when this Alarm is due\n * Possible values:\n * - AUDIO\n * - DISPLAY\n * - EMAIL\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.6.1\n *\n * @name AlarmComponent#action\n * @type {string}\n */\nadvertiseSingleOccurrenceProperty(AlarmComponent.prototype, 'action')\n\n/**\n * Description for this alarm\n * Can only be used in combination with action DISPLAY and EMAIL\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.1.5\n *\n * @name AlarmComponent#description\n * @type {string}\n */\nadvertiseSingleOccurrenceProperty(AlarmComponent.prototype, 'description')\n\n/**\n * Summary for this alarm\n * Can only be used in combination with action EMAIL\n * Will be used as the EMAIL's subject\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.1.12\n *\n * @name AlarmComponent#summary\n * @type {string}\n */\nadvertiseSingleOccurrenceProperty(AlarmComponent.prototype, 'summary')\n\n/**\n * The duration specifies the delay period between repeated alarms.\n * This property must be specified along with the repeat property\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.2.5\n *\n * @name AlarmComponent#duration\n * @type {string}\n */\nadvertiseSingleOccurrenceProperty(AlarmComponent.prototype, 'duration')\n\n/**\n * The number of times an alarm should be repeated.\n * This property must be specified along with the duration property\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.6.2\n *\n * @name AlarmComponent#repeat\n * @type {number}\n */\nadvertiseSingleOccurrenceProperty(AlarmComponent.prototype, 'repeat')\n\n/**\n * This attachment points to a sound file, can only be used in combination\n * with ACTION AUDIO\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.1.1\n *\n * @name AlarmComponent#attachment\n * @type {AttachmentProperty}\n */\nadvertiseSingleOccurrenceProperty(AlarmComponent.prototype, {\n\tname: 'attachment',\n\tiCalendarName: 'ATTACH',\n})\n\n/**\n * Get an iterator over all attendees\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.4.1\n *\n * @name AlarmComponent#getAttendeeIterator\n * @function\n * @return {IterableIterator<AttendeeProperty>}\n */\n\n/**\n * Get a list of all attendees\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.4.1\n *\n * @name AlarmComponent#getAttendeeList\n * @function\n * @return {AttendeeProperty[]}\n */\n\n/**\n * Adds a new attendee to this alarm-component\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.4.1\n *\n * @name AlarmComponent#addAttendee\n * @function\n * @param {AttendeeProperty} attendee - The attendee object to add\n */\n\n/**\n * Removes an attendee from this alarm-component\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.4.1\n *\n * @name AlarmComponent#removeAttendee\n * @function\n * @param {AttendeeProperty} attendee - The attendee object to remove\n */\n\n/**\n * Removes all attendees from this alarm-component\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.4.1\n *\n * @name AlarmComponent#clearAllAttendees\n * @function\n */\nadvertiseMultipleOccurrenceProperty(AlarmComponent.prototype, 'attendee')\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport AbstractComponent from '../abstractComponent.js'\nimport AlarmComponent from './alarmComponent.js'\nimport { uc } from '../../helpers/stringHelper.js'\n\n/**\n * Gets the constructor for a component name\n * This will only return a constructor for components,\n * that can be nested inside other ones\n *\n * @param {string} compName - Component name to get default constructor for\n * @return {AlarmComponent|AbstractComponent}\n */\nexport function getConstructorForComponentName(compName) {\n\tswitch (uc(compName)) {\n\tcase 'VALARM':\n\t\treturn AlarmComponent\n\n\tdefault:\n\t\treturn AbstractComponent\n\t}\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport AbstractComponent, {\n\tadvertiseComponent,\n\tadvertiseMultipleOccurrenceProperty,\n\tadvertiseMultiValueStringPropertySeparatedByLang,\n\tadvertiseSingleOccurrenceProperty,\n} from '../abstractComponent.js'\nimport DateTimeValue from '../../values/dateTimeValue.js'\nimport DurationValue from '../../values/durationValue.js'\nimport PeriodValue from '../../values/periodValue.js'\nimport { dateFactory } from '../../factories/dateFactory.js'\nimport { uc } from '../../helpers/stringHelper.js'\nimport RecurrenceManager from '../../recurrence/recurrenceManager.js'\nimport { v4 as uuid } from 'uuid'\nimport RelationProperty from '../../properties/relationProperty.js'\nimport AttendeeProperty from '../../properties/attendeeProperty.js'\nimport Timezone from '../../timezones/timezone.js'\nimport RequestStatusProperty from '../../properties/requestStatusProperty.js'\nimport AttachmentProperty from '../../properties/attachmentProperty.js'\nimport ImageProperty from '../../properties/imageProperty.js'\nimport TextProperty from '../../properties/textProperty.js'\nimport AlarmComponent from '../nested/alarmComponent.js'\nimport TriggerProperty from '../../properties/triggerProperty.js'\nimport { getConfig } from '../../config.js'\nimport { getConstructorForComponentName } from '../nested/index.js'\n\n/**\n * @class AbstractRecurringComponent\n * @classdesc AbstractRecurringComponent is the basis for\n * EventComponent, JournalComponent and TodoComponent.\n *\n * It contains all the logic for recurrence-expansion and\n * recurrence-management plus all management for all\n * properties and all subcomponents that the three\n * components mentioned before have in common\n */\nexport default class AbstractRecurringComponent extends AbstractComponent {\n\n\t/**\n\t * @inheritDoc\n\t */\n\tconstructor(...args) {\n\t\tsuper(...args)\n\n\t\t/**\n\t\t * In case this object is virtual, primary item refers to the master object\n\t\t * that this object was forked from.\n\t\t *\n\t\t * Otherwise primary item is null\n\t\t *\n\t\t * @type {AbstractRecurringComponent}\n\t\t * @private\n\t\t */\n\t\tthis._primaryItem = null\n\n\t\t/**\n\t\t * Indicator whether this is a direct fork of a primary item, representing\n\t\t * the very same recurrence id\n\t\t *\n\t\t * @type {boolean}\n\t\t * @private\n\t\t */\n\t\tthis._isExactForkOfPrimary = false\n\n\t\t/**\n\t\t * The original recurrence-id of this occurrence.\n\t\t * Mostly needed for range exceptions with a range\n\t\t *\n\t\t * @type {DateTimeValue|null}\n\t\t * @private\n\t\t */\n\t\tthis._originalRecurrenceId = null\n\n\t\t/**\n\t\t * Instance of the recurrence manager.\n\t\t * This object is shared among all instances\n\t\t * of a recurrence-set\n\t\t *\n\t\t * @type {RecurrenceManager}\n\t\t * @private\n\t\t */\n\t\tthis._recurrenceManager = null\n\n\t\t/**\n\t\t * Indicator whether this component was modified\n\t\t * In case it was, the last-modified property\n\t\t * needs to be updated before saving the event\n\t\t *\n\t\t * @type {boolean}\n\t\t * @private\n\t\t */\n\t\tthis._dirty = false\n\n\t\t/**\n\t\t * Indicator whether there have been significant changes\n\t\t * In case the changes are considered significant,\n\t\t * the sequence needs to be incremented\n\t\t *\n\t\t * @type {boolean}\n\t\t * @private\n\t\t */\n\t\tthis._significantChange = false\n\n\t\t/**\n\t\t * Id of this AbstractRecurringComponent\n\t\t *\n\t\t * @type {string | null}\n\t\t * @private\n\t\t */\n\t\tthis._cachedId = null\n\t}\n\n\t/**\n\t * Gets the primary-item of this recurring item\n\t *\n\t * @return {AbstractRecurringComponent}\n\t */\n\tget primaryItem() {\n\t\treturn this._primaryItem\n\t}\n\n\t/**\n\t * Sets the primary-item of this recurring item\n\t *\n\t * @param {AbstractRecurringComponent} primaryItem The new primary-item\n\t */\n\tset primaryItem(primaryItem) {\n\t\tthis._modify()\n\t\tthis._primaryItem = primaryItem\n\t}\n\n\t/**\n\t * Gets whether or not this is a fork of the primary item\n\t * for the same recurrence-id\n\t *\n\t * @return {boolean}\n\t */\n\tget isExactForkOfPrimary() {\n\t\treturn this._isExactForkOfPrimary\n\t}\n\n\t/**\n\t * Sets the isExactForkOfPrimary indicator, see getter for description\n\t *\n\t * @param {boolean} isExactForkOfPrimary Whether or not this is an exact fork\n\t */\n\tset isExactForkOfPrimary(isExactForkOfPrimary) {\n\t\tthis._isExactForkOfPrimary = isExactForkOfPrimary\n\t}\n\n\t/**\n\t * Gets the original recurrence-id\n\t *\n\t * @return {DateTimeValue}\n\t */\n\tget originalRecurrenceId() {\n\t\treturn this._originalRecurrenceId\n\t}\n\n\t/**\n\t * Sets the original recurrence-id\n\t *\n\t * @param {DateTimeValue} originalRecurrenceId The new original recurrence-id\n\t */\n\tset originalRecurrenceId(originalRecurrenceId) {\n\t\tthis._originalRecurrenceId = originalRecurrenceId\n\t}\n\n\t/**\n\t * Gets the recurrence-manager of this recurrence-set\n\t *\n\t * @return {RecurrenceManager}\n\t */\n\tget recurrenceManager() {\n\t\treturn this._recurrenceManager\n\t}\n\n\t/**\n\t * Sets the recurrence-manager of this recurrence-set\n\t *\n\t * @param {RecurrenceManager} recurrenceManager The new recurrence-manager\n\t */\n\tset recurrenceManager(recurrenceManager) {\n\t\tthis._recurrenceManager = recurrenceManager\n\t}\n\n\t/**\n\t * Gets the master-item of this recurring item\n\t *\n\t * @return {AbstractRecurringComponent}\n\t */\n\tget masterItem() {\n\t\treturn this.recurrenceManager.masterItem\n\t}\n\n\t/**\n\t * Returns whether this item is the master item\n\t *\n\t * @return {boolean}\n\t */\n\tisMasterItem() {\n\t\treturn this.masterItem === this\n\t}\n\n\t/**\n\t * Gets a unique ID for this occurrence of the event\n\t *\n\t * Please note that if the same event occurs in multiple calendars,\n\t * this id will not be unique. Software using this library will have to\n\t * manually mix in the calendar id into this id\n\t *\n\t * @return {string}\n\t */\n\tget id() {\n\t\tif (this._cachedId) {\n\t\t\treturn this._cachedId\n\t\t}\n\n\t\tif (this.startDate === null) {\n\t\t\tthis._cachedId = encodeURIComponent(this.uid)\n\t\t\treturn this._cachedId\n\t\t}\n\n\t\tthis._cachedId = [\n\t\t\tencodeURIComponent(this.uid),\n\t\t\tencodeURIComponent(this.getReferenceRecurrenceId().unixTime.toString()),\n\t\t].join('###')\n\n\t\treturn this._cachedId\n\t}\n\n\t/**\n\t * Gets the UID property\n\t *\n\t * @return {string | null}\n\t */\n\tget uid() {\n\t\treturn this.getFirstPropertyFirstValue('UID')\n\t}\n\n\t/**\n\t * Sets the UID property and the UID property of all related exceptions\n\t *\n\t * @param {string} uid The new UID\n\t */\n\tset uid(uid) {\n\t\tthis._recurrenceManager.updateUID(uid)\n\t}\n\n\t/**\n\t * Gets the start date of the event\n\t *\n\t * @return {DateTimeValue}\n\t */\n\tget startDate() {\n\t\treturn this.getFirstPropertyFirstValue('dtstart')\n\t}\n\n\t/**\n\t * Sets the start date of the event\n\t *\n\t * @param {DateTimeValue} start The new start-date to set\n\t */\n\tset startDate(start) {\n\t\tconst oldStartDate = this.startDate\n\t\tthis.updatePropertyWithValue('dtstart', start)\n\n\t\tif (this.isMasterItem()) {\n\t\t\tthis._recurrenceManager.updateStartDateOfMasterItem(start, oldStartDate)\n\t\t}\n\t}\n\n\t/**\n\t * Checks whether this item is part of a recurring set\n\t *\n\t * @return {boolean}\n\t */\n\tisPartOfRecurrenceSet() {\n\t\treturn this.masterItem.isRecurring()\n\t}\n\n\t/**\n\t * Checks whether this component is recurring\n\t *\n\t * @return {boolean}\n\t */\n\tisRecurring() {\n\t\treturn this.hasProperty('RRULE') || this.hasProperty('RDATE')\n\t}\n\n\t/**\n\t * Checks whether this component is a recurrence-exception\n\t *\n\t * @return {boolean}\n\t */\n\tisRecurrenceException() {\n\t\treturn this.hasProperty('RECURRENCE-ID')\n\t}\n\n\t/**\n\t * Checks wether this component is a recurrence-exception\n\t * and whether it's modifying the future\n\t *\n\t * @return {boolean}\n\t */\n\tmodifiesFuture() {\n\t\tif (!this.isRecurrenceException()) {\n\t\t\treturn false\n\t\t}\n\n\t\tconst property = this.getFirstProperty('RECURRENCE-ID')\n\t\treturn property.getParameterFirstValue('RANGE') === 'THISANDFUTURE'\n\t}\n\n\t/**\n\t * Creates an occurrence at the given time\n\t *\n\t * This is an internal function for calendar-js, used by the recurrence-manager\n\t * Do not call from outside\n\t *\n\t * @param {DateTimeValue} recurrenceId The recurrence-Id of the forked item\n\t * @param {DurationValue=} startDiff to be used when The start-diff (used for RECURRENCE-ID;RANGE=THISANDFUTURE)\n\t * @return {AbstractRecurringComponent}\n\t */\n\tforkItem(recurrenceId, startDiff = null) {\n\t\tconst occurrence = this.clone()\n\n\t\toccurrence.recurrenceManager = this.recurrenceManager\n\t\toccurrence.primaryItem = this\n\n\t\t// Exact match for master item or recurrence-exception\n\t\tif (occurrence.getReferenceRecurrenceId().compare(recurrenceId) === 0) {\n\t\t\toccurrence.isExactForkOfPrimary = true\n\t\t}\n\n\t\tif (!occurrence.hasProperty('DTSTART')) {\n\t\t\tthrow new TypeError('Can\\'t fork item without a DTSTART')\n\t\t}\n\n\t\t// Adjust RRULE COUNT if present\n\t\tconst rrule = occurrence.getFirstPropertyFirstValue('RRULE')\n\t\tif (rrule?.count) {\n\t\t\tlet index = occurrence.recurrenceManager.countAllOccurrencesBetween(\n\t\t\t\toccurrence.getReferenceRecurrenceId(),\n\t\t\t\trecurrenceId,\n\t\t\t)\n\n\t\t\tindex -= 1 // Don't count the forked occurrence\n\t\t\trrule.count -= index\n\t\t\tif (rrule.count < 1) {\n\t\t\t\trrule.count = 1\n\t\t\t}\n\t\t}\n\n\t\tif (occurrence.getFirstPropertyFirstValue('DTSTART').timezoneId !== recurrenceId.timezoneId) {\n\t\t\tconst originalTimezone = occurrence.getFirstPropertyFirstValue('DTSTART').getICALTimezone()\n\t\t\trecurrenceId = recurrenceId.getInICALTimezone(originalTimezone)\n\t\t}\n\n\t\toccurrence.originalRecurrenceId = recurrenceId.clone()\n\n\t\tconst dtStartValue = occurrence.getFirstPropertyFirstValue('DTSTART')\n\n\t\tlet period = null\n\t\tif (this._recurrenceManager.hasRecurrenceDate(false, recurrenceId)) {\n\t\t\tconst recurrenceDate = this._recurrenceManager.getRecurrenceDate(false, recurrenceId)\n\t\t\tif (recurrenceDate instanceof PeriodValue) {\n\t\t\t\tperiod = recurrenceDate\n\t\t\t}\n\t\t}\n\n\t\tlet duration\n\t\tif (occurrence.hasProperty('DTEND')) {\n\t\t\tconst dtEndValue = occurrence.getFirstPropertyFirstValue('DTEND')\n\t\t\tduration = dtEndValue.subtractDateWithTimezone(dtStartValue)\n\t\t} else if (occurrence.hasProperty('DUE')) {\n\t\t\tconst dueValue = occurrence.getFirstPropertyFirstValue('DUE')\n\t\t\tduration = dueValue.subtractDateWithTimezone(dtStartValue)\n\t\t}\n\n\t\tif (!(occurrence.isRecurrenceException() && occurrence.isExactForkOfPrimary)) {\n\t\t\toccurrence.updatePropertyWithValue('DTSTART', recurrenceId.clone())\n\n\t\t\tif (startDiff) {\n\t\t\t\toccurrence.startDate.addDuration(startDiff)\n\t\t\t}\n\n\t\t\tif (occurrence.hasProperty('DTEND')) {\n\t\t\t\tconst dtEnd = occurrence.startDate.clone()\n\t\t\t\tdtEnd.addDuration(duration)\n\t\t\t\toccurrence.updatePropertyWithValue('DTEND', dtEnd)\n\t\t\t} else if (occurrence.hasProperty('DUE')) {\n\t\t\t\tconst due = occurrence.startDate.clone()\n\t\t\t\tdue.addDuration(duration)\n\t\t\t\toccurrence.updatePropertyWithValue('DUE', due)\n\t\t\t}\n\n\t\t\tif (period) {\n\t\t\t\toccurrence.deleteAllProperties('DTEND')\n\t\t\t\toccurrence.deleteAllProperties('DURATION')\n\n\t\t\t\toccurrence.updatePropertyWithValue('DTEND', period.end.clone())\n\t\t\t}\n\t\t}\n\n\t\toccurrence.resetDirty()\n\n\t\treturn occurrence\n\t}\n\n\t/**\n\t * Checks whether it's possible to create a recurrence exception for this event\n\t * It is possible\n\t *\n\t * @return {boolean}\n\t */\n\tcanCreateRecurrenceExceptions() {\n\t\tlet primaryIsRecurring = false\n\t\tif (this.primaryItem && this.primaryItem.isRecurring()) {\n\t\t\tprimaryIsRecurring = true\n\t\t}\n\t\treturn this.isRecurring() || this.modifiesFuture() || (!this.isRecurring() && primaryIsRecurring)\n\t}\n\n\t/**\n\t * creates a recurrence exception based on this event\n\t * If the parameter thisAndAllFuture is set to true,\n\t * it will apply changes to this and all future occurrences\n\t *\n\t * @param {boolean} thisAndAllFuture Whether to create an exception for this and all future\n\t * @return {AbstractRecurringComponent[]} the AbstractRecurringComponent of the future events.\n\t * In case you set `thisAndAllFuture` to true, this will be an\n\t * AbstractRecurringComponent inside a entirely new calendar component\n\t */\n\tcreateRecurrenceException(thisAndAllFuture = false) {\n\t\tif (!this.canCreateRecurrenceExceptions()) {\n\t\t\tthrow new Error('Can\\'t create recurrence-exceptions for non-recurring items')\n\t\t}\n\n\t\tconst previousPrimaryItem = this.primaryItem\n\n\t\t/**\n\t\t * The overall support for RANGE=THISANDFUTURE is really bad.\n\t\t * Instead, we have to create a new event/journal/task and\n\t\t * set an until date on the old one.\n\t\t *\n\t\t * Also see:\n\t\t * - https://github.com/nextcloud/calendar/issues/7#issuecomment-292574813\n\t\t * - https://github.com/nextcloud/calendar/issues/7#issuecomment-299169143\n\t\t *\n\t\t * Right now, this replaces all future occurrence modifications,\n\t\t * including recurrence-exceptions, RDATES and EXDATES.\n\t\t * This is also how other CUAs handle it, but i would be happy\n\t\t * to put that up for discussion.\n\t\t *\n\t\t * Keeping future RDates + their recurrence-exceptions would be rather easy.\n\t\t * Updating recurrence-exceptions, that are based off normal recurrence rules,\n\t\t * could be very expensive.\n\t\t */\n\t\tif (thisAndAllFuture) {\n\t\t\tif (this.isExactForkOfPrimary) {\n\t\t\t\t// master item\n\t\t\t\tif (this.primaryItem.isMasterItem()) {\n\t\t\t\t\tthis._overridePrimaryItem()\n\t\t\t\t\treturn [this, this]\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.removeThisOccurrence(true)\n\t\t\tthis.recurrenceManager = new RecurrenceManager(this)\n\t\t\tthis._originalRecurrenceId = null\n\n\t\t\tthis.primaryItem = this\n\t\t\tthis.updatePropertyWithValue('UID', uuid())\n\t\t\tthis._cachedId = null\n\n\t\t\tthis.addRelation('SIBLING', previousPrimaryItem.uid)\n\t\t\tpreviousPrimaryItem.addRelation('SIBLING', this.uid)\n\n\t\t\t// delete to make sure all parameters are gone\n\t\t\tthis.deleteAllProperties('RECURRENCE-ID')\n\t\t\tthis.deleteAllProperties('RDATE')\n\t\t\tthis.deleteAllProperties('EXDATE')\n\t\t\tthis.updatePropertyWithValue('CREATED', DateTimeValue.fromJSDate(dateFactory(), true))\n\t\t\tthis.updatePropertyWithValue('DTSTAMP', DateTimeValue.fromJSDate(dateFactory(), true))\n\t\t\tthis.updatePropertyWithValue('LAST-MODIFIED', DateTimeValue.fromJSDate(dateFactory(), true))\n\t\t\tthis.updatePropertyWithValue('SEQUENCE', 0)\n\t\t\tthis._significantChange = false\n\t\t\tthis._dirty = false\n\n\t\t\tthis.root = this.root.constructor.fromEmpty()\n\t\t\tthis.root.addComponent(this)\n\t\t\tthis.parent = this.root\n\n\t\t\t// this is a completely new event, we should set the RSVP of all attendees to true,\n\t\t\t// so that they receive an invitation to the new event, not only the cancellation of the old one\n\t\t\tfor (const attendee of this.getAttendeeIterator()) {\n\t\t\t\tattendee.rsvp = true\n\t\t\t}\n\t\t} else {\n\t\t\t// delete to make sure all parameters are gone\n\t\t\tthis.deleteAllProperties('RECURRENCE-ID')\n\t\t\tthis.recurrenceId = this.getReferenceRecurrenceId().clone()\n\t\t\tthis.root.addComponent(this)\n\t\t\tthis.recurrenceManager.relateRecurrenceException(this)\n\t\t\tthis.primaryItem = this\n\n\t\t\tthis.deleteAllProperties('RDATE')\n\t\t\tthis.deleteAllProperties('RRULE')\n\t\t\tthis.deleteAllProperties('EXDATE')\n\t\t\tthis.updatePropertyWithValue('CREATED', DateTimeValue.fromJSDate(dateFactory(), true))\n\t\t\tthis.updatePropertyWithValue('DTSTAMP', DateTimeValue.fromJSDate(dateFactory(), true))\n\t\t\tthis.updatePropertyWithValue('LAST-MODIFIED', DateTimeValue.fromJSDate(dateFactory(), true))\n\t\t\tthis.updatePropertyWithValue('SEQUENCE', 0)\n\n\t\t\tif (this.recurrenceManager.hasRecurrenceDate(false, this.getReferenceRecurrenceId())) {\n\t\t\t\tconst recurDate = this.recurrenceManager.getRecurrenceDate(false, this.getReferenceRecurrenceId())\n\t\t\t\tif (recurDate instanceof PeriodValue) {\n\t\t\t\t\tconst valueDateTimeRecurDate = recurDate.start\n\t\t\t\t\tthis.recurrenceManager.removeRecurrenceDate(false, recurDate)\n\t\t\t\t\tthis.recurrenceManager.addRecurrenceDate(false, valueDateTimeRecurDate)\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.originalRecurrenceId = null\n\t\t}\n\n\t\treturn [previousPrimaryItem, this]\n\t}\n\n\t/**\n\t * Deletes this occurrence from the series of recurring events\n\t * If the parameter thisAndAllFuture is set to true,\n\t * it will remove this and all future occurrences\n\t *\n\t * @param {boolean} thisAndAllFuture Whether to create an exception for this and all future\n\t * @throws EmptyRecurrenceSetError Thrown, when deleting an occurrence results in no more events\n\t * @return {boolean} true if this deleted the last occurrence in set, false if there are occurrences left\n\t */\n\tremoveThisOccurrence(thisAndAllFuture = false) {\n\t\tif (!this.isPartOfRecurrenceSet()) {\n\t\t\t// When deleting an object, that's not part of a recurring set,\n\t\t\t// the calendar-document would be empty.\n\t\t\treturn true\n\t\t}\n\n\t\tif (thisAndAllFuture) {\n\t\t\t// To get the UNTIL date, just deduct one second.\n\t\t\t// That's also how macOS does it, so this should be fairly\n\t\t\t// well supported among all clients\n\t\t\tconst recurrenceId = this.getReferenceRecurrenceId().clone()\n\n\t\t\tconst until = recurrenceId.getInTimezone(Timezone.utc)\n\t\t\tuntil.addDuration(DurationValue.fromSeconds(-1))\n\n\t\t\tfor (const recurValue of this.recurrenceManager.getRecurrenceRuleIterator()) {\n\t\t\t\trecurValue.until = until.clone()\n\t\t\t}\n\n\t\t\tfor (const recurDate of this.recurrenceManager.getRecurrenceDateIterator()) {\n\t\t\t\tlet valueToCheck = recurDate\n\t\t\t\tif (recurDate instanceof PeriodValue) {\n\t\t\t\t\tvalueToCheck = valueToCheck.start\n\t\t\t\t}\n\n\t\t\t\tif (recurrenceId.compare(valueToCheck) <= 0) {\n\t\t\t\t\tthis.recurrenceManager.removeRecurrenceDate(false, recurDate)\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfor (const exceptionDate of this.recurrenceManager.getRecurrenceDateIterator(true)) {\n\t\t\t\tif (recurrenceId.compare(exceptionDate) <= 0) {\n\t\t\t\t\tthis.recurrenceManager.removeRecurrenceDate(true, exceptionDate)\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfor (const exception of this.recurrenceManager.getRecurrenceExceptionList()) {\n\t\t\t\tif (recurrenceId.compare(exception.recurrenceId) <= 0) {\n\t\t\t\t\tthis.root.deleteComponent(exception)\n\t\t\t\t\tthis.recurrenceManager.removeRecurrenceException(exception)\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\t// Make sure we don't leave orphaned recurrence-exceptions\n\t\t\tif (this.isRecurrenceException() && !this.modifiesFuture()) {\n\t\t\t\tthis.root.deleteComponent(this)\n\t\t\t\tthis.recurrenceManager.removeRecurrenceException(this)\n\t\t\t}\n\n\t\t\t// If this is based on a recurrence-date, simply delete it\n\t\t\t// otherwise add an exception-date\n\t\t\tif (this.recurrenceManager.hasRecurrenceDate(false, this.getReferenceRecurrenceId())) {\n\t\t\t\tconst recurDate = this.recurrenceManager.getRecurrenceDate(false, this.getReferenceRecurrenceId())\n\t\t\t\tthis.recurrenceManager.removeRecurrenceDate(false, recurDate)\n\t\t\t} else {\n\t\t\t\tthis.recurrenceManager.addRecurrenceDate(true, this.getReferenceRecurrenceId().clone())\n\t\t\t}\n\t\t}\n\n\t\treturn this.recurrenceManager.isEmptyRecurrenceSet()\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tclone() {\n\t\tconst comp = super.clone()\n\t\tcomp.resetDirty()\n\n\t\treturn comp\n\t}\n\n\t/**\n\t * Adds a new attendee\n\t *\n\t * @param {AttendeeProperty} attendee The attendee property to add\n\t * @private\n\t * @return {boolean}\n\t */\n\t_addAttendee(attendee) {\n\t\t// Check for different Attendee objects with the same uri\n\t\tfor (const a of this.getAttendeeIterator()) {\n\t\t\tif (a.email === attendee.email) {\n\t\t\t\treturn false\n\t\t\t}\n\t\t}\n\n\t\tthis.addProperty(attendee)\n\t\treturn true\n\t}\n\n\t/**\n\t * Adds a new attendee based on their name and email-address\n\t *\n\t * @param {string} name The name of the attendee to add\n\t * @param {string} email The email-address of the attendee to add\n\t * @return {boolean}\n\t */\n\taddAttendeeFromNameAndEMail(name, email) {\n\t\tconst attendeeProperty = AttendeeProperty.fromNameAndEMail(name, email)\n\t\treturn this._addAttendee(attendeeProperty)\n\t}\n\n\t/**\n\t * Adds a new attendee based on their properties\n\t *\n\t * @param {string} name The name of the attendee to add\n\t * @param {string} email The email-address of the attendee to add\n\t * @param {string} role The role of the attendee to add\n\t * @param {string} userType The type of attendee to add\n\t * @param {boolean} rsvp Whether or not to request a response from the attendee\n\t * @return {boolean}\n\t */\n\taddAttendeeFromNameEMailRoleUserTypeAndRSVP(name, email, role, userType, rsvp) {\n\t\tconst attendeeProperty = AttendeeProperty.fromNameEMailRoleUserTypeAndRSVP(name, email, role, userType, rsvp, false)\n\t\treturn this._addAttendee(attendeeProperty)\n\t}\n\n\t/**\n\t * Sets the organiser property from common-name and email address\n\t *\n\t * @param {string} name The name of the organizer\n\t * @param {string} email The email-address of the organizer\n\t */\n\tsetOrganizerFromNameAndEMail(name, email) {\n\t\tthis.deleteAllProperties('ORGANIZER')\n\t\tthis.addProperty(AttendeeProperty.fromNameAndEMail(name, email, true))\n\t}\n\n\t/**\n\t * Adds a new attachment from raw data\n\t *\n\t * @param {string} data The data of the attachment\n\t * @param {string} formatType The mime-type of the attachment\n\t */\n\taddAttachmentFromData(data, formatType = null) {\n\t\tthis.addProperty(AttachmentProperty.fromData(data, formatType))\n\t}\n\n\t/**\n\t * Adds a new attachment from a link\n\t *\n\t * @param {string} uri The URI of the attachment\n\t * @param {string} formatType The mime-type of the attachment\n\t */\n\taddAttachmentFromLink(uri, formatType = null) {\n\t\tthis.addProperty(AttachmentProperty.fromLink(uri, formatType))\n\t}\n\n\t/**\n\t * Adds a new contact\n\t *\n\t * @url https://tools.ietf.org/html/rfc5545#section-3.8.4.2\n\t *\n\t * @param {string} contact The textual contact description to add\n\t */\n\taddContact(contact) {\n\t\tthis.addProperty(new TextProperty('CONTACT', contact))\n\t}\n\n\t/**\n\t * Adds a new comment\n\t *\n\t * @url https://tools.ietf.org/html/rfc5545#section-3.8.1.4\n\t *\n\t * @param {string} comment The comment to add\n\t */\n\taddComment(comment) {\n\t\tthis.addProperty(new TextProperty('COMMENT', comment))\n\t}\n\n\t/**\n\t * Adds a new image from raw data\n\t *\n\t * @param {string} data Data of the image to add\n\t * @param {string=} display What display-type the image is optimized for\n\t * @param {string=} formatType The mime-type of the image\n\t */\n\taddImageFromData(data, display = null, formatType = null) {\n\t\tthis.addProperty(ImageProperty.fromData(data, display, formatType))\n\t}\n\n\t/**\n\t * Adds a new image from a link\n\t *\n\t * @param {string} uri The URI of the image to add\n\t * @param {string=} display What display-type the image is optimized for\n\t * @param {string=} formatType The mime-type of the image\n\t */\n\taddImageFromLink(uri, display = null, formatType = null) {\n\t\tthis.addProperty(ImageProperty.fromLink(uri, display, formatType))\n\t}\n\n\t/**\n\t * Creates a new RELATED-TO property based on a relation-type and id\n\t * and adds it to this object\n\t *\n\t * @param {string} relType The type of relation to add\n\t * @param {string} relId The id of the related calendar-document\n\t */\n\taddRelation(relType, relId) {\n\t\tthis.addProperty(RelationProperty.fromRelTypeAndId(relType, relId))\n\t}\n\n\t/**\n\t * Creates a new REQUEST-STATUS property based on code and message\n\t * and adds it to this object\n\t *\n\t * @param {number} code The status-code of the request status\n\t * @param {string} message The message of the request status\n\t */\n\taddRequestStatus(code, message) {\n\t\tthis.addProperty(RequestStatusProperty.fromCodeAndMessage(code, message))\n\t}\n\n\t/**\n\t * Adds a new absolute alarm based on action and trigger time\n\t *\n\t * @param {string} action The type of alarm Action\n\t * @param {DateTimeValue} alarmTime The trigger time of the alarm\n\t * @return {AlarmComponent}\n\t */\n\taddAbsoluteAlarm(action, alarmTime) {\n\t\tconst alarmComp = new AlarmComponent('VALARM', [\n\t\t\t['action', action],\n\t\t\tTriggerProperty.fromAbsolute(alarmTime),\n\t\t])\n\n\t\tthis.addComponent(alarmComp)\n\t\treturn alarmComp\n\t}\n\n\t/**\n\t * Adds a new relative alarm based on action, trigger time and relativeTo parameter\n\t *\n\t * @param {string} action The type of alarm Action\n\t * @param {DurationValue} alarmOffset The trigger time of the alarm\n\t * @param {boolean=} relatedToStart Whether or not the alarm is related to the event's start\n\t * @return {AlarmComponent}\n\t */\n\taddRelativeAlarm(action, alarmOffset, relatedToStart = true) {\n\t\tconst alarmComp = new AlarmComponent('VALARM', [\n\t\t\t['action', action],\n\t\t\tTriggerProperty.fromRelativeAndRelated(alarmOffset, relatedToStart),\n\t\t])\n\n\t\tthis.addComponent(alarmComp)\n\t\treturn alarmComp\n\t}\n\n\t/**\n\t * Marks a certain property as edited\n\t *\n\t * @param {string} propertyName The name of the property\n\t */\n\tmarkPropertyAsDirty(propertyName) {\n\t\tthis.markDirty()\n\n\t\t// Properties that must be considered a significant change\n\t\t// according to RFC 5546 Section 2.1.4\n\t\tconst props = [\n\t\t\t'DTSTART',\n\t\t\t'DTEND',\n\t\t\t'DURATION',\n\t\t\t'RRULE',\n\t\t\t'RDATE',\n\t\t\t'EXDATE',\n\t\t\t'STATUS',\n\t\t\t...getConfig('property-list-significant-change', []),\n\t\t]\n\n\t\tif (props.includes(uc(propertyName))) {\n\t\t\tthis.markChangesAsSignificant()\n\t\t}\n\t}\n\n\t/**\n\t * Marks a certain component as edited\n\t *\n\t * @param {string} componentName The name of the component\n\t */\n\tmarkSubComponentAsDirty(componentName) {\n\t\tthis.markDirty()\n\n\t\tif (getConfig('component-list-significant-change', []).includes(componentName)) {\n\t\t\tthis.markChangesAsSignificant()\n\t\t}\n\t}\n\n\t/**\n\t * Returns whether or not this component is dirty\n\t *\n\t * @return {boolean}\n\t */\n\tisDirty() {\n\t\treturn this._dirty || this._significantChange\n\t}\n\n\t/**\n\t * Marks this object as dirty\n\t */\n\tmarkDirty() {\n\t\tthis._dirty = true\n\t}\n\n\t/**\n\t * Marks changes as significant. Can be called by the program using this lib\n\t */\n\tmarkChangesAsSignificant() {\n\t\tthis._significantChange = true\n\t}\n\n\t/**\n\t * Updates the event after modifications.\n\t *\n\t * @return {boolean} true if last-modified was updated\n\t */\n\tundirtify() {\n\t\tif (!this.isDirty()) {\n\t\t\treturn false\n\t\t}\n\n\t\tif (!this.hasProperty('SEQUENCE')) {\n\t\t\tthis.sequence = 0\n\t\t}\n\n\t\tthis.updatePropertyWithValue('DTSTAMP', DateTimeValue.fromJSDate(dateFactory(), true))\n\t\tthis.updatePropertyWithValue('LAST-MODIFIED', DateTimeValue.fromJSDate(dateFactory(), true))\n\t\tif (this._significantChange) {\n\t\t\tthis.sequence++\n\t\t}\n\n\t\tthis.resetDirty()\n\n\t\treturn true\n\t}\n\n\t/**\n\t * Resets the dirty indicators without updating DTSTAMP or LAST-MODIFIED\n\t */\n\tresetDirty() {\n\t\tthis._dirty = false\n\t\tthis._significantChange = false\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tupdatePropertyWithValue(propertyName, value) {\n\t\tsuper.updatePropertyWithValue(propertyName, value)\n\n\t\tif (uc(propertyName) === 'UID') {\n\t\t\tthis._cachedId = null\n\t\t}\n\n\t\tthis.markPropertyAsDirty(propertyName)\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\taddProperty(property) {\n\t\tthis.markPropertyAsDirty(property.name)\n\t\tproperty.subscribe(() => this.markPropertyAsDirty(property.name))\n\t\treturn super.addProperty(property)\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tdeleteProperty(property) {\n\t\tthis.markPropertyAsDirty(property.name)\n\t\treturn super.deleteProperty(property)\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tdeleteAllProperties(propertyName) {\n\t\tthis.markPropertyAsDirty(propertyName)\n\t\treturn super.deleteAllProperties(propertyName)\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\taddComponent(component) {\n\t\tthis.markSubComponentAsDirty(component.name)\n\t\tcomponent.subscribe(() => this.markSubComponentAsDirty(component.name))\n\t\treturn super.addComponent(component)\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tdeleteComponent(component) {\n\t\tthis.markSubComponentAsDirty(component.name)\n\t\treturn super.deleteComponent(component)\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tdeleteAllComponents(componentName) {\n\t\tthis.markSubComponentAsDirty(componentName)\n\t\treturn super.deleteAllComponents(componentName)\n\t}\n\n\t/**\n\t * Gets a recurrence-id that has to be used to refer to this event.\n\t * This is used for recurrence-management\n\t *\n\t * @return {DateTimeValue|null}\n\t */\n\tgetReferenceRecurrenceId() {\n\t\tif (this.originalRecurrenceId) {\n\t\t\treturn this.originalRecurrenceId\n\t\t} else if (this.recurrenceId) {\n\t\t\treturn this.recurrenceId\n\t\t} else if (this.startDate) {\n\t\t\treturn this.startDate\n\t\t}\n\n\t\treturn null\n\t}\n\n\t/**\n\t * Overrides the master item with this one\n\t *\n\t * @private\n\t */\n\t_overridePrimaryItem() {\n\t\tconst oldStartDate = this.primaryItem.startDate\n\n\t\tfor (const property of this.primaryItem.getPropertyIterator()) {\n\t\t\tthis.primaryItem.deleteProperty(property)\n\t\t}\n\n\t\tfor (const property of this.getPropertyIterator()) {\n\t\t\tthis.primaryItem.addProperty(property)\n\t\t}\n\n\t\tthis.recurrenceManager.resetCache()\n\t\tif (this.startDate.compare(oldStartDate) !== 0) {\n\t\t\tthis.recurrenceManager.updateStartDateOfMasterItem(this.startDate, oldStartDate)\n\t\t}\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tstatic _getConstructorForComponentName(componentName) {\n\t\treturn getConstructorForComponentName(componentName)\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tstatic fromICALJs(...args) {\n\t\tconst comp = super.fromICALJs(...args)\n\t\tcomp.resetDirty()\n\n\t\treturn comp\n\t}\n\n}\n\n/**\n * Date-Time stamp of this object.\n * It has different meaning, based on whether or not a method is defined\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.7.2\n *\n * @name EventComponent#stampTime\n * @type {string}\n */\nadvertiseSingleOccurrenceProperty(AbstractRecurringComponent.prototype, {\n\tname: 'stampTime',\n\tiCalendarName: 'DTSTAMP',\n})\n\n/**\n * Recurrence-ID of this object, used for recurrence-exceptions\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.4.4\n *\n * @name EventComponent#recurrenceId\n * @type {string}\n */\nadvertiseSingleOccurrenceProperty(AbstractRecurringComponent.prototype, {\n\tname: 'recurrenceId',\n\tiCalendarName: 'RECURRENCE-ID',\n})\n\n/**\n * Special color for this event / journal / task\n *\n * @url https://tools.ietf.org/html/rfc7986#section-5.9\n *\n * @name EventComponent#color\n * @type {string}\n */\nadvertiseSingleOccurrenceProperty(AbstractRecurringComponent.prototype, 'color')\n\n/**\n * Creation Time of this event / journal / task\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.7.1\n *\n * @name EventComponent#creationTime\n * @type {string}\n */\nadvertiseSingleOccurrenceProperty(AbstractRecurringComponent.prototype, {\n\tname: 'creationTime',\n\tiCalendarName: 'CREATED',\n})\n\n/**\n * The time this event / journal / task\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.7.3\n *\n * @name EventComponent#modificationTime\n * @type {string}\n */\nadvertiseSingleOccurrenceProperty(AbstractRecurringComponent.prototype, {\n\tname: 'modificationTime',\n\tiCalendarName: 'LAST-MODIFIED',\n})\n\n/**\n * Organizer of this event / journal / task\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.4.3\n *\n * @name EventComponent#organizer\n * @type {string}\n */\nadvertiseSingleOccurrenceProperty(AbstractRecurringComponent.prototype, 'organizer')\n\n/**\n * Revision of this this event / journal / task\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.7.4\n *\n * @name EventComponent#sequence\n * @type {string}\n */\nadvertiseSingleOccurrenceProperty(AbstractRecurringComponent.prototype, 'sequence')\n\n/**\n * Status of this event / journal / task\n * This indicates whether an event is tentative / confirmed / cancelled\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.1.11\n *\n * @name EventComponent#status\n * @type {string}\n */\nadvertiseSingleOccurrenceProperty(AbstractRecurringComponent.prototype, 'status')\n\n/**\n * URL of a more dynamic rendition of this event / journal / task\n * DO NOT use this to simply point to a website merely related.\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.4.6\n *\n * @name EventComponent#url\n * @type {string}\n */\nadvertiseSingleOccurrenceProperty(AbstractRecurringComponent.prototype, 'url')\n\n/**\n * Title of this event / journal / task\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.1.12\n *\n * @name EventComponent#title\n * @type {string}\n */\nadvertiseSingleOccurrenceProperty(AbstractRecurringComponent.prototype, {\n\tname: 'title',\n\tiCalendarName: 'SUMMARY',\n})\n\n/**\n * Access class of this event / journal / task\n * This determines what other users can see when sharing\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.1.3\n *\n * @name EventComponent#accessClass\n * @type {string}\n */\nadvertiseSingleOccurrenceProperty(AbstractRecurringComponent.prototype, {\n\tname: 'accessClass',\n\tiCalendarName: 'class',\n\tallowedValues: ['PUBLIC', 'PRIVATE', 'CONFIDENTIAL'],\n\tdefaultValue: 'PUBLIC',\n\tunknownValue: 'PRIVATE',\n})\n\n/**\n * Returns an iterator over all categories\n * If the parameter lang is given, it will only\n * return an iterator for Categories matching that language\n *\n * @name AbstractRecurringComponent#getCategoryIterator\n * @function\n * @param {string=} lang\n * @return {IterableIterator<string>}\n */\n\n/**\n * Returns a list of all categories\n * If the parameter lang is given, it will only\n * return an iterator for Categories matching that language\n *\n * @name AbstractRecurringComponent#getCategoryList\n * @function\n * @param {string=} lang\n * @return {string[]}\n */\n\n/**\n * Adds a new category\n *\n * @name AbstractRecurringComponent#addCategory\n * @function\n * @param {string} category\n * @param {string=} lang\n */\n\n/**\n * Removes a category\n *\n * @name AbstractRecurringComponent#removeCategory\n * @function\n * @param {string} category\n * @param {string=} lang\n */\n\n/**\n * Clear all categories of a given language\n *\n * @name AbstractRecurringComponent#clearAllCategories\n * @function\n */\nadvertiseMultiValueStringPropertySeparatedByLang(AbstractRecurringComponent.prototype, {\n\tname: 'category',\n\tpluralName: 'categories',\n\tiCalendarName: 'CATEGORIES',\n})\n\n/**\n * Returns an iterator over all attendees\n *\n * @name AbstractRecurringComponent#getAttendeeIterator\n * @function\n * @return {IterableIterator<AttendeeProperty>}\n */\n\n/**\n * Gets a list of all attendees\n *\n * @name AbstractRecurringComponent#getAttendeeList\n * @function\n * @return {AttachmentProperty[]}\n */\n\n/**\n * Removes an attendee from this event / journal / task\n *\n * @name AbstractRecurringComponent#removeAttendee\n * @function\n * @param {AttendeeProperty} attendee\n */\n\n/**\n * Removes all attendees from this event / journal / task\n *\n * @name AbstractRecurringComponent#clearAllAttendees\n * @function\n */\nadvertiseMultipleOccurrenceProperty(AbstractRecurringComponent.prototype, {\n\tname: 'attendee',\n})\n\n/**\n * Returns an iterator over all attachments\n *\n * @name AbstractRecurringComponent#getAttachmentIterator\n * @function\n * @return {IterableIterator<AttachmentProperty>}\n */\n\n/**\n * Gets a list of all attachments\n *\n * @name AbstractRecurringComponent#getAttachmentList\n * @function\n * @return {AttachmentProperty[]}\n */\n\n/**\n * Removes one attachment from this event / journal / task\n *\n * @name AbstractRecurringComponent#removeAttachment\n * @function\n * @param {AttachmentProperty} attachment\n */\n\n/**\n * Removes all attachments from this event / journal / task\n *\n * @name AbstractRecurringComponent#clearAllAttachments\n * @function\n */\nadvertiseMultipleOccurrenceProperty(AbstractRecurringComponent.prototype, {\n\tname: 'attachment',\n\tiCalendarName: 'ATTACH',\n})\n\n/**\n * Returns an iterator over all relation properties\n *\n * @name AbstractRecurringComponent#getRelationIterator\n * @function\n * @return {IterableIterator<RelationProperty>}\n */\n\n/**\n * Returns a list of all relation properties\n *\n * @name AbstractRecurringComponent#getRelationList\n * @function\n * @return {RelationProperty[]}\n */\n\n/**\n * Removes a relation from this event / journal / task\n *\n * @name AbstractRecurringComponent#removeRelation\n * @function\n * @param {RelationProperty} relation\n */\n\n/**\n * Removes all relations from this event / journal / task\n *\n * @name AbstractRecurringComponent#clearAllRelations\n * @function\n */\nadvertiseMultipleOccurrenceProperty(AbstractRecurringComponent.prototype, {\n\tname: 'relation',\n\tiCalendarName: 'RELATED-TO',\n})\n\n/**\n * Returns an iterator over all comments in this event / journal / task\n *\n * @name AbstractRecurringComponent#getCommentIterator\n * @function\n * @return {IterableIterator<TextProperty>}\n */\n\n/**\n * Returns a list of all comments in this event / journal / task\n *\n * @name AbstractRecurringComponent#getCommentList\n * @function\n * @return {TextProperty[]}\n */\n\n/**\n * Removes a comment from this event / journal / task\n *\n * @name AbstractRecurringComponent#removeComment\n * @function\n * @param {TextProperty} comment\n */\n\n/**\n * Removes all comments from this event / journal / task\n *\n * @name AbstractRecurringComponent#clearAllComments\n * @function\n */\nadvertiseMultipleOccurrenceProperty(AbstractRecurringComponent.prototype, 'comment')\n\n/**\n * Returns an iterator over all contacts referenced in this event / journal / task\n *\n * @name AbstractRecurringComponent#getContactIterator\n * @function\n * @return {IterableIterator<TextProperty>}\n */\n\n/**\n * Returns a list of all contacts referenced in this event / journal / task\n *\n * @name AbstractRecurringComponent#getContactList\n * @function\n * @return {TextProperty[]}\n */\n\n/**\n * Removes one contact from this event / journal / task\n *\n * @name AbstractRecurringComponent#removeContact\n * @function\n * @param {TextProperty} contact\n */\n\n/**\n * Removes all contacts from this event / journal / task\n *\n * @name AbstractRecurringComponent#clearAllContacts\n * @function\n */\nadvertiseMultipleOccurrenceProperty(AbstractRecurringComponent.prototype, 'contact')\n\n/**\n * Returns an iterator over all image properties\n *\n * @name AbstractRecurringComponent#getImageIterator\n * @function\n * @return {IterableIterator<ImageProperty>}\n */\n\n/**\n * Returns a list of all image properties\n *\n * @name AbstractRecurringComponent#getImageList\n * @function\n * @return {ImageProperty[]}\n */\n\n/**\n * Removes one image from this event / journal / task\n *\n * @name AbstractRecurringComponent#removeImage\n * @function\n * @param {ImageProperty} image\n */\n\n/**\n * Removes all images from this event / journal / task\n *\n * @name AbstractRecurringComponent#clearAllImages\n * @function\n */\nadvertiseMultipleOccurrenceProperty(AbstractRecurringComponent.prototype, 'image')\n\n/**\n * Returns an iterator over all request status\n *\n * @name AbstractRecurringComponent#getRequestStatusIterator\n * @function\n * @return {IterableIterator<RequestStatusProperty>}\n */\n\n/**\n * Returns a list of all request status\n *\n * @name AbstractRecurringComponent#getRequestStatusList\n * @function\n * @return {RequestStatusProperty[]}\n */\n\n/**\n * Removes one request status from this event / journal / task\n *\n * @name AbstractRecurringComponent#removeRequestStatus\n * @function\n * @param {RequestStatusProperty} requestStatus\n */\n\n/**\n * Removes all request status from this event / journal / task\n *\n * @name AbstractRecurringComponent#clearAllRequestStatus\n * @function\n */\nadvertiseMultipleOccurrenceProperty(AbstractRecurringComponent.prototype, {\n\tname: 'requestStatus',\n\tpluralName: 'requestStatus',\n\tiCalendarName: 'REQUEST-STATUS',\n})\n\n/**\n * Returns an iterator of all alarms\n *\n * @name AbstractRecurringComponent#getAlarmIterator\n * @function\n * @return {IterableIterator<AlarmComponent>}\n */\n\n/**\n * Returns a list of all alarms\n *\n * @name AbstractRecurringComponent#getAlarmList\n * @function\n * @return {AlarmComponent[]}\n */\n\n/**\n * Removes an alarm from this event / journal / task\n *\n * @name AbstractRecurringComponent#removeAlarm\n * @function\n * @param {AlarmComponent} alarm\n */\n\n/**\n * Removes all alarms from this event / journal / task\n *\n * @name AbstractRecurringComponent#clearAllAlarms\n * @function\n */\nadvertiseComponent(AbstractRecurringComponent.prototype, 'alarm')\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\n/**\n * Gets kind of birthday event\n * returns \"BDAY\", \"DEATHDATE\", \"ANNIVERSARY\"\n * or null if this is not a birthday event\n *\n * @param {EventComponent} eventComponent The eventComponent of the birthday event\n * @return {null|string}\n */\nexport function getTypeOfBirthdayEvent(eventComponent) {\n\treturn eventComponent.getFirstPropertyFirstValue('X-NEXTCLOUD-BC-FIELD-TYPE')\n}\n\n/**\n * Gets icon for the birthday type\n *\n * @param {EventComponent} eventComponent The eventComponent of the birthday event\n * @return {string|null}\n */\nexport function getIconForBirthday(eventComponent) {\n\tconst birthdayType = getTypeOfBirthdayEvent(eventComponent)\n\tswitch (birthdayType) {\n\tcase 'BDAY':\n\t\treturn '🎂'\n\n\tcase 'DEATHDATE':\n\t\treturn '⚰️'\n\n\tcase 'ANNIVERSARY':\n\t\treturn '💍'\n\n\tdefault:\n\t\treturn null\n\t}\n}\n\n/**\n * Returns the age of the birthday person or null of no birth-year given\n *\n * @param {EventComponent} eventComponent The eventComponent of the birthday event\n * @param {number} yearOfOccurrence The year to calculate the age for\n * @return {null|number}\n */\nexport function getAgeOfBirthday(eventComponent, yearOfOccurrence) {\n\tif (!eventComponent.hasProperty('X-NEXTCLOUD-BC-YEAR')) {\n\t\treturn null\n\t}\n\n\tconst yearOfBirth = eventComponent.getFirstPropertyFirstValue('X-NEXTCLOUD-BC-YEAR')\n\treturn parseInt(yearOfOccurrence, 10) - parseInt(yearOfBirth, 10)\n}\n\n/**\n * Returns the name of the birthday person or null if not set\n *\n * @param {EventComponent} eventComponent The eventComponent of the birthday event\n * @return {null|string}\n */\nexport function getNameForBirthday(eventComponent) {\n\treturn eventComponent.getFirstPropertyFirstValue('X-NEXTCLOUD-BC-NAME')\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport AbstractRecurringComponent from './abstractRecurringComponent.js'\nimport {\n\tadvertiseMultipleOccurrenceProperty,\n\tadvertiseMultiValueStringPropertySeparatedByLang,\n\tadvertiseSingleOccurrenceProperty,\n} from '../abstractComponent.js'\nimport {\n\tgetAgeOfBirthday,\n\tgetIconForBirthday,\n\tgetTypeOfBirthdayEvent,\n} from '../../helpers/birthdayHelper.js'\nimport DurationValue from '../../values/durationValue.js'\nimport GeoProperty from '../../properties/geoProperty.js'\nimport ConferenceProperty from '../../properties/conferenceProperty.js'\n\n/**\n * @class EventComponent\n * @classdesc\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.6.1\n */\nexport default class EventComponent extends AbstractRecurringComponent {\n\n\t/**\n\t * Returns whether this event is an all-day event\n\t *\n\t * @return {boolean}\n\t */\n\tisAllDay() {\n\t\treturn this.startDate.isDate && this.endDate.isDate\n\t}\n\n\t/**\n\t * Checks whether it's possible to switch from date-time to date or vise-versa\n\t *\n\t * @return {boolean}\n\t */\n\tcanModifyAllDay() {\n\t\treturn !this.recurrenceManager.masterItem.isRecurring()\n\t}\n\n\t/**\n\t * Gets the calculated end-date of the event\n\t *\n\t * Quote from RFC 5545 3.6.1:\n\t * The \"DTSTART\" property for a \"VEVENT\" specifies the inclusive\n\t * start of the event.  For recurring events, it also specifies the\n\t * very first instance in the recurrence set.  The \"DTEND\" property\n\t * for a \"VEVENT\" calendar component specifies the non-inclusive end\n\t * of the event.  For cases where a \"VEVENT\" calendar component\n\t * specifies a \"DTSTART\" property with a DATE value type but no\n\t * \"DTEND\" nor \"DURATION\" property, the event's duration is taken to\n\t * be one day.  For cases where a \"VEVENT\" calendar component\n\t * specifies a \"DTSTART\" property with a DATE-TIME value type but no\n\t * \"DTEND\" property, the event ends on the same calendar date and\n\t * time of day specified by the \"DTSTART\" property.\n\t *\n\t * @return {DateTimeValue}\n\t */\n\tget endDate() {\n\t\tif (this.hasProperty('dtend')) {\n\t\t\treturn this.getFirstPropertyFirstValue('dtend')\n\t\t}\n\n\t\tconst dtend = this.startDate.clone()\n\n\t\tif (this.hasProperty('duration')) {\n\t\t\tdtend.addDuration(this.getFirstPropertyFirstValue('duration'))\n\t\t} else if (this.startDate.isDate) {\n\t\t\tdtend.addDuration(DurationValue.fromSeconds(60 * 60 * 24))\n\t\t} // There is nothing to do when this event is not allday\n\n\t\treturn dtend\n\t}\n\n\t/**\n\t * Sets the end time of the event\n\t *\n\t * @param {DateTimeValue} end The end of the event\n\t */\n\tset endDate(end) {\n\t\tthis.deleteAllProperties('duration')\n\t\tthis.updatePropertyWithValue('dtend', end)\n\t}\n\n\t/**\n\t * Gets the calculated duration of the event\n\t *\n\t * @return {DurationValue}\n\t */\n\tget duration() {\n\t\tif (this.hasProperty('duration')) {\n\t\t\treturn this.getFirstPropertyFirstValue('duration')\n\t\t}\n\n\t\treturn this.startDate.subtractDateWithTimezone(this.endDate)\n\t}\n\n\t/**\n\t * Sets the calculated duration of the event\n\t *\n\t * @param {DurationValue} duration The duration of the event\n\t */\n\tset duration(duration) {\n\t\tthis.deleteAllProperties('dtend')\n\t\tthis.updatePropertyWithValue('duration', duration)\n\t}\n\n\t/**\n\t * Sets the geographical position based on latitude and longitude\n\t *\n\t * @url https://tools.ietf.org/html/rfc5545#section-3.8.1.6\n\t *\n\t * @param {number} lat - latitude\n\t * @param {number} long - longitude\n\t */\n\tsetGeographicalPositionFromLatitudeAndLongitude(lat, long) {\n\t\tthis.deleteAllProperties('GEO')\n\t\tthis.addProperty(GeoProperty.fromPosition(lat, long))\n\t}\n\n\t/**\n\t * Adds a new conference property based on URI, label and features\n\t *\n\t * @url https://tools.ietf.org/html/rfc7986#section-5.11\n\t *\n\t * @param {string} uri The URI of the conference system\n\t * @param {string=} label The label for the conference system\n\t * @param {string[]=} features The features of the conference system\n\t */\n\taddConference(uri, label = null, features = null) {\n\t\tthis._modify()\n\t\tthis.addProperty(ConferenceProperty.fromURILabelAndFeatures(uri, label, features))\n\t}\n\n\t/**\n\t * Adds a duration to the start of the event\n\t *\n\t * @param {DurationValue} duration The duration to add\n\t */\n\taddDurationToStart(duration) {\n\t\tthis.startDate.addDuration(duration)\n\t}\n\n\t/**\n\t * Adds a duration to the end of the event\n\t *\n\t * @param {DurationValue} duration The duration to add\n\t */\n\taddDurationToEnd(duration) {\n\t\tconst endDate = this.endDate\n\t\tendDate.addDuration(duration)\n\n\t\tthis.endDate = endDate\n\t}\n\n\t/**\n\t * Shifts the entire event by the given duration\n\t *\n\t * @param {DurationValue} delta The duration to shift event by\n\t * @param {boolean} allDay Whether the updated event should be all-day or not\n\t * @param {Timezone} defaultTimezone The default timezone if moving from all-day to timed event\n\t * @param {DurationValue} defaultAllDayDuration The default all-day duration if moving from timed to all-day\n\t * @param {DurationValue} defaultTimedDuration The default timed duration if moving from all-day to timed\n\t */\n\tshiftByDuration(delta, allDay, defaultTimezone, defaultAllDayDuration, defaultTimedDuration) {\n\t\tconst currentAllDay = this.isAllDay()\n\n\t\tif (currentAllDay !== allDay && !this.canModifyAllDay()) {\n\t\t\tthrow new TypeError('Can\\'t modify all-day of this event')\n\t\t}\n\n\t\tthis.startDate.isDate = allDay\n\t\tthis.startDate.addDuration(delta)\n\n\t\t// If this event was moved from the all-day area into the time-grid,\n\t\t// then we have to add a timezone and the default duration\n\t\tif (currentAllDay && !allDay) {\n\t\t\tthis.startDate.replaceTimezone(defaultTimezone)\n\n\t\t\tthis.endDate = this.startDate.clone()\n\t\t\tthis.endDate.addDuration(defaultTimedDuration)\n\t\t}\n\n\t\t// If this event was moved from the time-grid into the all-day area,\n\t\t// then we have to change the default duration\n\t\tif (!currentAllDay && allDay) {\n\t\t\tthis.endDate = this.startDate.clone()\n\t\t\tthis.endDate.addDuration(defaultAllDayDuration)\n\t\t}\n\n\t\t// If this event was only moved inside the time-grid or only inside\n\t\t// the all-day area, then we only have to adjust the end-date\n\t\tif (currentAllDay === allDay) {\n\t\t\tconst endDate = this.endDate\n\t\t\tendDate.addDuration(delta)\n\t\t\tthis.endDate = endDate\n\t\t}\n\t}\n\n\t/**\n\t * Checks if this is a birthday event\n\t *\n\t * @return {boolean}\n\t */\n\tisBirthdayEvent() {\n\t\treturn getTypeOfBirthdayEvent(this) === 'BDAY'\n\t}\n\n\t/**\n\t * Gets the icon to the birthday event\n\t *\n\t * @return {string}\n\t */\n\tgetIconForBirthdayEvent() {\n\t\treturn getIconForBirthday(this)\n\t}\n\n\t/**\n\t * Calculates the age of the birthday\n\t *\n\t * @return {number}\n\t */\n\tgetAgeForBirthdayEvent() {\n\t\treturn getAgeOfBirthday(this, this.startDate.year)\n\t}\n\n\t/**\n\t * Serializes the entire series to ICS\n\t *\n\t * @return {string}\n\t */\n\ttoICSEntireSeries() {\n\t\treturn this.root.toICS()\n\t}\n\n\t/**\n\t * Serializes exactly this recurrence to ICS\n\t * It removes all recurrence information\n\t *\n\t * @return {string}\n\t */\n\ttoICSThisOccurrence() {\n\t\tconst clone = this.clone()\n\n\t\tclone.deleteAllProperties('RRULE')\n\t\tclone.deleteAllProperties('EXRULE')\n\t\tclone.deleteAllProperties('RDATE')\n\t\tclone.deleteAllProperties('EXDATE')\n\t\tclone.deleteAllProperties('RECURRENCE-ID')\n\n\t\tclone.root = clone.root.constructor.fromEmpty()\n\t\tclone.parent = clone.root\n\t\tclone.root.addComponent(clone)\n\n\t\treturn clone.root.toICS()\n\t}\n\n\t/**\n\t * Checks if this event is in a given time-frame\n\t *\n\t * @param {DateTimeValue} start Start of time-range to check\n\t * @param {DateTimeValue} end End of time-range to check\n\t * @return {boolean}\n\t */\n\tisInTimeFrame(start, end) {\n\t\treturn start.compare(this.endDate) <= 0 && end.compare(this.startDate) >= 0\n\t}\n\n}\n\n/**\n * Time-transparency of this event.\n * If set to TRANSPARENT, this event will be ignored for FREE/BUSY calculations.\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.2.7\n *\n * @name EventComponent#timeTransparency\n * @type {string}\n */\nadvertiseSingleOccurrenceProperty(EventComponent.prototype, {\n\tname: 'timeTransparency',\n\tiCalendarName: 'TRANSP',\n\tallowedValues: ['OPAQUE', 'TRANSPARENT'],\n\tdefaultValue: 'OPAQUE',\n})\n\n/**\n * Description of this event.\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.1.5\n *\n * @name EventComponent#description\n * @type {string}\n */\nadvertiseSingleOccurrenceProperty(EventComponent.prototype, 'description')\n\n/**\n * Geographical position of this event\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.1.6\n *\n * @name EventComponent#geographicalPosition\n * @type {string}\n */\nadvertiseSingleOccurrenceProperty(EventComponent.prototype, {\n\tname: 'geographicalPosition',\n\tiCalendarName: 'GEO',\n})\n\n/**\n * Location that this event takes place in\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.1.7\n *\n * @name EventComponent#location\n * @type {string}\n */\nadvertiseSingleOccurrenceProperty(EventComponent.prototype, 'location')\n\n/**\n * Priority of this event\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.1.9\n *\n * @name EventComponent#priority\n * @type Number\n */\nadvertiseSingleOccurrenceProperty(EventComponent.prototype, {\n\tname: 'priority',\n\tallowedValues: Array(9).keys(),\n\tdefaultValue: 0,\n\tunknownValue: 0,\n})\n\n/**\n * Returns an iterator over all resources\n * If the parameter lang is given, it will only\n * return an iterator for Resources matching that language\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.1.10\n *\n * @name EventComponent#getResourceIterator\n * @function\n * @param {string=} lang\n * @return {IterableIterator<string>}\n */\n\n/**\n * Returns a list of all resources\n * If the parameter lang is given, it will only\n * return an iterator for resources matching that language\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.1.10\n *\n * @name EventComponent#getResourceList\n * @function\n * @param {string=} lang\n * @return {string[]}\n */\n\n/**\n * Adds a resource\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.1.10\n *\n * @name EventComponent#addResource\n * @function\n * @param {string} resource\n * @param {string=} lang\n */\n\n/**\n * Removes a resource\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.1.10\n *\n * @name EventComponent#removeResource\n * @function\n * @param {string} resource\n * @param {string=} lang\n */\n\n/**\n * Removes all resources from this event\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.1.10\n *\n * @name EventComponent#clearAllResources\n * @function\n * @param {string=} lang\n */\nadvertiseMultiValueStringPropertySeparatedByLang(EventComponent.prototype, {\n\tname: 'resource',\n\tiCalendarName: 'RESOURCES',\n})\n\n/**\n * Gets an iterator over all conference properties\n *\n * @url https://tools.ietf.org/html/rfc7986#section-5.11\n *\n * @name EventComponent#getConferenceIterator\n * @function\n * @return {IterableIterator<ConferenceProperty>}\n */\n\n/**\n * Gets a list of all conference properties\n *\n * @url https://tools.ietf.org/html/rfc7986#section-5.11\n *\n * @name EventComponent#getConferenceList\n * @function\n * @return {ConferenceProperty[]}\n */\n\n/**\n * Removes a conference from this event\n *\n * @url https://tools.ietf.org/html/rfc7986#section-5.11\n *\n * @name EventComponent#removeConference\n * @function\n * @param {ConferenceProperty} conference\n */\n\n/**\n * Removes all conferences from this event\n *\n * @url https://tools.ietf.org/html/rfc7986#section-5.11\n *\n * @name EventComponent#clearAllConferences\n * @function\n */\nadvertiseMultipleOccurrenceProperty(EventComponent.prototype, 'conference')\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport AbstractComponent, {\n\tadvertiseMultipleOccurrenceProperty,\n\tadvertiseSingleOccurrenceProperty,\n} from '../abstractComponent.js'\nimport Timezone from '../../timezones/timezone.js'\nimport AttendeeProperty from '../../properties/attendeeProperty.js'\n\n/**\n * @class FreeBusyComponent\n * @classdesc\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.6.4\n */\nexport default class FreeBusyComponent extends AbstractComponent {\n\n\t/**\n\t * Gets the start-date of the FreeBusy component\n\t *\n\t * @return {DateTimeValue}\n\t */\n\tget startDate() {\n\t\treturn this.getFirstPropertyFirstValue('DTSTART')\n\t}\n\n\t/**\n\t * Sets the start-date of the FreeBusy component\n\t *\n\t * @param {DateTimeValue} startDate The start of the queried time-range\n\t */\n\tset startDate(startDate) {\n\t\tthis._modify()\n\t\tthis.updatePropertyWithValue('DTSTART', startDate.getInTimezone(Timezone.utc))\n\t}\n\n\t/**\n\t * Gets the end-date of the FreeBusy component\n\t *\n\t * @return {DateTimeValue}\n\t */\n\tget endDate() {\n\t\treturn this.getFirstPropertyFirstValue('DTEND')\n\t}\n\n\t/**\n\t * Sets the start-date of the FreeBusy component\n\t *\n\t * @param {DateTimeValue} endDate The end of the queried time-range\n\t */\n\tset endDate(endDate) {\n\t\tthis._modify()\n\t\tthis.updatePropertyWithValue('DTEND', endDate.getInTimezone(Timezone.utc))\n\t}\n\n\t/**\n\t * Gets an iterator over all FreeBusyProperties\n\t */\n\t* getFreeBusyIterator() {\n\t\tyield * this.getPropertyIterator('FREEBUSY')\n\t}\n\n\t/**\n\t * Adds a new attendee based on their name and email-address\n\t *\n\t * @url https://tools.ietf.org/html/rfc5545#section-3.8.4.1\n\t *\n\t * @param {string} name The name of the attendee to add\n\t * @param {string} email The email-address of the attendee to add\n\t */\n\taddAttendeeFromNameAndEMail(name, email) {\n\t\tthis._modify()\n\t\tthis.addProperty(AttendeeProperty.fromNameAndEMail(name, email))\n\t}\n\n\t/**\n\t * Sets the organiser property from common-name and email address\n\t *\n\t * @url https://tools.ietf.org/html/rfc5545#section-3.8.4.3\n\t *\n\t * @param {string} name The name of the organizer\n\t * @param {string} email The email-address of the organizer\n\t */\n\tsetOrganizerFromNameAndEMail(name, email) {\n\t\tthis._modify()\n\t\tthis.deleteAllProperties('ORGANIZER')\n\t\tthis.addProperty(AttendeeProperty.fromNameAndEMail(name, email, true))\n\t}\n\n}\n\n/**\n * The organizer of this FreeBusy component\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.4.3\n *\n * @name FreeBusyComponent#organizer\n * @type {AttendeeProperty}\n */\nadvertiseSingleOccurrenceProperty(FreeBusyComponent.prototype, 'organizer')\n\n/**\n * The UID of this FreeBusy component\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.4.7\n *\n * @name FreeBusyComponent#organizer\n * @type {AttendeeProperty}\n */\nadvertiseSingleOccurrenceProperty(FreeBusyComponent.prototype, 'uid')\n\n/**\n * Returns an iterator of all attendees\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.4.1\n *\n * @name FreeBusyComponent#getAttendeeIterator\n * @function\n * @return {IterableIterator<AttendeeProperty>}\n */\n\n/**\n * Returns a list of all attendees\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.4.1\n *\n * @name FreeBusyComponent#getAttendeeList\n * @function\n * @return {AttendeeProperty[]}\n */\n\n/**\n * Removes an attendee\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.4.1\n *\n * @name FreeBusyComponent#removeAttendee\n * @function\n * @param {AttendeeProperty} attendee\n */\n\n/**\n * Removes all attendees\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.4.1\n *\n * @name FreeBusyComponent#clearAllAttendees\n * @function\n */\nadvertiseMultipleOccurrenceProperty(FreeBusyComponent.prototype, 'attendee')\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport AbstractRecurringComponent from './abstractRecurringComponent.js'\nimport { advertiseMultipleOccurrenceProperty } from '../abstractComponent.js'\nimport TextProperty from '../../properties/textProperty.js'\n\n/**\n * @class JournalComponent\n * @classdesc\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.6.3\n */\nexport default class JournalComponent extends AbstractRecurringComponent {\n\n\t/**\n\t * Adds a new description property\n\t *\n\t * @url https://tools.ietf.org/html/rfc5545#section-3.8.1.5\n\t *\n\t * @param {string} description The description text\n\t */\n\taddDescription(description) {\n\t\tthis.addProperty(new TextProperty('DESCRIPTION', description))\n\t}\n\n}\n\n/**\n * Gets an iterator over all description properties\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.1.5\n *\n * @name JournalComponent#getDescriptionIterator\n * @function\n * @return {IterableIterator<ConferenceProperty>}\n */\n\n/**\n * Gets a list of all description properties\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.1.5\n *\n * @name JournalComponent#getDescriptionList\n * @function\n * @return {ConferenceProperty[]}\n */\n\n/**\n * Removes a description from this event\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.1.5\n *\n * @name JournalComponent#removeDescription\n * @function\n * @param {ConferenceProperty} conference\n */\n\n/**\n * Removes all descriptions from this event\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.1.5\n *\n * @name JournalComponent#clearAllDescriptions\n * @function\n */\nadvertiseMultipleOccurrenceProperty(JournalComponent.prototype, 'description')\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport AbstractComponent, {\n\tadvertiseSingleOccurrenceProperty,\n} from '../abstractComponent.js'\nimport Timezone from '../../timezones/timezone.js'\n\n/**\n * @class TimezoneComponent\n * @classdesc\n *\n * There are no advertised properties / components for the TimezoneComponent,\n * since we don't care about it.\n * Editing / accessing the timezone information directly is not a use-case\n * All the timezone-handling is done by the underlying ICAL.JS\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.6.5\n */\nexport default class TimezoneComponent extends AbstractComponent {\n\n\t/**\n\t * Returns a calendar-js Timezone object\n\t *\n\t * @return {Timezone}\n\t */\n\ttoTimezone() {\n\t\treturn new Timezone(this.toICALJs())\n\t}\n\n}\n\n/**\n * The timezoneId of this timezone-component\n *\n * @name TimezoneComponent#timezoneId\n * @type {string}\n */\nadvertiseSingleOccurrenceProperty(TimezoneComponent.prototype, {\n\tname: 'timezoneId',\n\tiCalendarName: 'tzid',\n})\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport AbstractRecurringComponent from './abstractRecurringComponent.js'\nimport {\n\tadvertiseMultipleOccurrenceProperty,\n\tadvertiseMultiValueStringPropertySeparatedByLang,\n\tadvertiseSingleOccurrenceProperty,\n} from '../abstractComponent.js'\nimport ConferenceProperty from '../../properties/conferenceProperty.js'\nimport GeoProperty from '../../properties/geoProperty.js'\n\n/**\n * @class ToDoComponent\n * @classdesc\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.6.2\n */\nexport default class ToDoComponent extends AbstractRecurringComponent {\n\n\t/**\n\t * Returns whether this event is an all-day event\n\t *\n\t * @return {boolean}\n\t */\n\tisAllDay() {\n\t\tconst propertiesToCheck = ['DTSTART', 'DUE']\n\t\tfor (const propertyToCheck of propertiesToCheck) {\n\t\t\tif (this.hasProperty(propertyToCheck)) {\n\t\t\t\treturn this.getFirstPropertyFirstValue(propertyToCheck).isDate\n\t\t\t}\n\t\t}\n\n\t\t// If a task is not associated with any date, it is defined to\n\t\t// occur on any successive date until it is completed.\n\t\t// We are treating it as all-day in that case.\n\t\treturn true\n\t}\n\n\t/**\n\t * Checks whether it's possible to switch from date-time to date or vise-versa\n\t *\n\t * @return {boolean}\n\t */\n\tcanModifyAllDay() {\n\t\tif (!this.hasProperty('dtstart') && !this.hasProperty('due')) {\n\t\t\treturn false\n\t\t}\n\n\t\treturn !this.recurrenceManager.masterItem.isRecurring()\n\t}\n\n\t/**\n\t * Gets the calculated end-date of the task\n\t *\n\t * If there is a due-date, we will just return that.\n\t * If there is a start-date and a duration, we will\n\t * calculate the end-date based on that.\n\t *\n\t * If there is neither a due-date nor a combination\n\t * of start-date and duration, we just return null\n\t *\n\t * @return {DateTimeValue|null}\n\t */\n\tget endDate() {\n\t\tif (this.hasProperty('due')) {\n\t\t\treturn this.getFirstPropertyFirstValue('due')\n\t\t}\n\n\t\tif (!this.hasProperty('dtstart') || !this.hasProperty('duration')) {\n\t\t\treturn null\n\t\t}\n\n\t\tconst endDate = this.startDate.clone()\n\t\tendDate.addDuration(this.getFirstPropertyFirstValue('duration'))\n\t\treturn endDate\n\t}\n\n\t/**\n\t * Shifts the entire task by the given duration\n\t *\n\t * @param {DurationValue} delta The duration to shift event by\n\t * @param {boolean} allDay Whether the updated event should be all-day or not\n\t * @param {Timezone} defaultTimezone The default timezone if moving from all-day to timed event\n\t * @param {DurationValue} defaultAllDayDuration The default all-day duration if moving from timed to all-day\n\t * @param {DurationValue} defaultTimedDuration The default timed duration if moving from all-day to timed\n\t */\n\tshiftByDuration(delta, allDay, defaultTimezone, defaultAllDayDuration, defaultTimedDuration) {\n\t\tconst currentAllDay = this.isAllDay()\n\n\t\tif (!this.hasProperty('dtstart') && !this.hasProperty('due')) {\n\t\t\tthrow new TypeError('This task does not have a start-date nor due-date')\n\t\t}\n\n\t\tif (currentAllDay !== allDay && !this.canModifyAllDay()) {\n\t\t\tthrow new TypeError('Can\\'t modify all-day of this todo')\n\t\t}\n\n\t\t// If this task has a start-date, update it\n\t\t// This is especially important, if you shift\n\t\t// the task by a negative duration, because\n\t\t// dtstart always has to be prior to the due date\n\t\tif (this.hasProperty('dtstart')) {\n\t\t\tthis.startDate.isDate = allDay\n\t\t\tthis.startDate.addDuration(delta)\n\n\t\t\tif (currentAllDay && !allDay) {\n\t\t\t\tthis.startDate.replaceTimezone(defaultTimezone)\n\t\t\t}\n\t\t}\n\n\t\tif (this.hasProperty('due')) {\n\t\t\tthis.dueTime.isDate = allDay\n\t\t\tthis.dueTime.addDuration(delta)\n\n\t\t\tif (currentAllDay && !allDay) {\n\t\t\t\tthis.dueTime.replaceTimezone(defaultTimezone)\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Checks if this event is in a given time-frame\n\t *\n\t * @param {DateTimeValue} start Start of time-range to check\n\t * @param {DateTimeValue} end End of time-range to check\n\t * @return {boolean}\n\t */\n\tisInTimeFrame(start, end) {\n\t\tif (!this.hasProperty('dtstart') && !this.hasProperty('due')) {\n\t\t\treturn true\n\t\t}\n\n\t\tif (!this.hasProperty('dtstart') && this.hasProperty('due')) {\n\t\t\treturn start.compare(this.endDate) <= 0\n\t\t}\n\n\t\treturn start.compare(this.endDate) <= 0 && end.compare(this.startDate) >= 0\n\t}\n\n\t/**\n\t * Gets the geographical position property\n\t *\n\t * @return {GeoProperty}\n\t */\n\tget geographicalPosition() {\n\t\treturn this.getFirstProperty('GEO')\n\t}\n\n\t/**\n\t * Sets the geographical position based on latitude and longitude\n\t *\n\t * @url https://tools.ietf.org/html/rfc5545#section-3.8.1.6\n\t *\n\t * @param {number} lat - latitude\n\t * @param {number} long - longitude\n\t */\n\tsetGeographicalPositionFromLatitudeAndLongitude(lat, long) {\n\t\tthis.deleteAllProperties('GEO')\n\t\tthis.addProperty(GeoProperty.fromPosition(lat, long))\n\t}\n\n\t/**\n\t * Adds a new conference property based on URI, label and features\n\t *\n\t * @url https://tools.ietf.org/html/rfc7986#section-5.11\n\t *\n\t * @param {string} uri The URI of the conference\n\t * @param {string=} label The label of the conference\n\t * @param {string[]=} features Supported features of conference-system\n\t */\n\taddConference(uri, label = null, features = null) {\n\t\tthis.addProperty(ConferenceProperty.fromURILabelAndFeatures(uri, label, features))\n\t}\n\n\t/**\n\t * Gets a recurrence-id that has to be used to refer to this task.\n\t * This is used for recurrence-management.\n\t *\n\t * Gracefully handles the case where a task has no start-date, but a due-date.\n\t *\n\t * @return {DateTimeValue|null}\n\t */\n\tgetReferenceRecurrenceId() {\n\t\treturn super.getReferenceRecurrenceId() ?? this.endDate\n\t}\n\n}\n\n/**\n * The time when a task was completed\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.2.1\n *\n * @name ToDoComponent#completedTime\n * @type {DateTimeValue}\n */\nadvertiseSingleOccurrenceProperty(ToDoComponent.prototype, {\n\tname: 'completedTime',\n\tiCalendarName: 'COMPLETED',\n})\n\n/**\n * The time when a task is due\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.2.3\n *\n * @name ToDoComponent#dueTime\n * @type {DateTimeValue}\n */\nadvertiseSingleOccurrenceProperty(ToDoComponent.prototype, {\n\tname: 'dueTime',\n\tiCalendarName: 'DUE',\n})\n\n/**\n * The time when a task was completed\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.2.5\n *\n * @name ToDoComponent#duration\n * @type {DurationValue}\n */\nadvertiseSingleOccurrenceProperty(ToDoComponent.prototype, {\n\tname: 'duration',\n})\n\n/**\n * The percentage a task was already fulfilled\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.1.8\n *\n * @name ToDoComponent#percent\n * @type {number}\n */\nadvertiseSingleOccurrenceProperty(ToDoComponent.prototype, {\n\tname: 'percent',\n\tiCalendarName: 'PERCENT-COMPLETE',\n})\n\n/**\n * Description of this task.\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.1.5\n *\n * @name ToDoComponent#description\n * @type {string}\n */\nadvertiseSingleOccurrenceProperty(ToDoComponent.prototype, 'description')\n\n/**\n * Location of this task.\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.1.7\n *\n * @name ToDoComponent#location\n * @type {string}\n */\nadvertiseSingleOccurrenceProperty(ToDoComponent.prototype, 'location')\n\n/**\n * Priority of this task.\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.1.9\n *\n * @name ToDoComponent#priority\n * @type {string}\n */\nadvertiseSingleOccurrenceProperty(ToDoComponent.prototype, {\n\tname: 'priority',\n\tallowedValues: Array.from(Array(10).keys()),\n\tdefaultValue: 0,\n\tunknownValue: 0,\n})\n\n/**\n * Returns an iterator over all resources\n * If the parameter lang is given, it will only\n * return an iterator for Resources matching that language\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.1.10\n *\n * @name ToDoComponent#getResourceIterator\n * @function\n * @param {string=} lang\n * @return {IterableIterator<string>}\n */\n\n/**\n * Returns a list of all resources\n * If the parameter lang is given, it will only\n * return an iterator for resources matching that language\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.1.10\n *\n * @name ToDoComponent#getResourceList\n * @function\n * @param {string=} lang\n * @return {string[]}\n */\n\n/**\n * Adds a resource\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.1.10\n *\n * @name ToDoComponent#addResource\n * @function\n * @param {string} resource\n * @param {string=} lang\n */\n\n/**\n * Removes a resource\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.1.10\n *\n * @name ToDoComponent#removeResource\n * @function\n * @param {string} resource\n * @param {string=} lang\n */\n\n/**\n * Removes all resources from this task\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.1.10\n *\n * @name ToDoComponent#clearAllResources\n * @function\n * @param {string=} lang\n */\nadvertiseMultiValueStringPropertySeparatedByLang(ToDoComponent.prototype, {\n\tname: 'resource',\n\tiCalendarName: 'RESOURCES',\n})\n\n/**\n * Gets an iterator over all conference properties\n *\n * @url https://tools.ietf.org/html/rfc7986#section-5.11\n *\n * @name ToDoComponent#getConferenceIterator\n * @function\n * @return {IterableIterator<ConferenceProperty>}\n */\n\n/**\n * Gets a list of all conference properties\n *\n * @url https://tools.ietf.org/html/rfc7986#section-5.11\n *\n * @name ToDoComponent#getConferenceList\n * @function\n * @return {ConferenceProperty[]}\n */\n\n/**\n * Removes a conference from this event\n *\n * @url https://tools.ietf.org/html/rfc7986#section-5.11\n *\n * @name ToDoComponent#removeConference\n * @function\n * @param {ConferenceProperty} conference\n */\n\n/**\n * Removes all conferences from this event\n *\n * @url https://tools.ietf.org/html/rfc7986#section-5.11\n *\n * @name ToDoComponent#clearAllConferences\n * @function\n */\nadvertiseMultipleOccurrenceProperty(ToDoComponent.prototype, 'conference')\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport AbstractComponent from '../abstractComponent.js'\nimport EventComponent from './eventComponent.js'\nimport FreeBusyComponent from './freeBusyComponent.js'\nimport JournalComponent from './journalComponent.js'\nimport TimezoneComponent from './timezoneComponent.js'\nimport ToDoComponent from './toDoComponent.js'\nimport { uc } from '../../helpers/stringHelper.js'\n\n/**\n * Gets the constructor for a component name\n * This will only return a constructor for components,\n * that can be used in the root of a calendar-document\n *\n * @param {string} compName Name of the component to get constructor for\n * @return {AbstractComponent|ToDoComponent|JournalComponent|FreeBusyComponent|TimezoneComponent|EventComponent}\n */\nexport function getConstructorForComponentName(compName) {\n\tswitch (uc(compName)) {\n\tcase 'VEVENT':\n\t\treturn EventComponent\n\n\tcase 'VFREEBUSY':\n\t\treturn FreeBusyComponent\n\n\tcase 'VJOURNAL':\n\t\treturn JournalComponent\n\n\tcase 'VTIMEZONE':\n\t\treturn TimezoneComponent\n\n\tcase 'VTODO':\n\t\treturn ToDoComponent\n\n\tdefault:\n\t\treturn AbstractComponent\n\t}\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport AbstractComponent, {\n\tadvertiseSingleOccurrenceProperty,\n} from './abstractComponent.js'\nimport { getConstructorForComponentName } from './root/index.js'\nimport { getConfig } from '../config.js'\nimport ICAL from 'ical.js'\n\n/**\n * This class represents one VCALENDAR block\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.4\n */\nexport default class CalendarComponent extends AbstractComponent {\n\n\t/**\n\t * Constructor\n\t *\n\t * @inheritDoc\n\t */\n\tconstructor(name = 'VCALENDAR', properties = [], components = []) {\n\t\tsuper(name, properties, components)\n\t\tthis.root = this\n\t\tthis.parent = null\n\t}\n\n\t/**\n\t * Gets an iterator over all VTIMEZONE components\n\t */\n\t* getTimezoneIterator() {\n\t\tyield * this.getComponentIterator('vtimezone')\n\t}\n\n\t/**\n\t * Gets an iterator over all VObject components\n\t */\n\t* getVObjectIterator() {\n\t\tyield * this.getEventIterator()\n\t\tyield * this.getJournalIterator()\n\t\tyield * this.getTodoIterator()\n\t}\n\n\t/**\n\t * Gets an iterator over all VEVENT components\n\t */\n\t* getEventIterator() {\n\t\tyield * this.getComponentIterator('vevent')\n\t}\n\n\t/**\n\t * Gets an iterator over all VFREEBUSY components\n\t */\n\t* getFreebusyIterator() {\n\t\tyield * this.getComponentIterator('vfreebusy')\n\t}\n\n\t/**\n\t * Gets an iterator over all VJOURNAL components\n\t */\n\t* getJournalIterator() {\n\t\tyield * this.getComponentIterator('vjournal')\n\t}\n\n\t/**\n\t * Gets an iterator over all VTODO components\n\t */\n\t* getTodoIterator() {\n\t\tyield * this.getComponentIterator('vtodo')\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tstatic _getConstructorForComponentName(componentName) {\n\t\treturn getConstructorForComponentName(componentName)\n\t}\n\n\t/**\n\t * Converts this calendar component into text/calendar\n\t *\n\t * @param {boolean} cleanUpTimezones Whether or not to clean up timezone data\n\t * @return {string}\n\t */\n\ttoICS(cleanUpTimezones = true) {\n\t\tfor (const vObject of this.getVObjectIterator()) {\n\t\t\tvObject.undirtify()\n\t\t}\n\n\t\tconst icalRoot = this.toICALJs()\n\t\tif (cleanUpTimezones) {\n\t\t\tICAL.helpers.updateTimezones(icalRoot)\n\t\t}\n\t\treturn icalRoot.toString()\n\t}\n\n\t/**\n\t * Creates a new empty calendar-component\n\t *\n\t * @param {[string][]=} additionalProps Additional props to add to empty calendar-document\n\t * @return {CalendarComponent}\n\t */\n\tstatic fromEmpty(additionalProps = []) {\n\t\treturn new this('VCALENDAR', [\n\t\t\t['prodid', getConfig('PRODID', '-//IDN georgehrke.com//calendar-js//EN')],\n\t\t\t['calscale', 'GREGORIAN'],\n\t\t\t['version', '2.0'],\n\t\t].concat(additionalProps))\n\t}\n\n\t/**\n\t * Creates a new calendar-component with a method\n\t *\n\t * @param {string} method The method for the calendar-document\n\t * @return {CalendarComponent}\n\t */\n\tstatic fromMethod(method) {\n\t\treturn this.fromEmpty([['method', method]])\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tstatic fromICALJs(icalValue) {\n\t\tconst comp = super.fromICALJs(icalValue)\n\t\tcomp.root = comp\n\n\t\treturn comp\n\t}\n\n}\n\n/**\n * ProductId representing the software that created this calendar-document\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.7.3\n *\n * @name CalendarComponent#productId\n * @type {string}\n */\nadvertiseSingleOccurrenceProperty(CalendarComponent.prototype, {\n\tname: 'productId',\n\tiCalendarName: 'PRODID',\n})\n\n/**\n * iCalendar version of this calendar-document\n * minver and maxver parameters are not supported, since they\n * are virtually used by no calendaring-software\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.7.4\n *\n * @name CalendarComponent#version\n * @type {string}\n */\n\nadvertiseSingleOccurrenceProperty(CalendarComponent.prototype, {\n\tname: 'version',\n})\n\n/**\n * Calendar-scale used in this calendar-document\n * The default and only supported calendar-scale is GREGORIAN.\n * There is an iCalendar-extension about non-gregorian RRULES,\n * but that is not supported by calendar-js at the moment\n *\n * @see https://tools.ietf.org/html/rfc7529\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.7.1\n *\n * @name CalendarComponent#calendarScale\n * @type {string}\n * @default \"GREGORIAN\"\n */\nadvertiseSingleOccurrenceProperty(CalendarComponent.prototype, {\n\tname: 'calendarScale',\n\tiCalendarName: 'CALSCALE',\n\tdefaultValue: 'GREGORIAN',\n})\n\n/**\n * Method of this calendar-document when being used in an iTIP message\n * Please see https://tools.ietf.org/html/rfc5546#section-3.2 for more information\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.7.2\n *\n * @name CalendarComponent#method\n * @type {string}\n */\nadvertiseSingleOccurrenceProperty(CalendarComponent.prototype, {\n\tname: 'method',\n})\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\n/**\n * @class AbstractRepairStep\n * @classdesc A repair step is used to fix calendar-data before it is parsed\n */\nexport default class AbstractRepairStep {\n\n\t/**\n\t * @class\n\t */\n\tconstructor() {\n\t\tif (new.target === AbstractRepairStep) {\n\t\t\tthrow new TypeError('Cannot instantiate abstract class AbstractRepairStep')\n\t\t}\n\t}\n\n\t/**\n\t * @param {string} input String representation of the data to repair\n\t */\n\trepair(input) {\n\t\tthrow new TypeError('Abstract method not implemented by subclass')\n\t}\n\n\t/**\n\t * @return {number}\n\t */\n\tstatic priority() {\n\t\treturn 0\n\t}\n\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport AbstractRepairStep from '../abstractRepairStep.js'\nimport { v4 as uuid } from 'uuid'\n\n/**\n * @class ICalendarAddMissingUIDRepairStep\n */\nexport default class ICalendarAddMissingUIDRepairStep extends AbstractRepairStep {\n\n\t/**\n\t * Please see the corresponding test file for an example of broken calendar-data\n\t *\n\t * @inheritDoc\n\t */\n\trepair(ics) {\n\t\treturn ics\n\t\t\t.replace(/^BEGIN:(VEVENT|VTODO|VJOURNAL)$(((?!^END:(VEVENT|VTODO|VJOURNAL)$)(?!^UID.*$)(.|\\n))*)^END:(VEVENT|VTODO|VJOURNAL)$\\n/gm, (match, vobjectName, vObjectBlock) => {\n\t\t\t\treturn 'BEGIN:' + vobjectName + '\\r\\n'\n\t\t\t\t\t+ 'UID:' + uuid()\n\t\t\t\t\t+ vObjectBlock\n\t\t\t\t\t+ 'END:' + vobjectName + '\\r\\n'\n\t\t\t})\n\t}\n\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport AbstractRepairStep from '../abstractRepairStep.js'\n\n/**\n * @class ICalendarAddMissingValueDateDoubleColonRepairStep\n */\nexport default class ICalendarAddMissingValueDateDoubleColonRepairStep extends AbstractRepairStep {\n\n\t/**\n\t * Please see the corresponding test file for an example of broken calendar-data\n\t *\n\t * @inheritDoc\n\t */\n\trepair(ics) {\n\t\treturn ics\n\t\t\t.replace(/^(DTSTART|DTEND)(.*):([0-9]{8})T(::)$/gm, (match, propName, parameters, date) => {\n\t\t\t\treturn propName + ';VALUE=DATE:' + date\n\t\t\t})\n\t}\n\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport AbstractRepairStep from '../abstractRepairStep.js'\n\n/**\n * @class ICalendarAddMissingValueDateRepairStep\n */\nexport default class ICalendarAddMissingValueDateRepairStep extends AbstractRepairStep {\n\n\t/**\n\t * Please see the corresponding test file for an example of broken calendar-data\n\t *\n\t * @inheritDoc\n\t */\n\trepair(ics) {\n\t\treturn ics\n\t\t\t.replace(/^(DTSTART|DTEND|EXDATE)(((?!VALUE=DATE).)*):([0-9]{8})$/gm, (match, propName, parameters, _, date) => {\n\t\t\t\treturn propName + parameters + ';VALUE=DATE:' + date\n\t\t\t})\n\t}\n\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport AbstractRepairStep from '../abstractRepairStep.js'\n\n/**\n * @class ICalendarEmptyTriggerRepairStep\n * @classdesc This repair step fixes malformed TRIGGER properties\n */\nexport default class ICalendarEmptyTriggerRepairStep extends AbstractRepairStep {\n\n\t/**\n\t * Please see the corresponding test file for an example of broken calendar-data\n\t *\n\t * @inheritDoc\n\t */\n\trepair(ics) {\n\t\treturn ics\n\t\t\t.replace(/^TRIGGER:P$/gm, 'TRIGGER:P0D')\n\t\t\t.replace(/^TRIGGER:-P$/gm, 'TRIGGER:P0D')\n\t}\n\n}\n","/**\n * @copyright Copyright (c) 2020 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport AbstractRepairStep from '../abstractRepairStep.js'\n\nexport default class ICalendarIllegalCreatedRepairStep extends AbstractRepairStep {\n\n\t/**\n\t * Please see the corresponding test file for an example of broken calendar-data\n\t *\n\t * @inheritDoc\n\t */\n\trepair(ics) {\n\t\treturn ics\n\t\t\t.replace(/^CREATED:00001231T000000Z$/gm, 'CREATED:19700101T000000Z')\n\t}\n\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport AbstractRepairStep from '../abstractRepairStep.js'\nimport { uc } from '../../../helpers/stringHelper.js'\n\n/**\n * @class ICalendarMultipleVCalendarBlocksRepairStep\n * @classdesc This repair step merges multiple BEGIN:VCALENDAR...END:VCALENDAR blocks\n */\nexport default class ICalendarMultipleVCalendarBlocksRepairStep extends AbstractRepairStep {\n\n\t/**\n\t * Please see the corresponding test file for an example of broken calendar-data\n\t *\n\t * @inheritDoc\n\t */\n\trepair(ics) {\n\t\tlet containsProdId = false\n\t\tlet containsVersion = false\n\t\tlet containsCalscale = false\n\t\tconst includedTimezones = new Set()\n\n\t\treturn ics\n\t\t\t.replace(/^END:VCALENDAR$(((?!^BEGIN:)(.|\\n))*)^BEGIN:VCALENDAR$\\n/gm, '')\n\t\t\t.replace(/^PRODID:(.*)$\\n/gm, (match) => {\n\t\t\t\tif (containsProdId) {\n\t\t\t\t\treturn ''\n\t\t\t\t}\n\n\t\t\t\tcontainsProdId = true\n\t\t\t\treturn match\n\t\t\t})\n\t\t\t.replace(/^VERSION:(.*)$\\n/gm, (match) => {\n\t\t\t\tif (containsVersion) {\n\t\t\t\t\treturn ''\n\t\t\t\t}\n\n\t\t\t\tcontainsVersion = true\n\t\t\t\treturn match\n\t\t\t})\n\t\t\t.replace(/^CALSCALE:(.*)$\\n/gm, (match) => {\n\t\t\t\tif (containsCalscale) {\n\t\t\t\t\treturn ''\n\t\t\t\t}\n\n\t\t\t\tcontainsCalscale = true\n\t\t\t\treturn match\n\t\t\t})\n\t\t\t.replace(/^BEGIN:VTIMEZONE$(((?!^END:VTIMEZONE$)(.|\\n))*)^END:VTIMEZONE$\\n/gm, (match) => {\n\t\t\t\tconst tzidMatcher = match.match(/^TZID:(.*)$/gm)\n\n\t\t\t\t// If this Timezone definition contains no TZID for some reason,\n\t\t\t\t// just remove it, because we can't use it anyway\n\t\t\t\tif (tzidMatcher === null) {\n\t\t\t\t\treturn ''\n\t\t\t\t}\n\n\t\t\t\tconst tzid = uc(tzidMatcher[0].slice(5))\n\t\t\t\tif (includedTimezones.has(tzid)) {\n\t\t\t\t\t// If we already included this timezone, just skip\n\t\t\t\t\treturn ''\n\t\t\t\t}\n\n\t\t\t\tincludedTimezones.add(tzid)\n\t\t\t\treturn match\n\t\t\t})\n\t}\n\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport AbstractRepairStep from '../abstractRepairStep.js'\n\n/**\n * @class ICalendarRemoveXNCGroupIdRepairStep\n * @classdesc This repair step removes the X-NC-GroupID parameter used in previous versions of Nextcloud\n */\nexport default class ICalendarRemoveXNCGroupIdRepairStep extends AbstractRepairStep {\n\n\t/**\n\t * Please see the corresponding test file for an example of broken calendar-data\n\t *\n\t * @inheritDoc\n\t */\n\trepair(ics) {\n\t\treturn ics\n\t\t\t.replace(/(^.*)(;X-NC-GROUP-ID=\\d+)(:.*$)/gm, '$1$3')\n\t}\n\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport ICalendarAddMissingUIDRepairStep from './icalendarAddMissingUIDRepairStep.js'\nimport ICalendarAddMissingValueDateDoubleColonRepairStep from './icalendarAddMissingValueDateDoubleColonRepairStep.js'\nimport ICalendarAddMissingValueDateRepairStep from './icalendarAddMissingValueDateRepairStep.js'\nimport ICalendarEmptyTriggerRepairStep from './icalendarEmptyTriggerRepairStep.js'\nimport ICalendarIllegalCreatedRepairStep from './icalendarIllegalCreatedRepairStep.js'\nimport ICalendarMultipleVCalendarBlocksRepairStep from './icalendarMultipleVCalendarBlocksRepairStep.js'\nimport ICalendarRemoveXNCGroupIdRepairStep from './icalendarRemoveXNCGroupIdRepairStep.js'\n\n/**\n * Get an iterator over all repair steps for iCalendar documents\n */\nexport function * getRepairSteps() {\n\tyield ICalendarAddMissingUIDRepairStep\n\tyield ICalendarAddMissingValueDateDoubleColonRepairStep\n\tyield ICalendarAddMissingValueDateRepairStep\n\tyield ICalendarEmptyTriggerRepairStep\n\tyield ICalendarIllegalCreatedRepairStep\n\tyield ICalendarMultipleVCalendarBlocksRepairStep\n\tyield ICalendarRemoveXNCGroupIdRepairStep\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport Timezone from './timezone.js'\nimport tzData from '../../resources/timezones/zones.json'\n\n/**\n * @class TimezoneManager\n */\nexport class TimezoneManager {\n\n\t/**\n\t * Constructor\n\t */\n\tconstructor() {\n\t\t/**\n\t\t * Map of aliases\n\t\t * Alias name => timezoneId\n\t\t *\n\t\t * @type {Map<string, string>}\n\t\t */\n\t\tthis._aliases = new Map()\n\n\t\t/**\n\t\t * Map of Timezones\n\t\t * timezoneId => Timezone\n\t\t *\n\t\t * @type {Map<string, Timezone>}\n\t\t * @private\n\t\t */\n\t\tthis._timezones = new Map()\n\t}\n\n\t/**\n\t * Gets a timezone for the given id\n\t *\n\t * @param {string} timezoneId The id of the timezone\n\t * @return {Timezone|null}\n\t */\n\tgetTimezoneForId(timezoneId) {\n\t\treturn this._getTimezoneForIdRec(timezoneId, 0)\n\t}\n\n\t_getTimezoneForIdRec(timezoneId, level) {\n\t\tif (this._timezones.has(timezoneId)) {\n\t\t\treturn this._timezones.get(timezoneId)\n\t\t}\n\n\t\tif (level >= 20) {\n\t\t\t// too much recursion\n\t\t\tconsole.error('TimezoneManager.getTimezoneForIdRec() exceeds recursion limits')\n\t\t\treturn null\n\t\t}\n\n\t\tif (this._aliases.has(timezoneId)) {\n\t\t\tconst resolvedTimezoneId = this._aliases.get(timezoneId)\n\t\t\t// can be a recursive alias:\n\t\t\treturn this._getTimezoneForIdRec(resolvedTimezoneId, level + 1)\n\t\t}\n\n\t\treturn null\n\t}\n\n\t/**\n\t * Checks if there is a timezone for the given id stored in this manager\n\t *\n\t * @param {string} timezoneId The id of the timezone\n\t * @return {boolean}\n\t */\n\thasTimezoneForId(timezoneId) {\n\t\treturn this._timezones.has(timezoneId) || this._aliases.has(timezoneId)\n\t}\n\n\t/**\n\t * Checks if the given timezone id is an alias\n\t *\n\t * @param {string} timezoneId The id of the timezone\n\t * @return {boolean}\n\t */\n\tisAlias(timezoneId) {\n\t\treturn !this._timezones.has(timezoneId) && this._aliases.has(timezoneId)\n\t}\n\n\t/**\n\t * Lists all timezones\n\t *\n\t * @param {boolean=} includeAliases Whether or not to include aliases\n\t * @return {string[]}\n\t */\n\tlistAllTimezones(includeAliases = false) {\n\t\tconst timezones = Array.from(this._timezones.keys())\n\n\t\tif (includeAliases) {\n\t\t\treturn timezones.concat(Array.from(this._aliases.keys()))\n\t\t}\n\n\t\treturn timezones\n\t}\n\n\t/**\n\t * Registers a timezone\n\t *\n\t * @param {Timezone} timezone The timezone-object to register\n\t */\n\tregisterTimezone(timezone) {\n\t\tthis._timezones.set(timezone.timezoneId, timezone)\n\t}\n\n\tregisterDefaultTimezones() {\n\t\tconsole.debug(`@nextcloud/calendar-js app is using version ${tzData.version} of the timezone database`)\n\n\t\tfor (const tzid in tzData.zones) {\n\t\t\tif (Object.prototype.hasOwnProperty.call(tzData.zones, [tzid])) {\n\t\t\t\tconst ics = [\n\t\t\t\t\t'BEGIN:VTIMEZONE',\n\t\t\t\t\t'TZID:' + tzid,\n\t\t\t\t\t...tzData.zones[tzid].ics,\n\t\t\t\t\t'END:VTIMEZONE',\n\t\t\t\t].join('\\r\\n')\n\t\t\t\tthis.registerTimezoneFromICS(tzid, ics)\n\t\t\t}\n\t\t}\n\n\t\tfor (const tzid in tzData.aliases) {\n\t\t\tif (Object.prototype.hasOwnProperty.call(tzData.aliases, [tzid])) {\n\t\t\t\tthis.registerAlias(tzid, tzData.aliases[tzid].aliasTo)\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Registers a timezone based on ics data\n\t *\n\t * @param {string} timezoneId The id of the timezone\n\t * @param {string} ics The iCalendar timezone definition\n\t */\n\tregisterTimezoneFromICS(timezoneId, ics) {\n\t\tconst timezone = new Timezone(timezoneId, ics)\n\t\tthis.registerTimezone(timezone)\n\t}\n\n\t/**\n\t * Registers a new timezone-alias\n\t *\n\t * @param {string} aliasName The timezone-id of the alias\n\t * @param {string} timezoneId The timezone-id to resolve the alias to\n\t */\n\tregisterAlias(aliasName, timezoneId) {\n\t\tthis._aliases.set(aliasName, timezoneId)\n\t}\n\n\t/**\n\t * Unregisters a timezone\n\t *\n\t * @param {string} timezoneId Unregisters a timezone by Id\n\t */\n\tunregisterTimezones(timezoneId) {\n\t\tthis._timezones.delete(timezoneId)\n\t}\n\n\t/**\n\t * Unregisters a timezone-alias\n\t *\n\t * @param {string} aliasName The alias to unregister\n\t */\n\tunregisterAlias(aliasName) {\n\t\tthis._aliases.delete(aliasName)\n\t}\n\n\t/**\n\t * Clear all timezones\n\t */\n\tclearAllTimezones() {\n\t\tthis._aliases = new Map()\n\t\tthis._timezones = new Map()\n\n\t\ttimezoneManager.registerTimezone(Timezone.utc)\n\t\ttimezoneManager.registerTimezone(Timezone.floating)\n\t\ttimezoneManager.registerAlias('GMT', Timezone.utc.timezoneId)\n\t\ttimezoneManager.registerAlias('Z', Timezone.utc.timezoneId)\n\t}\n\n}\n\nconst timezoneManager = new TimezoneManager()\ntimezoneManager.clearAllTimezones()\n\n/**\n * Gets the default instance of the timezone manager\n *\n * @return {TimezoneManager}\n */\nexport function getTimezoneManager() {\n\treturn timezoneManager\n}\n\n/**\n *\n * @param {string} tzName Name of the timezone to check\n * @return {boolean}\n */\nexport function isOlsonTimezone(tzName) {\n\tconst hasSlash = tzName.indexOf('/') !== -1\n\tconst hasSpace = tzName.indexOf(' ') !== -1\n\tconst startsWithETC = tzName.startsWith('Etc')\n\tconst startsWithUS = tzName.startsWith('US/')\n\n\treturn hasSlash && !hasSpace && !startsWithETC && !startsWithUS\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport AbstractParser from './abstractParser.js'\nimport CalendarComponent from '../components/calendarComponent.js'\nimport { getRepairSteps } from './repairsteps/icalendar/index.js'\nimport { uc } from '../helpers/stringHelper.js'\nimport { getConstructorForComponentName } from '../components/root/index.js'\nimport { getTimezoneManager } from '../timezones/timezoneManager.js'\nimport Timezone from '../timezones/timezone.js'\nimport RecurrenceManager from '../recurrence/recurrenceManager.js'\nimport DateTimeValue from '../values/dateTimeValue.js'\nimport ICAL from 'ical.js'\nimport TimezoneComponent from '../components/root/timezoneComponent.js'\n\n/**\n * @class ICalendarParser\n * @classdesc\n */\nexport default class ICalendarParser extends AbstractParser {\n\n\t/**\n\t * @inheritDoc\n\t */\n\tconstructor(...args) {\n\t\tsuper(...args)\n\n\t\t/**\n\t\t * The raw text/calendar data\n\t\t *\n\t\t * @type {string}\n\t\t * @protected\n\t\t */\n\t\tthis._rawData = null\n\n\t\t/**\n\t\t * The CalendarComponent representing the raw data\n\t\t *\n\t\t * @type {CalendarComponent}\n\t\t * @protected\n\t\t */\n\t\tthis._calendarComponent = null\n\n\t\t/**\n\t\t * A flag whether this calendar-data contains vevents\n\t\t *\n\t\t * @type {boolean}\n\t\t * @private\n\t\t */\n\t\tthis._containsVEvents = false\n\n\t\t/**\n\t\t * A flag whether this calendar-data contains vjournals\n\t\t *\n\t\t * @type {boolean}\n\t\t * @private\n\t\t */\n\t\tthis._containsVJournals = false\n\n\t\t/**\n\t\t * A flag whether this calendar-data contains vtodos\n\t\t *\n\t\t * @type {boolean}\n\t\t * @private\n\t\t */\n\t\tthis._containsVTodos = false\n\n\t\t/**\n\t\t * A flag whether this calendar-data contains vfreebusy\n\t\t *\n\t\t * @type {boolean}\n\t\t * @private\n\t\t */\n\t\tthis._containsVFreeBusy = false\n\n\t\t/**\n\t\t * A map containing all VObjects.\n\t\t * The key of this map is the UID\n\t\t * The value an array of all VObjects with that particular UID\n\t\t *\n\t\t * @type {Map<string, AbstractRecurringComponent[]>}\n\t\t * @private\n\t\t */\n\t\tthis._items = new Map()\n\n\t\t/**\n\t\t * Items that are no recurrence-exceptions\n\t\t * The key of this map is the UID\n\t\t *\n\t\t * @type {Map<string, AbstractRecurringComponent>}\n\t\t * @private\n\t\t */\n\t\tthis._masterItems = new Map()\n\n\t\t/**\n\t\t * Items that are recurrence exceptions\n\t\t *\n\t\t * @type {Map<string, AbstractRecurringComponent[]>}\n\t\t * @private\n\t\t */\n\t\tthis._recurrenceExceptionItems = new Map()\n\n\t\t/**\n\t\t * Some recurrence-exceptions come without a master item\n\t\t * In that case we need to forge a master item\n\t\t *\n\t\t * @type {Map<string, AbstractRecurringComponent>}\n\t\t * @private\n\t\t */\n\t\tthis._forgedMasterItems = new Map()\n\n\t\t/**\n\t\t * A list of timezone-components found in the calendar-data\n\t\t *\n\t\t * @type {Map<string, Timezone>}\n\t\t * @private\n\t\t */\n\t\tthis._timezones = new Map()\n\n\t\t/**\n\t\t * A set of required timezones for each UID\n\t\t *\n\t\t * @type {Map<string, Set<string>>}\n\t\t * @private\n\t\t */\n\t\tthis._requiredTimezones = new Map()\n\n\t\t/**\n\t\t * Instance of the default timezone-manager\n\t\t *\n\t\t * @type {TimezoneManager}\n\t\t * @private\n\t\t */\n\t\tthis._defaultTimezoneManager = getTimezoneManager()\n\t}\n\n\t/**\n\t * Parses the actual calendar-data\n\t *\n\t * @param {string} ics The icalendar data to parse\n\t */\n\tparse(ics) {\n\t\tthis._rawData = ics\n\n\t\tthis._applyRepairSteps()\n\n\t\t// If a timezone is not inside our TimezoneManager at the time of parsing\n\t\t// the internal zone will be marked as floating inside ICAL.Time\n\t\t// so before we start any actual parsing, we need to extract all timezones\n\t\t// and add them to the TimezoneManager\n\t\tthis._extractTimezones()\n\t\tthis._registerTimezones()\n\n\t\tthis._createCalendarComponent()\n\n\t\tif (this._getOption('extractGlobalProperties', false)) {\n\t\t\tthis._extractProperties()\n\t\t}\n\n\t\tthis._processVObjects()\n\n\t\tif (this._getOption('processFreeBusy', false)) {\n\t\t\tthis._processVFreeBusy()\n\t\t}\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\t* getItemIterator() {\n\t\tfor (const itemList of this._items.values()) {\n\t\t\tconst calendarComp = CalendarComponent.fromEmpty()\n\n\t\t\tif (this._getOption('includeTimezones', false)) {\n\t\t\t\tthis._addRequiredTimezonesToCalendarComp(calendarComp, itemList[0].uid)\n\t\t\t}\n\n\t\t\t// Preserve the original product id, just in case we need special handling for certain clients later on ...\n\t\t\tif (this._calendarComponent.hasProperty('PRODID')) {\n\t\t\t\tcalendarComp.deleteAllProperties('PRODID')\n\t\t\t\tcalendarComp.addProperty(this._calendarComponent.getFirstProperty('PRODID').clone())\n\t\t\t}\n\n\t\t\tif (this._getOption('preserveMethod', false)) {\n\t\t\t\tif (this._calendarComponent.hasProperty('METHOD')) {\n\t\t\t\t\tcalendarComp.deleteAllProperties('METHOD')\n\t\t\t\t\tcalendarComp.addProperty(this._calendarComponent.getFirstProperty('METHOD').clone())\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfor (const item of itemList) {\n\t\t\t\tcalendarComp.addComponent(item)\n\t\t\t}\n\n\t\t\tyield calendarComp\n\t\t}\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tcontainsVEvents() {\n\t\treturn this._containsVEvents\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tcontainsVJournals() {\n\t\treturn this._containsVJournals\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tcontainsVTodos() {\n\t\treturn this._containsVTodos\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tcontainsVFreeBusy() {\n\t\treturn this._containsVFreeBusy\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tgetItemCount() {\n\t\treturn Array.from(this._items.keys()).length\n\t}\n\n\t/**\n\t * Applies all registered repair steps\n\t *\n\t * @private\n\t */\n\t_applyRepairSteps() {\n\t\tfor (const RepairStep of getRepairSteps()) {\n\t\t\tconst step = new RepairStep()\n\t\t\tthis._rawData = step.repair(this._rawData)\n\t\t}\n\t}\n\n\t/**\n\t * Creates a calendar component based upon the repaired data\n\t *\n\t * @private\n\t */\n\t_createCalendarComponent() {\n\t\tconst jCal = ICAL.parse(this._rawData)\n\t\tconst icalComp = new ICAL.Component(jCal)\n\t\tthis._calendarComponent = CalendarComponent.fromICALJs(icalComp)\n\t}\n\n\t/**\n\t * extracts properties\n\t *\n\t * @protected\n\t */\n\t_extractProperties() {\n\t\tthis._extractPropertyAndPutResultIntoVariable(['name', 'x-wr-calname'], '_name')\n\t\tthis._extractPropertyAndPutResultIntoVariable(['color', 'x-apple-calendar-color'], '_color')\n\t\tthis._extractPropertyAndPutResultIntoVariable(['source'], '_sourceURL')\n\t\tthis._extractPropertyAndPutResultIntoVariable(['refresh-interval', 'x-published-ttl'], '_refreshInterval')\n\t\tthis._extractPropertyAndPutResultIntoVariable(['x-wr-timezone'], '_calendarTimezone')\n\t}\n\n\t/**\n\t * Extract a property and writes it into a class property\n\t * names must be an array, it will use the value of the fist\n\t * propertyname it can find\n\t *\n\t * @param {string[]} names The names of the properties to check\n\t * @param {string} variableName The variable name to save it under\n\t * @private\n\t */\n\t_extractPropertyAndPutResultIntoVariable(names, variableName) {\n\t\tfor (const name of names) {\n\t\t\tif (this._calendarComponent.hasProperty(name)) {\n\t\t\t\tthis[variableName] = this._calendarComponent.getFirstPropertyFirstValue(name)\n\t\t\t\treturn\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Extracts timezones from the calendar component\n\t *\n\t * @protected\n\t */\n\t_extractTimezones() {\n\t\tconst matches = this._rawData.match(/^BEGIN:VTIMEZONE$(((?!^END:VTIMEZONE$)(.|\\n))*)^END:VTIMEZONE$\\n/gm)\n\n\t\tif (!matches) {\n\t\t\treturn\n\t\t}\n\n\t\tfor (const match of matches) {\n\t\t\tconst tzidMatcher = match.match(/^TZID:(.*)$/gm)\n\t\t\tif (!tzidMatcher) {\n\t\t\t\tcontinue\n\t\t\t}\n\n\t\t\tconst tzid = tzidMatcher[0].slice(5)\n\t\t\tconst timezone = new Timezone(tzid, match)\n\t\t\tthis._timezones.set(tzid, timezone)\n\t\t}\n\t}\n\n\t/**\n\t * Registers unknown timezones into our timezone-manager\n\t *\n\t * @protected\n\t */\n\t_registerTimezones() {\n\t\tfor (const [tzid, timezone] of this._timezones) {\n\t\t\tif (!this._defaultTimezoneManager.hasTimezoneForId(tzid)) {\n\t\t\t\tthis._defaultTimezoneManager.registerTimezone(timezone)\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Processes the parsed vobjects\n\t *\n\t * @protected\n\t */\n\t_processVObjects() {\n\t\tfor (const vObject of this._calendarComponent.getVObjectIterator()) {\n\t\t\tthis._addItem(vObject)\n\t\t\tthis._markCompTypeAsSeen(vObject.name)\n\t\t\tif (vObject.isRecurrenceException()) {\n\t\t\t\tthis._addRecurrenceException(vObject)\n\t\t\t} else {\n\t\t\t\tvObject.recurrenceManager = new RecurrenceManager(vObject)\n\t\t\t\tthis._masterItems.set(vObject.uid, vObject)\n\t\t\t}\n\n\t\t\tfor (const propertyToCheck of vObject.getPropertyIterator()) {\n\t\t\t\tfor (const value of propertyToCheck.getValueIterator()) {\n\t\t\t\t\tif (value instanceof DateTimeValue && value.timezoneId) {\n\t\t\t\t\t\tthis._addRequiredTimezone(vObject.uid, value.timezoneId)\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// TRIGGER is supposed to be stored in UTC only,\n\t\t\t// but not all clients stick to this\n\t\t\tfor (const alarm of vObject.getAlarmIterator()) {\n\t\t\t\tfor (const propertyToCheck of alarm.getPropertyIterator()) {\n\t\t\t\t\tfor (const value of propertyToCheck.getValueIterator()) {\n\t\t\t\t\t\tif (value instanceof DateTimeValue && value.timezoneId) {\n\t\t\t\t\t\t\tthis._addRequiredTimezone(vObject.uid, value.timezoneId)\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (this._getOption('removeRSVPForAttendees', false)) {\n\t\t\t\tfor (const attendee of vObject.getAttendeeIterator()) {\n\t\t\t\t\tattendee.deleteParameter('RSVP')\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfor (const recurrenceExceptionList of this._recurrenceExceptionItems.values()) {\n\t\t\tfor (const recurrenceException of recurrenceExceptionList) {\n\n\t\t\t\t// Check if there is a master item for this recurrence exception\n\t\t\t\t// otherwise we have to forge one\n\t\t\t\tif (!this._masterItems.has(recurrenceException.uid)) {\n\t\t\t\t\tconst constructor = getConstructorForComponentName(recurrenceException.name)\n\t\t\t\t\tconst forgedMaster = new constructor(recurrenceException.name, [\n\t\t\t\t\t\t['UID', recurrenceException.uid],\n\t\t\t\t\t\t['DTSTAMP', recurrenceException.stampTime.clone()],\n\t\t\t\t\t\t['DTSTART', recurrenceException.recurrenceId.clone()],\n\t\t\t\t\t])\n\n\t\t\t\t\tforgedMaster.recurrenceManager = new RecurrenceManager(forgedMaster)\n\n\t\t\t\t\tthis._forgedMasterItems.set(recurrenceException.uid, forgedMaster)\n\t\t\t\t\tthis._masterItems.set(recurrenceException.uid, forgedMaster)\n\t\t\t\t\tthis._addItem(forgedMaster)\n\t\t\t\t} else {\n\t\t\t\t\tconst master = this._masterItems.get(recurrenceException.uid)\n\n\t\t\t\t\t// This should usually not be the case,\n\t\t\t\t\t// only if the calendar-data is seriously broken.\n\t\t\t\t\t// Let's try to handle it anyway by adding it to\n\t\t\t\t\t// forgedMasterItems, we will simply add RDATEs\n\t\t\t\t\t// in the next step to make it recur\n\t\t\t\t\tif (!master.isRecurring()) {\n\t\t\t\t\t\tthis._forgedMasterItems.set(master.uid, master)\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (this._forgedMasterItems.has(recurrenceException.uid)) {\n\t\t\t\t\tconst forgedMaster = this._forgedMasterItems.get(recurrenceException.uid)\n\t\t\t\t\tforgedMaster.recurrenceManager.addRecurrenceDate(false, recurrenceException.recurrenceId.clone())\n\t\t\t\t}\n\n\t\t\t\tconst masterItem = this._masterItems.get(recurrenceException.uid)\n\t\t\t\tmasterItem.recurrenceManager.relateRecurrenceException(recurrenceException)\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Process FreeBusy components\n\t *\n\t * @private\n\t */\n\t_processVFreeBusy() {\n\t\tfor (const vObject of this._calendarComponent.getFreebusyIterator()) {\n\t\t\tthis._addItem(vObject)\n\t\t\tthis._markCompTypeAsSeen(vObject.name)\n\n\t\t\tfor (const propertyToCheck of vObject.getPropertyIterator()) {\n\t\t\t\tfor (const value of propertyToCheck.getValueIterator()) {\n\t\t\t\t\tif (value instanceof DateTimeValue && value.timezoneId) {\n\t\t\t\t\t\tthis._addRequiredTimezone(vObject.uid, value.timezoneId)\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t *\n\t * @param {AbstractRecurringComponent} item The recurrence-item to register\n\t * @private\n\t */\n\t_addRecurrenceException(item) {\n\t\tif (this._recurrenceExceptionItems.has(item.uid)) {\n\t\t\tconst arr = this._recurrenceExceptionItems.get(item.uid)\n\t\t\tarr.push(item)\n\t\t} else {\n\t\t\tthis._recurrenceExceptionItems.set(item.uid, [item])\n\t\t}\n\t}\n\n\t/**\n\t *\n\t * @param {AbstractRecurringComponent} item The item to register\n\t * @private\n\t */\n\t_addItem(item) {\n\t\tif (this._items.has(item.uid)) {\n\t\t\tconst arr = this._items.get(item.uid)\n\t\t\tarr.push(item)\n\t\t} else {\n\t\t\tthis._items.set(item.uid, [item])\n\t\t}\n\t}\n\n\t/**\n\t *\n\t * @param {string} uid The uid of the calendar-object\n\t * @param {string} timezoneId The timezoneId required by the object\n\t * @private\n\t */\n\t_addRequiredTimezone(uid, timezoneId) {\n\t\tif (timezoneId === 'UTC' || timezoneId === 'floating' || timezoneId === 'GMT' || timezoneId === 'Z') {\n\t\t\treturn\n\t\t}\n\n\t\tif (this._requiredTimezones.has(uid)) {\n\t\t\tthis._requiredTimezones.get(uid).add(timezoneId)\n\t\t} else {\n\t\t\tconst set = new Set([timezoneId])\n\t\t\tthis._requiredTimezones.set(uid, set)\n\t\t}\n\t}\n\n\t/**\n\t *\n\t * @param {CalendarComponent} calendarComp The calendar-component to add timezones to\n\t * @param {string} uid The UID of the calendar-object\n\t * @private\n\t */\n\t_addRequiredTimezonesToCalendarComp(calendarComp, uid) {\n\t\tif (!this._requiredTimezones.has(uid)) {\n\t\t\treturn\n\t\t}\n\n\t\tfor (const requiredTimezone of this._requiredTimezones.get(uid)) {\n\t\t\tif (!this._defaultTimezoneManager.hasTimezoneForId(requiredTimezone)) {\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\tconst timezone = this._defaultTimezoneManager.getTimezoneForId(requiredTimezone)\n\t\t\t// Is this an alias?\n\t\t\tif (timezone.timezoneId !== requiredTimezone) {\n\t\t\t\tthis._replaceTimezoneWithAnotherOne(calendarComp, requiredTimezone, timezone.timezoneId)\n\t\t\t}\n\n\t\t\tconst timezoneComponent = TimezoneComponent.fromICALJs(timezone.toICALJs())\n\t\t\tcalendarComp.addComponent(timezoneComponent)\n\t\t}\n\t}\n\n\t/**\n\t * Replaces all occurrences of searchTimezone with replaceTimezone\n\t *\n\t * @param {CalendarComponent} calendarComponent The calendar-component to replace a timezone in\n\t * @param {string} searchTimezone The timezone to replace\n\t * @param {string} replaceTimezone The replacement timezone\n\t * @private\n\t */\n\t_replaceTimezoneWithAnotherOne(calendarComponent, searchTimezone, replaceTimezone) {\n\t\tfor (const vObject of this._calendarComponent.getVObjectIterator()) {\n\t\t\tfor (const propertyToCheck of vObject.getPropertyIterator()) {\n\t\t\t\tfor (const value of propertyToCheck.getValueIterator()) {\n\t\t\t\t\tif (!(value instanceof DateTimeValue)) {\n\t\t\t\t\t\tcontinue\n\t\t\t\t\t}\n\n\t\t\t\t\tif (value.timezoneId === searchTimezone) {\n\t\t\t\t\t\tvalue.silentlyReplaceTimezone(replaceTimezone)\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// TRIGGER is supposed to be stored in UTC only,\n\t\t\t// but not all clients stick to this\n\t\t\tfor (const alarm of vObject.getAlarmIterator()) {\n\t\t\t\tfor (const propertyToCheck of alarm.getPropertyIterator()) {\n\t\t\t\t\tfor (const value of propertyToCheck.getValueIterator()) {\n\t\t\t\t\t\tif (!(value instanceof DateTimeValue)) {\n\t\t\t\t\t\t\tcontinue\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (value.timezoneId === searchTimezone) {\n\t\t\t\t\t\t\tvalue.silentlyReplaceTimezone(replaceTimezone)\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Marks a certain component type as seen.\n\t * This is used for\n\t * containsVEvents()\n\t * containsVJournals()\n\t * containsVTodos()\n\t *\n\t * @param {string} compName The name of the visited component\n\t * @private\n\t */\n\t_markCompTypeAsSeen(compName) {\n\t\tswitch (uc(compName)) {\n\t\tcase 'VEVENT':\n\t\t\tthis._containsVEvents = true\n\t\t\tbreak\n\n\t\tcase 'VJOURNAL':\n\t\t\tthis._containsVJournals = true\n\t\t\tbreak\n\n\t\tcase 'VTODO':\n\t\t\tthis._containsVTodos = true\n\t\t\tbreak\n\n\t\tcase 'VFREEBUSY':\n\t\t\tthis._containsVFreeBusy = true\n\t\t\tbreak\n\t\t}\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tstatic getMimeTypes() {\n\t\treturn ['text/calendar']\n\t}\n\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport ICalendarParser from './icalendarParser.js'\n\n/**\n * @class ParserManager\n * @classdesc\n */\nexport default class ParserManager {\n\n\t/**\n\t * Constructor\n\t */\n\tconstructor() {\n\n\t\t/**\n\t\t * List of supported parsers\n\t\t *\n\t\t * @type {Function[]}\n\t\t */\n\t\tthis._parsers = []\n\t}\n\n\t/**\n\t * Get a list of all supported file-types\n\t *\n\t * @return {string[]}\n\t */\n\tgetAllSupportedFileTypes() {\n\t\treturn this._parsers.reduce(\n\t\t\t(allFileTypes, parser) => allFileTypes.concat(parser.getMimeTypes()),\n\t\t\t[])\n\t}\n\n\t/**\n\t * Get an instance of a parser for one specific file-type\n\t *\n\t * @param {string} fileType The mime-type to get a parser for\n\t * @param {object=} options Options destructuring object\n\t * @param {boolean=} options.extractGlobalProperties Whether or not to preserve properties from the VCALENDAR component (defaults to false)\n\t * @param {boolean=} options.removeRSVPForAttendees Whether or not to remove RSVP from attendees (defaults to false)\n\t * @param {boolean=} options.includeTimezones Whether or not to include timezones (defaults to false)\n\t * @param {boolean=} options.preserveMethod Whether or not to preserve the iCalendar method (defaults to false)\n\t * @param {boolean=} options.processFreeBusy Whether or not to process VFreeBusy components (defaults to false)\n\t *\n\t * @return {AbstractParser}\n\t */\n\tgetParserForFileType(fileType, options) {\n\t\tconst Parser = this._parsers.find(\n\t\t\t(parser) => parser.getMimeTypes().includes(fileType))\n\n\t\tif (!Parser) {\n\t\t\tthrow new TypeError('Unknown file-type.')\n\t\t}\n\n\t\treturn new Parser(options)\n\t}\n\n\t/**\n\t * Registers a parser\n\t *\n\t * @param {Function} parser The parser to register\n\t */\n\tregisterParser(parser) {\n\t\tthis._parsers.push(parser)\n\t}\n\n}\n\n/**\n * Gets an instance of the ParserManager with all default parsers\n *\n * @return {ParserManager}\n */\nexport function getParserManager() {\n\tconst parserManager = new ParserManager()\n\n\t// We only support iCalendar for now.\n\t// JSON calendar and CSV will be supported soon,\n\t// but require some more work\n\n\tparserManager.registerParser(ICalendarParser)\n\t// parserManager.registerParser(JCalendarParser)\n\t// parserManager.registerParser(CSVParser)\n\n\treturn parserManager\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\n/**\n * @class TimezoneAdapter\n * @classdesc Connecting ICAL.TimezoneService with our TimezoneManager\n */\nexport default class TimezoneAdapter {\n\n\t/**\n\t * Constructor\n\t *\n\t * @param {TimezoneManager} timezoneManager The timezone-manager to wrap\n\t */\n\tconstructor(timezoneManager) {\n\n\t\t/**\n\t\t * TimezoneManager object\n\t\t *\n\t\t * @type {TimezoneManager}\n\t\t * @private\n\t\t */\n\t\tthis._timezoneManager = timezoneManager\n\t}\n\n\t/**\n\t * @param {string} timezoneId The id of the timezone\n\t * @return {boolean}\n\t */\n\thas(timezoneId) {\n\t\treturn this._timezoneManager.hasTimezoneForId(timezoneId)\n\t}\n\n\t/**\n\t * @param {string} timezoneId The id of the timezone\n\t * @return {ICAL.Timezone|undefined}\n\t */\n\tget(timezoneId) {\n\t\tconst timezone = this._timezoneManager.getTimezoneForId(timezoneId)\n\t\tif (!timezone) {\n\t\t\treturn undefined\n\t\t}\n\n\t\treturn timezone.toICALTimezone()\n\t}\n\n\t/**\n\t * @throws TypeError\n\t */\n\tregister() {\n\t\tthrow new TypeError('Not allowed to register new timezone')\n\t}\n\n\t/**\n\t * @throws TypeError\n\t */\n\tremove() {\n\t\tthrow new TypeError('Not allowed to remove timezone')\n\t}\n\n\t/**\n\t * @throws TypeError\n\t */\n\treset() {\n\t\tthrow new TypeError('Not allowed to reset TimezoneService')\n\t}\n\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nexport default class IllegalValueError extends Error {}\n","/**\n * @copyright Copyright (c) 2021 Christoph Wurst\n *\n * @author Christoph Wurst <christoph@winzerhof-wurst.at>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\n/**\n *\n * @param {string[]} timezoneList List of Olsen timezones\n * @param {Array} additionalTimezones List of additional timezones\n * @param {string} globalTimezoneName The localized name of the \"Global\" timezones\n * @return {[]}\n */\nexport function getSortedTimezoneList(timezoneList = [], additionalTimezones = [], globalTimezoneName = 'Global') {\n\tconst sortedByContinent = {}\n\tconst sortedList = []\n\n\tfor (const timezoneId of timezoneList) {\n\t\tconst components = timezoneId.split('/')\n\t\tlet [continent, name] = [components.shift(), components.join('/')]\n\t\tif (!name) {\n\t\t\tname = continent\n\t\t\tcontinent = globalTimezoneName\n\t\t}\n\n\t\tsortedByContinent[continent] = sortedByContinent[continent] || {\n\t\t\tcontinent,\n\t\t\tregions: [],\n\t\t}\n\n\t\tsortedByContinent[continent].regions.push({\n\t\t\tlabel: getReadableTimezoneName(name),\n\t\t\tcities: [],\n\t\t\ttimezoneId,\n\t\t})\n\t}\n\n\tfor (const additionalTimezone of additionalTimezones) {\n\t\tconst { continent, label, timezoneId } = additionalTimezone\n\n\t\tsortedByContinent[continent] = sortedByContinent[continent] || {\n\t\t\tcontinent,\n\t\t\tregions: [],\n\t\t}\n\n\t\tsortedByContinent[continent].regions.push({\n\t\t\tlabel,\n\t\t\tcities: [],\n\t\t\ttimezoneId,\n\t\t})\n\t}\n\n\tfor (const continent in sortedByContinent) {\n\t\tif (!Object.prototype.hasOwnProperty.call(sortedByContinent, continent)) {\n\t\t\tcontinue\n\t\t}\n\n\t\tsortedByContinent[continent].regions.sort((a, b) => {\n\t\t\tif (a.label < b.label) {\n\t\t\t\treturn -1\n\t\t\t}\n\n\t\t\treturn 1\n\t\t})\n\t\tsortedList.push(sortedByContinent[continent])\n\t}\n\n\t// Sort continents by name\n\tsortedList.sort((a, b) => {\n\t\tif (a.continent < b.continent) {\n\t\t\treturn -1\n\t\t}\n\n\t\treturn 1\n\t})\n\n\treturn sortedList\n}\n\n/**\n * Get human-readable name for timezoneId\n *\n * @param {string} timezoneId TimezoneId to turn human-readable\n * @return {string}\n */\nexport function getReadableTimezoneName(timezoneId) {\n\treturn timezoneId\n\t\t.split('_')\n\t\t.join(' ')\n\t\t.replace('St ', 'St. ')\n\t\t.split('/')\n\t\t.join(' - ')\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @author Richard Steinmetz <richard@steinmetz.cloud>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport { getParserManager } from './parsers/parserManager.js'\nimport TimezoneAdapter from './timezones/timezoneAdapter.js'\nimport { getTimezoneManager } from './timezones/timezoneManager.js'\nimport { v4 as uuid } from 'uuid'\nimport DateTimeValue from './values/dateTimeValue.js'\nimport { dateFactory } from './factories/dateFactory.js'\nimport CalendarComponent from './components/calendarComponent.js'\nimport EventComponent from './components/root/eventComponent.js'\nimport RecurrenceManager from './recurrence/recurrenceManager.js'\nimport FreeBusyComponent from './components/root/freeBusyComponent.js'\nimport ICAL from 'ical.js'\n\nif (!(ICAL.TimezoneService instanceof TimezoneAdapter)) {\n\tICAL.TimezoneService = new TimezoneAdapter(getTimezoneManager())\n}\n\n/**\n * parses a single ICS and returns an iterator over all occurrences\n * in a given timeframe\n *\n * @param {string} ics The calendar-data to parse\n * @param {DateTimeValue} start The start of the queried time-range\n * @param {DateTimeValue} end The end of the queried time-range\n */\nexport function * parseICSAndGetAllOccurrencesBetween(ics, start, end) {\n\tconst parserManager = getParserManager()\n\tconst icsParser = parserManager.getParserForFileType('text/calendar')\n\ticsParser.parse(ics)\n\n\tconst objectIterator = icsParser.getItemIterator()\n\tconst calendarComp = objectIterator.next().value\n\tif (calendarComp === undefined) {\n\t\treturn\n\t}\n\n\tconst vObjectIterator = calendarComp.getVObjectIterator()\n\tconst firstVObject = vObjectIterator.next().value\n\tif (firstVObject === undefined) {\n\t\treturn\n\t}\n\n\tyield * firstVObject.recurrenceManager.getAllOccurrencesBetweenIterator(start, end)\n}\n\n/**\n * Creates a new event\n *\n * @param {DateTimeValue} start Start-time of the new event\n * @param {DateTimeValue} end End-time of the new event\n * @return {CalendarComponent}\n */\nexport function createEvent(start, end) {\n\tconst calendar = CalendarComponent.fromEmpty()\n\tconst eventComponent = new EventComponent('VEVENT')\n\n\teventComponent.updatePropertyWithValue('CREATED', DateTimeValue.fromJSDate(dateFactory(), true))\n\teventComponent.updatePropertyWithValue('DTSTAMP', DateTimeValue.fromJSDate(dateFactory(), true))\n\teventComponent.updatePropertyWithValue('LAST-MODIFIED', DateTimeValue.fromJSDate(dateFactory(), true))\n\teventComponent.updatePropertyWithValue('SEQUENCE', 0)\n\teventComponent.updatePropertyWithValue('UID', uuid())\n\teventComponent.updatePropertyWithValue('DTSTART', start)\n\teventComponent.updatePropertyWithValue('DTEND', end)\n\n\tcalendar.addComponent(eventComponent)\n\teventComponent.recurrenceManager = new RecurrenceManager(eventComponent)\n\n\treturn calendar\n}\n\n/**\n * Creates a FreeBusy Request to be used on the scheduling outbox\n *\n * @param {DateTimeValue} start The start of the queried time-range\n * @param {DateTimeValue} end The end of the queried time-range\n * @param {AttendeeProperty} organizer The organizer querying information\n * @param {AttendeeProperty[]}attendees The list of attendees to query information for\n * @return {CalendarComponent}\n */\nexport function createFreeBusyRequest(start, end, organizer, attendees) {\n\tconst calendar = CalendarComponent.fromMethod('REQUEST')\n\tconst freeBusyComponent = new FreeBusyComponent('VFREEBUSY')\n\n\tfreeBusyComponent.updatePropertyWithValue('DTSTAMP', DateTimeValue.fromJSDate(dateFactory(), true))\n\tfreeBusyComponent.updatePropertyWithValue('UID', uuid())\n\tfreeBusyComponent.updatePropertyWithValue('DTSTART', start.clone().getInUTC())\n\tfreeBusyComponent.updatePropertyWithValue('DTEND', end.clone().getInUTC())\n\tfreeBusyComponent.addProperty(organizer.clone())\n\n\tfor (const attendee of attendees) {\n\t\tconst clonedAttendee = attendee.clone()\n\t\tclonedAttendee.deleteParameter('ROLE')\n\t\tclonedAttendee.deleteParameter('CUTYPE')\n\t\tclonedAttendee.deleteParameter('RSVP')\n\t\tclonedAttendee.deleteParameter('PARTSTAT')\n\t\tclonedAttendee.deleteParameter('REQUEST-STATUS')\n\t\tclonedAttendee.deleteParameter('LANGUAGE')\n\n\t\tfreeBusyComponent.addProperty(clonedAttendee)\n\t}\n\n\tcalendar.addComponent(freeBusyComponent)\n\treturn calendar\n}\n\nexport { setConfig } from './config.js'\nexport { getParserManager }\nexport { getTimezoneManager, isOlsonTimezone } from './timezones/timezoneManager.js'\nexport * from './components/index.js'\nexport * from './errors/index.js'\nexport * from './parameters/index.js'\nexport * from './parsers/index.js'\nexport * from './properties/index.js'\nexport * from './recurrence/index.js'\nexport * from './timezones/index.js'\nexport * from './values/index.js'\n"],"names":["AbstractParser","constructor","options","new","target","TypeError","_options","Object","assign","_name","_color","_sourceURL","_refreshInterval","_calendarTimezone","_errors","getName","getColor","offersWebcalFeed","getSourceURL","getRefreshInterval","getCalendarTimezone","parse","data","getItemIterator","getAllItems","Array","from","containsVEvents","containsVJournals","containsVTodos","containsVFreeBusy","hasErrors","length","getErrorList","slice","getItemCount","_getOption","name","defaultValue","prototype","hasOwnProperty","call","getMimeTypes","ModificationNotAllowedError","Error","lockableTrait","baseClass","args","_mutable","isLocked","lock","unlock","_modify","_modifyContent","ExpectedICalJSError","lc","str","toLowerCase","uc","toUpperCase","ucFirst","charAt","startStringWith","startWith","startsWith","GLOBAL_CONFIG","Map","setConfig","key","value","set","getConfig","get","createComponent","componentName","ICAL","Component","createProperty","propertyName","Property","observerTrait","_subscribers","subscribe","handler","push","unsubscribe","index","indexOf","splice","_notifySubscribers","Parameter","_value","getFirstValue","isMultiValue","getValueIterator","Symbol","iterator","isArray","clone","parameter","AbstractValue","icalValue","_innerValue","toICALJs","BinaryValue","rawValue","decodeValue","decodedValue","setEncodedValue","fromRawValue","fromICALJs","icalBinary","Binary","fromDecodedValue","DurationValue","weeks","days","hours","minutes","seconds","isNegative","totalSeconds","toSeconds","fromSeconds","compare","otherDuration","addDuration","normalize","subtractDuration","icalDuration","Duration","fromData","DateTimeValue","year","month","day","hour","minute","second","timezoneId","zone","tzid","timezone","isDate","unixTime","toUnixTime","jsDate","toJSDate","duration","subtractDateWithoutTimezone","other","subtractDate","subtractDateWithTimezone","subtractDateTz","compareDateOnlyInGivenTimezone","compareDateOnlyTz","toICALTimezone","getInTimezone","clonedICALTime","convertToZone","getICALTimezone","getInICALTimezone","getInUTC","Timezone","utcTimezone","silentlyReplaceTimezone","Time","replaceTimezone","utcOffset","isFloatingTime","fromJSDate","useUTC","undefined","SUNDAY","MONDAY","TUESDAY","WEDNESDAY","THURSDAY","FRIDAY","SATURDAY","DEFAULT_WEEK_START","PeriodValue","_start","start","_end","_duration","end","getEnd","getDuration","fromDataWithEnd","icalPeriod","Period","fromDataWithDuration","ALLOWED_FREQ","RecurValue","until","_until","interval","parseInt","weekStart","wkst","count","frequency","freq","includes","setToInfinite","isFinite","isByCount","addComponent","setComponent","parts","removeComponent","getComponent","isRuleValid","icalRecur","Recur","UTCOffsetValue","factor","icalUTCOffset","UtcOffset","UnknownICALTypeError","getConstructorForICALType","icaltype","parameters","root","parent","_parameters","_root","_parent","_setParametersFromConstructor","addValue","hasValue","removeValue","setParameter","getParameter","parameterName","getParametersIterator","values","getParameterFirstValue","hasParameter","has","deleteParameter","delete","updateParameterIfExist","isDecoratedValue","_cloneValue","map","val","forEach","icalProperty","isDecorated","getValues","paramNames","keys","toJSON","paramName","setValues","setValue","firstValue","AttachmentProperty","formatType","fmtType","uri","encoding","binaryValue","property","fromLink","AttendeeProperty","role","allowed","userType","rsvp","commonName","participationStatus","vobjectType","VEVENT","VJOURNAL","VTODO","language","email","member","members","isOrganizer","fromNameAndEMail","fromNameEMailRoleUserTypeAndRSVP","design","icalendar","conference","defaultType","param","feature","valueType","multiValue","ConferenceProperty","getFeatureIterator","listAllFeatures","addFeature","featureToAdd","hasFeature","removeFeature","clearAllFeatures","label","fromURILabelAndFeatures","features","FreeBusyProperty","type","fromPeriodAndType","period","GeoProperty","latitude","lat","parseFloat","longitude","long","fromPosition","ImageProperty","display","RelationProperty","relationType","relatedId","fromRelTypeAndId","relType","relId","RequestStatusProperty","statusCode","toString","Math","floor","statusMessage","exceptionData","isPending","isSuccessful","isClientError","isSchedulingError","fromCodeAndMessage","code","message","SUCCESS","SUCCESS_FALLBACK","SUCCESS_PROP_IGNORED","SUCCESS_PROPPARAM_IGNORED","SUCCESS_NONSTANDARD_PROP_IGNORED","SUCCESS_NONSTANDARD_PROPPARAM_IGNORED","SUCCESS_COMP_IGNORED","SUCCESS_FORWARDED","SUCCESS_REPEATING_IGNORED","SUCCESS_TRUNCATED_END","SUCCESS_REPEATING_VTODO_IGNORED","SUCCESS_UNBOUND_RRULE_CLIPPED","CLIENT_INVALID_PROPNAME","CLIENT_INVALID_PROPVALUE","CLIENT_INVALID_PROPPARAM","CLIENT_INVALID_PROPPARAMVALUE","CLIENT_INVALUD_CALENDAR_COMP_SEQ","CLIENT_INVALID_DATE_TIME","CLIENT_INVALID_RRULE","CLIENT_INVALID_CU","CLIENT_NO_AUTHORITY","CLIENT_UNSUPPORTED_VERSION","CLIENT_TOO_LARGE","CLIENT_REQUIRED_COMP_OR_PROP_MISSING","CLIENT_UNKNOWN_COMP_OR_PROP","CLIENT_UNSUPPORTED_COMP_OR_PROP","CLIENT_UNSUPPORTED_CAPABILITY","SCHEDULING_EVENT_CONFLICT","SERVER_REQUEST_NOT_SUPPORTED","SERVER_SERVICE_UNAVAILABLE","SERVER_INVALID_CALENDAR_SERVICE","SERVER_NO_SCHEDULING_FOR_USER","TextProperty","alternateText","altRep","TriggerProperty","related","isRelative","fromAbsolute","alarmTime","fromRelativeAndRelated","alarmOffset","relatedToStart","getConstructorForPropertyName","propName","AbstractComponent","properties","components","_properties","_components","_setPropertiesFromConstructor","_setComponentsFromConstructor","getPropertyIterator","component","getComponentIterator","getFirstProperty","getFirstPropertyFirstValue","updatePropertyWithValue","newProperty","addProperty","hasProperty","_getAllOfPropertyByLang","lang","_getFirstOfPropertyByLang","next","arr","deleteProperty","deleteAllProperties","getFirstComponent","hasComponent","deleteComponent","deleteAllComponents","newComponent","icalProp","getAllProperties","icalComp","getAllSubcomponents","_getConstructorForComponentName","prop","comp","addSubcomponent","advertiseSingleOccurrenceProperty","advertiseValueOnly","getDefaultOncePropConfig","defineProperty","iCalendarName","allowedValues","unknownValue","advertiseMultipleOccurrenceProperty","getDefaultMultiplePropConfig","pluralName","advertiseMultiValueStringPropertySeparatedByLang","languageParameter","advertiseComponent","getDefaultMultipleCompConfig","dateFactory","Date","RecurringWithoutDtStartError","RecurrenceManager","masterItem","_masterItem","_recurrenceExceptionItems","_rangeRecurrenceExceptionItemsIndex","_rangeRecurrenceExceptionItemsDiffCache","_rangeRecurrenceExceptionItems","getRecurrenceExceptionIterator","getRecurrenceExceptionList","hasRecurrenceExceptionForId","recurrenceId","getRecurrenceException","hasRangeRecurrenceExceptionForId","getRangeRecurrenceExceptionForId","helpers","binsearchInsert","a","b","getRangeRecurrenceExceptionDiff","recurrenceException","originalRecurrenceId","originalModifiedStart","startDate","difference","relateRecurrenceException","recurrenceExceptionItem","_getRecurrenceIdKey","modifiesFuture","recurrenceManager","removeRecurrenceException","removeRecurrenceExceptionByRecurrenceId","getRecurrenceRuleIterator","getRecurrenceRuleList","addRecurrenceRule","recurrenceRule","resetCache","removeRecurrenceRule","clearAllRecurrenceRules","getRecurrenceDateIterator","_getPropertiesForRecurrenceDate","listAllRecurrenceDates","addRecurrenceDate","_getValueTypeByValue","first","propertyValue","markPropertyAsDirty","_getPropertyNameByIsNegative","hasRecurrenceDate","getRecurrenceDate","valueToCheck","removeRecurrenceDate","allValues","clearAllRecurrenceDates","every","rule","isEmptyRecurrenceSet","_getRecurExpansionObject","getOccurrenceAtExactly","isRecurring","getReferenceRecurrenceId","icalRecurrenceId","_getOccurrenceAtRecurrenceId","getClosestOccurrence","previous","dateTimeValue","countAllOccurrencesBetween","queriedTimeRangeStart","queriedTimeRangeEnd","isInTimeFrame","queriedICALJsTimeRangeStart","queriedICALJsTimeRangeEnd","getAllOccurrencesBetweenIterator","recurrenceIdKeys","maximumRecurrenceId","max","apply","occurrence","compareDate","endDate","isRecurrenceException","size","getAllOccurrencesBetween","updateUID","newUID","updateStartDateOfMasterItem","newStartDate","oldStartDate","exdate","rrule","canCreateRecurrenceExceptions","forkItem","rangeRecurrenceException","dtstart","last","ruleIterators","ruleDateInc","ruleDates","ruleDate","exDates","complete","ruleValue","rDateValue","exDateValue","exDateInc","exDate","RecurExpansion","ics","_timezoneId","_ics","_initialized","offsetForArray","_initialize","time","timestampToArray","ms","fromUnixTime","local","jCal","utc","floating","localTimezone","AlarmComponent","addAttendeeFromNameAndEMail","attendeeProperty","trigger","setTriggerFromAbsolute","triggerProperty","setTriggerFromRelative","getConstructorForComponentName","compName","AbstractRecurringComponent","_primaryItem","_isExactForkOfPrimary","_originalRecurrenceId","_recurrenceManager","_dirty","_significantChange","_cachedId","primaryItem","isExactForkOfPrimary","isMasterItem","id","encodeURIComponent","uid","join","isPartOfRecurrenceSet","startDiff","originalTimezone","dtStartValue","recurrenceDate","dtEndValue","dueValue","dtEnd","due","resetDirty","primaryIsRecurring","createRecurrenceException","thisAndAllFuture","previousPrimaryItem","_overridePrimaryItem","removeThisOccurrence","uuid","addRelation","fromEmpty","attendee","getAttendeeIterator","recurDate","valueDateTimeRecurDate","recurValue","exceptionDate","exception","_addAttendee","addAttendeeFromNameEMailRoleUserTypeAndRSVP","setOrganizerFromNameAndEMail","addAttachmentFromData","addAttachmentFromLink","addContact","contact","addComment","comment","addImageFromData","addImageFromLink","addRequestStatus","addAbsoluteAlarm","action","alarmComp","addRelativeAlarm","markDirty","props","markChangesAsSignificant","markSubComponentAsDirty","isDirty","undirtify","sequence","getTypeOfBirthdayEvent","eventComponent","getIconForBirthday","birthdayType","getAgeOfBirthday","yearOfOccurrence","yearOfBirth","EventComponent","isAllDay","canModifyAllDay","dtend","setGeographicalPositionFromLatitudeAndLongitude","addConference","addDurationToStart","addDurationToEnd","shiftByDuration","delta","allDay","defaultTimezone","defaultAllDayDuration","defaultTimedDuration","currentAllDay","isBirthdayEvent","getIconForBirthdayEvent","getAgeForBirthdayEvent","toICSEntireSeries","toICS","toICSThisOccurrence","FreeBusyComponent","getFreeBusyIterator","JournalComponent","addDescription","description","TimezoneComponent","toTimezone","ToDoComponent","propertiesToCheck","propertyToCheck","dueTime","geographicalPosition","CalendarComponent","getTimezoneIterator","getVObjectIterator","getEventIterator","getJournalIterator","getTodoIterator","getFreebusyIterator","cleanUpTimezones","vObject","icalRoot","updateTimezones","additionalProps","concat","fromMethod","method","AbstractRepairStep","repair","input","priority","ICalendarAddMissingUIDRepairStep","replace","match","vobjectName","vObjectBlock","ICalendarAddMissingValueDateDoubleColonRepairStep","date","ICalendarAddMissingValueDateRepairStep","_","ICalendarEmptyTriggerRepairStep","ICalendarIllegalCreatedRepairStep","ICalendarMultipleVCalendarBlocksRepairStep","containsProdId","containsVersion","containsCalscale","includedTimezones","Set","tzidMatcher","add","ICalendarRemoveXNCGroupIdRepairStep","getRepairSteps","TimezoneManager","_aliases","_timezones","getTimezoneForId","_getTimezoneForIdRec","level","console","error","resolvedTimezoneId","hasTimezoneForId","isAlias","listAllTimezones","includeAliases","timezones","registerTimezone","registerDefaultTimezones","debug","tzData","version","zones","registerTimezoneFromICS","aliases","registerAlias","aliasTo","aliasName","unregisterTimezones","unregisterAlias","clearAllTimezones","timezoneManager","getTimezoneManager","isOlsonTimezone","tzName","hasSlash","hasSpace","startsWithETC","startsWithUS","ICalendarParser","_rawData","_calendarComponent","_containsVEvents","_containsVJournals","_containsVTodos","_containsVFreeBusy","_items","_masterItems","_forgedMasterItems","_requiredTimezones","_defaultTimezoneManager","_applyRepairSteps","_extractTimezones","_registerTimezones","_createCalendarComponent","_extractProperties","_processVObjects","_processVFreeBusy","itemList","calendarComp","_addRequiredTimezonesToCalendarComp","item","RepairStep","step","_extractPropertyAndPutResultIntoVariable","names","variableName","matches","_addItem","_markCompTypeAsSeen","_addRecurrenceException","_addRequiredTimezone","alarm","getAlarmIterator","recurrenceExceptionList","forgedMaster","stampTime","master","requiredTimezone","_replaceTimezoneWithAnotherOne","timezoneComponent","calendarComponent","searchTimezone","ParserManager","_parsers","getAllSupportedFileTypes","reduce","allFileTypes","parser","getParserForFileType","fileType","Parser","find","registerParser","getParserManager","parserManager","TimezoneAdapter","_timezoneManager","register","remove","reset","IllegalValueError","getSortedTimezoneList","timezoneList","additionalTimezones","globalTimezoneName","sortedByContinent","sortedList","split","continent","shift","regions","getReadableTimezoneName","cities","additionalTimezone","sort","TimezoneService","parseICSAndGetAllOccurrencesBetween","icsParser","objectIterator","vObjectIterator","firstVObject","createEvent","calendar","createFreeBusyRequest","organizer","attendees","freeBusyComponent","clonedAttendee"],"mappings":";;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACe,MAAMA,cAAc,CAAC;AAEnC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACCC,EAAAA,WAAWA,CAACC,OAAO,GAAG,EAAE,EAAE;AACzB,IAAA,IAAIC,GAAG,CAACC,MAAM,KAAKJ,cAAc,EAAE;AAClC,MAAA,MAAM,IAAIK,SAAS,CAAC,kDAAkD,CAAC,CAAA;AACxE,KAAA;;AAEA;AACF;AACA;AACA;AACA;AACA;IACE,IAAI,CAACC,QAAQ,GAAGC,MAAM,CAACC,MAAM,CAAC,EAAE,EAAEN,OAAO,CAAC,CAAA;;AAE1C;AACF;AACA;AACA;AACA;AACA;IACE,IAAI,CAACO,KAAK,GAAG,IAAI,CAAA;;AAEjB;AACF;AACA;AACA;AACA;AACA;IACE,IAAI,CAACC,MAAM,GAAG,IAAI,CAAA;;AAElB;AACF;AACA;AACA;AACA;AACA;IACE,IAAI,CAACC,UAAU,GAAG,IAAI,CAAA;;AAEtB;AACF;AACA;AACA;AACA;AACA;IACE,IAAI,CAACC,gBAAgB,GAAG,IAAI,CAAA;;AAE5B;AACF;AACA;AACA;AACA;AACA;IACE,IAAI,CAACC,iBAAiB,GAAG,IAAI,CAAA;;AAE7B;AACF;AACA;AACA;AACA;AACA;IACE,IAAI,CAACC,OAAO,GAAG,EAAE,CAAA;AAClB,GAAA;;AAEA;AACD;AACA;AACA;AACA;AACCC,EAAAA,OAAOA,GAAG;IACT,OAAO,IAAI,CAACN,KAAK,CAAA;AAClB,GAAA;;AAEA;AACD;AACA;AACA;AACA;AACCO,EAAAA,QAAQA,GAAG;IACV,OAAO,IAAI,CAACN,MAAM,CAAA;AACnB,GAAA;;AAEA;AACD;AACA;AACA;AACA;AACCO,EAAAA,gBAAgBA,GAAG;AAClB,IAAA,OAAO,IAAI,CAACN,UAAU,KAAK,IAAI,CAAA;AAChC,GAAA;;AAEA;AACD;AACA;AACA;AACA;A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AAG,IAAI,CAAA;AACrB,KAAA;;AAEA;AACF;AACA;AACA;AACA;AACA;AACEI,IAAAA,OAAOA,GAAG;AACT,MAAA,IAAI,CAAC,IAAI,CAACJ,QAAQ,EAAE;QACnB,MAAM,IAAIL,2BAA2B,EAAE,CAAA;AACxC,OAAA;AACD,KAAA;;AAEA;AACF;AACA;AACA;AACA;AACA;AACEU,IAAAA,cAAcA,GAAG;MAChB,IAAI,CAACD,OAAO,EAAE,CAAA;AACf,KAAA;GAEA,CAAA;AACF;;ACnGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEe,MAAME,mBAAmB,SAASV,KAAK,CAAC;;ACtBvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACO,SAASW,EAAEA,CAACC,GAAG,EAAE;AACvB,EAAA,OAAOA,GAAG,CAACC,WAAW,EAAE,CAAA;AACzB,CAAA;;AAaA;AACA;AACA;AACA;AACA;AACA;AACO,SAASC,EAAEA,CAACF,GAAG,EAAE;AACvB,EAAA,OAAOA,GAAG,CAACG,WAAW,EAAE,CAAA;AACzB,CAAA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACO,SAASC,OAAOA,CAACJ,GAAG,EAAE;AAC5B,EAAA,OAAOA,GAAG,CAACK,MAAM,CAAC,CAAC,CAAC,CAACF,WAAW,EAAE,GAAGH,GAAG,CAACtB,KAAK,CAAC,CAAC,CAAC,CAAA;AAClD,CAAA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO,SAAS4B,eAAeA,CAACN,GAAG,EAAEO,SAAS,EAAE;AAC/C,EAAA,IAAI,CAACP,GAAG,CAACQ,UAAU,CAACD,SAAS,CAAC,EAAE;IAC/BP,GAAG,GAAGO,SAAS,GAAGP,GAAG,CAAA;AACtB,GAAA;AAEA,EAAA,OAAOA,GAAG,CAAA;AACX;;AC7EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAMS,aAAa,GAAG,IAAIC,GAAG,EAAE,CAAA;;AAE/B;AACA;AACA;AACA;AACA;AACA;AACO,SAASC,SAASA,CAACC,GAAG,EAAEC,KAAK,EAAE;AACrCJ,EAAAA,aAAa,CAACK,GAAG,CAACF,GAAG,EAAEC,KAAK,CAAC,CAAA;AAC9B,CAAA;;AAYA;AACA;AACA;AACA;AACA;AACA;AACA;AACO,SAASE,SAASA,CAACH,GAAG,EAAE9B,YAAY,EAAE;AAC5C,EAAA,OAAO2B,aAAa,CAACO,GAAG,CAACJ,GAAG,CAAC,IAAI9B,YAAY,CAAA;AAC9C;;ACxDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAMA;AACA;AACA;AACA;AACA;AACA;AACO,SAASmC,eAAeA,CAACC,aAAa,EAAE;EAC9C,OAAO,IAAIC,IAAI,CAACC,SAAS,CAACrB,EAAE,CAACmB,aAAa,CAAC,CAAC,CAAA;AAC7C,CAAA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACO,SAASG,cAAcA,CAACC,YAAY,EAAE;EAC5C,OAAO,IAAIH,IAAI,CAACI,QAAQ,CAACxB,EAAE,CAACuB,YAAY,CAAC,CAAC,CAAA;AAC3C;;AC5CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACe,SAASE,aAAaA,CAAClC,SAAS,EAAE;AAEhD;AACD;AACA;EACC,OAAO,cAAcA,SAAS,CAAC;AAE9B;AACF;AACA;AACA;AACA;IACE7C,WAAWA,CAAC,GAAG8C,IAAI,EAAE;MACpB,KAAK,CAAC,GAAGA,IAAI,CAAC,CAAA;;AAEd;AACH;AACA;AACA;AACA;AACA;MACG,IAAI,CAACkC,YAAY,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N,CAAA;AACF,GAAA;AAEA,EAAA,OAAOK,MAAM,CAACC,MAAM,CAAC,EAAE,EAAE;IACxB8Z,aAAa,EAAE,GAAG,GAAG5W,EAAE,CAACxD,OAAO,CAACmC,IAAI,CAAC;AACrCsY,IAAAA,UAAU,EAAEza,OAAO,CAACmC,IAAI,GAAG,GAAA;GAC3B,EAAEnC,OAAO,CAAC,CAAA;AACZ;;AC9yBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACO,SAAS8a,WAAWA,GAAG;EAC7B,OAAO,IAAIC,IAAI,EAAE,CAAA;AAClB;;AC7BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEe,MAAMC,4BAA4B,SAAStY,KAAK,CAAC;;ACtBhE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AASA;AACA;AACA;AACA;AACA;AACA;AACe,MAAMuY,iBAAiB,CAAC;AAEtC;AACD;AACA;AACA;AACA;EACClb,WAAWA,CAACmb,UAAU,EAAE;AAEvB;AACF;AACA;AACA;AACA;IACE,IAAI,CAACC,WAAW,GAAGD,UAAU,CAAA;;AAE7B;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACE,IAAA,IAAI,CAACE,yBAAyB,GAAG,IAAIpX,GAAG,EAAE,CAAA;;AAE1C;AACF;AACA;AACA;AACA;AACA;IACE,IAAI,CAACqX,mCAAmC,GAAG,EAAE,CAAA;;AAE7C;AACF;AACA;AACA;AACA;AACA;AACE,IAAA,IAAI,CAACC,uCAAuC,GAAG,IAAItX,GAAG,EAAE,CAAA;;AAExD;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACE,IAAA,IAAI,CAACuX,8BAA8B,GAAG,IAAIvX,GAAG,EAAE,CAAA;AAChD,GAAA;;A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AAC,CAAA;AAC3F,IAAA,IAAI,CAACyB,mBAAmB,CAAC,SAAS,CAAC,CAAA;AACnC,IAAA,IAAI,CAACR,WAAW,CAACqK,eAAe,CAAC,CAAA;AAClC,GAAA;AAED,CAAA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA/I,iCAAiC,CAAC0I,cAAc,CAACrgB,SAAS,EAAE,QAAQ,CAAC,CAAA;;AAErE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA2X,iCAAiC,CAAC0I,cAAc,CAACrgB,SAAS,EAAE,aAAa,CAAC,CAAA;;AAE1E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA2X,iCAAiC,CAAC0I,cAAc,CAACrgB,SAAS,EAAE,SAAS,CAAC,CAAA;;AAEtE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA2X,iCAAiC,CAAC0I,cAAc,CAACrgB,SAAS,EAAE,UAAU,CAAC,CAAA;;AAEvE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA2X,iCAAiC,CAAC0I,cAAc,CAACrgB,SAAS,EAAE,QAAQ,CAAC,CAAA;;AAErE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA2X,iCAAiC,CAAC0I,cAAc,CAACrgB,SAAS,EAAE;AAC3DF,EAAAA,IAAI,EAAE,YAAY;AAClBiY,EAAAA,aAAa,EAAE,QAAA;AAChB,CAAC,CAAC,CAAA;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACAG,mCAAmC,CAACmI,cAAc,CAACrgB,SAAS,EAAE,UAAU,CAAC;;AC7MzE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO,SAAS4gB,gCAA8BA,CAACC,QAAQ,EAAE;EACxD,QAAQ1f,EAAE,CAAC0f,QAAQ,CAAC;AACpB,IAAA,KAAK,QAAQ;AACZ,MAAA,OAAOR,cAAc,CAAA;AAEtB,IAAA;AACC,MAAA,OAAO9K,iBAAiB,CAAA;AACzB,GAAA;AACD;;ACzCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AA0BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACe,MAAMuL,0BAA0B,SAASvL,iBAAiB,CAAC;AAEzE;AACD;AACA;EACC7X,WAAWA,CAAC,GAAG8C,IAAI,EAAE;IACpB,KAAK,CAAC,GAAGA,IAAI,CAAC,CAAA;;AAEd;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;IACE,IAAI,CAACugB,YAAY,GAAG,IAAI,CAAA;;AAExB;AACF;AACA;AACA;AACA;AACA;AACA;IACE,IAAI,CAACC,qBAAqB,GAAG,KAAK,CAAA;;AAElC;AACF;AACA;AACA;AACA;AACA;AACA;IACE,IAAI,CAACC,qBAAqB,GAAG,IAAI,CAAA;;AAEjC;AACF;AACA;AACA;AACA;AACA;AACA;AACA;IACE,IAAI,CAACC,kBAAkB,GAAG,IAAI,CAAA;;AAE9B;AACF;AACA;AACA;AACA;AACA;AACA;AACA;IACE,IAAI,CAACC,MAAM,GAAG,KAAK,CAAA;;AAEnB;AACF;AACA;AACA;AACA;AACA;AACA;AACA;IACE,IAAI,CAACC,kBAAkB,GAAG,KAAK,CAAA;;AAE/B;AACF;AACA;AACA;AACA;AACA;IACE,IAAI,CAACC,SAAS,GAAG,IAAI,CAAA;AACtB,GAAA;;AAEA;AACD;AACA;AACA;AACA;EACC,IAAIC,WAAWA,GAAG;IACjB,OAAO,IAAI,CAACP,YAAY,CAAA;AACzB,GAAA;;AAEA;AACD;AACA;AACA;AAC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CxBL,EAAAA,aAAa,EAAE,YAAA;AAChB,CAAC,CAAC,CAAA;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACAG,mCAAmC,CAAC4I,0BAA0B,CAAC9gB,SAAS,EAAE;AACzEF,EAAAA,IAAI,EAAE,UAAA;AACP,CAAC,CAAC,CAAA;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACAoY,mCAAmC,CAAC4I,0BAA0B,CAAC9gB,SAAS,EAAE;AACzEF,EAAAA,IAAI,EAAE,YAAY;AAClBiY,EAAAA,aAAa,EAAE,QAAA;AAChB,CAAC,CAAC,CAAA;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACAG,mCAAmC,CAAC4I,0BAA0B,CAAC9gB,SAAS,EAAE;AACzEF,EAAAA,IAAI,EAAE,UAAU;AAChBiY,EAAAA,aAAa,EAAE,YAAA;AAChB,CAAC,CAAC,CAAA;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACAG,mCAAmC,CAAC4I,0BAA0B,CAAC9gB,SAAS,EAAE,SAAS,CAAC,CAAA;;AAEpF;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACAkY,mCAAmC,CAAC4I,0BAA0B,CAAC9gB,SAAS,EAAE,SAAS,CAAC,CAAA;;AAEpF;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACAkY,mCAAmC,CAAC4I,0BAA0B,CAAC9gB,SAAS,EAAE,OAAO,CAAC,CAAA;;AAElF;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACAkY,mCAAmC,CAAC4I,0BAA0B,CAAC9gB,SAAS,EAAE;AACzEF,EAAAA,IAAI,EAAE,eAAe;AACrBsY,EAAAA,UAAU,EAAE,eAAe;AAC3BL,EAAAA,aAAa,EAAE,gBAAA;AAChB,CAAC,CAAC,CAAA;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACAQ,kBAAkB,CAACuI,0BAA0B,CAAC9gB,SAAS,EAAE,OAAO,CAAC;;ACx8CjE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO,SAAS8kB,sBAAsBA,CAACC,cAAc,EAAE;AACtD,EAAA,OAAOA,cAAc,CAAC7O,0BAA0B,CAAC,2BAA2B,CAAC,CAAA;AAC9E,CAAA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACO,SAAS8O,kBAAkBA,CAACD,cAAc,EAAE;AAClD,EAAA,MAAME,YAAY,GAAGH,sBAAsB,CAACC,cAAc,CAAC,CAAA;AAC3D,EAAA,QAAQE,YAAY;AACpB,IAAA,KAAK,MAAM;AACV,MAAA,OAAO,IAAI,CAAA;AAEZ,IAAA,KAAK,WAAW;AACf,MAAA,OAAO,IAAI,CAAA;AAEZ,IAAA,KAAK,a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AU,CAAC,CAAA;;AAEvE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA2X,iCAAiC,CAAC0N,cAAc,CAACrlB,SAAS,EAAE;AAC3DF,EAAAA,IAAI,EAAE,UAAU;EAChBkY,aAAa,EAAE9Y,KAAK,CAAC,CAAC,CAAC,CAACoO,IAAI,EAAE;AAC9BvN,EAAAA,YAAY,EAAE,CAAC;AACfkY,EAAAA,YAAY,EAAE,CAAA;AACf,CAAC,CAAC,CAAA;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACAI,gDAAgD,CAACgN,cAAc,CAACrlB,SAAS,EAAE;AAC1EF,EAAAA,IAAI,EAAE,UAAU;AAChBiY,EAAAA,aAAa,EAAE,WAAA;AAChB,CAAC,CAAC,CAAA;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACAG,mCAAmC,CAACmN,cAAc,CAACrlB,SAAS,EAAE,YAAY,CAAC;;ACxc3E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAQA;AACA;AACA;AACA;AACA;AACA;AACe,MAAM0mB,iBAAiB,SAASnR,iBAAiB,CAAC;AAEhE;AACD;AACA;AACA;AACA;EACC,IAAI2E,SAASA,GAAG;AACf,IAAA,OAAO,IAAI,CAAChE,0BAA0B,CAAC,SAAS,CAAC,CAAA;AAClD,GAAA;;AAEA;AACD;AACA;AACA;AACA;EACC,IAAIgE,SAASA,CAACA,SAAS,EAAE;IACxB,IAAI,CAACrZ,OAAO,EAAE,CAAA;AACd,IAAA,IAAI,CAACsV,uBAAuB,CAAC,SAAS,EAAE+D,SAAS,CAAC5S,aAAa,CAACM,QAAQ,CAACsY,GAAG,CAAC,CAAC,CAAA;AAC/E,GAAA;;AAEA;AACD;AACA;AACA;AACA;EACC,IAAIxC,OAAOA,GAAG;AACb,IAAA,OAAO,IAAI,CAACxH,0BAA0B,CAAC,OAAO,CAAC,CAAA;AAChD,GAAA;;AAEA;AACD;AACA;AACA;AACA;EACC,IAAIwH,OAAOA,CAACA,OAAO,EAAE;IACpB,IAAI,CAAC7c,OAAO,EAAE,CAAA;AACd,IAAA,IAAI,CAACsV,uBAAuB,CAAC,OAAO,EAAEuH,OAAO,CAACpW,aAAa,CAACM,QAAQ,CAACsY,GAAG,CAAC,CAAC,CAAA;AAC3E,GAAA;;AAEA;AACD;AACA;EACC,CAAEyG,mBAAmBA,GAAG;AACvB,IAAA,OAAQ,IAAI,CAAC7Q,mBAAmB,CAAC,UAAU,CAAC,CAAA;AAC7C,GAAA;;AAEA;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACCwK,EAAAA,2BAA2BA,CAACxgB,IAAI,EAAEkP,KAAK,EAAE;IACxC,IAAI,CAACnO,OAAO,EAAE,CAAA;IACd,IAAI,CAACwV,WAAW,CAACjI,gBAAgB,CAACgB,gBAAgB,CAACtP,IAAI,EAAEkP,KAAK,CAAC,CAAC,CAAA;AACjE,GAAA;;AAEA;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACCyU,EAAAA,4BAA4BA,CAAC3jB,IAAI,EAAEkP,KAAK,EAAE;IACzC,IAAI,CAACnO,OAAO,EAAE,CAAA;AACd,IAAA,IAAI,CAACgW,mBAAmB,CAAC,WAAW,CAAC,CAAA;AACrC,IAAA,IAAI,CAACR,WAAW,CAACjI,gBAAgB,CAACgB,gBAAgB,CAACtP,IAAI,EAAEkP,KAAK,EAAE,IAAI,CAAC,CAAC,CAAA;AACvE,GAAA;AAED,CAAA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA2I,iCAAiC,CAAC+O,iBAAiB,CAAC1mB,SAAS,EAAE,WAAW,CAAC,CAAA;;AAE3E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA2X,iCAAiC,CAAC+O,iBAAiB,CAAC1mB,SAAS,EAAE,KAAK,CAAC,CAAA;;AAErE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACAkY,mCAAmC,CAACwO,iBAAiB,CAAC1mB,SAAS,EAAE,UAAU,CAAC;;ACxK5E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAKA;AACA;AACA;AACA;AACA;AACA;AACe,MAAM4mB,gBAAgB,SAAS9F,0BAA0B,CAAC;AAExE;AACD;AACA;AACA;AACA;AACA;AACA;EACC+F,cAAcA,CAACC,WAAW,EAAE;IAC3B,IAAI,CAACzQ,WAAW,CAAC,IAAI3B,YAAY,CAAC,aAAa,EAAEoS,WAAW,CAAC,CAAC,CAAA;AAC/D,GAAA;AAED,CAAA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA5O,mCAAmC,CAAC0O,gBAAgB,CAAC5mB,SAAS,EAAE,aAAa,CAAC;;ACpF9E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACe,MAAM+mB,iBAAiB,SAASxR,iBAAiB,CAAC;AAEhE;AACD;AACA;AACA;AACA;AACCyR,EAAAA,UAAUA,GAAG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,EAAAA,IAAI,EAAE,UAAU;AAChBkY,EAAAA,aAAa,EAAE9Y,KAAK,CAACC,IAAI,CAACD,KAAK,CAAC,EAAE,CAAC,CAACoO,IAAI,EAAE,CAAC;AAC3CvN,EAAAA,YAAY,EAAE,CAAC;AACfkY,EAAAA,YAAY,EAAE,CAAA;AACf,CAAC,CAAC,CAAA;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACAI,gDAAgD,CAAC4O,aAAa,CAACjnB,SAAS,EAAE;AACzEF,EAAAA,IAAI,EAAE,UAAU;AAChBiY,EAAAA,aAAa,EAAE,WAAA;AAChB,CAAC,CAAC,CAAA;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACAG,mCAAmC,CAAC+O,aAAa,CAACjnB,SAAS,EAAE,YAAY,CAAC;;ACzY1E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AASA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO,SAAS4gB,8BAA8BA,CAACC,QAAQ,EAAE;EACxD,QAAQ1f,EAAE,CAAC0f,QAAQ,CAAC;AACpB,IAAA,KAAK,QAAQ;AACZ,MAAA,OAAOwE,cAAc,CAAA;AAEtB,IAAA,KAAK,WAAW;AACf,MAAA,OAAOqB,iBAAiB,CAAA;AAEzB,IAAA,KAAK,UAAU;AACd,MAAA,OAAOE,gBAAgB,CAAA;AAExB,IAAA,KAAK,WAAW;AACf,MAAA,OAAOG,iBAAiB,CAAA;AAEzB,IAAA,KAAK,OAAO;AACX,MAAA,OAAOE,aAAa,CAAA;AAErB,IAAA;AACC,MAAA,OAAO1R,iBAAiB,CAAA;AACzB,GAAA;AACD;;ACzDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAQA;AACA;AACA;AACA;AACA;AACe,MAAM+R,iBAAiB,SAAS/R,iBAAiB,CAAC;AAEhE;AACD;AACA;AACA;AACA;AACC7X,EAAAA,WAAWA,CAACoC,IAAI,GAAG,WAAW,EAAE0V,UAAU,GAAG,EAAE,EAAEC,UAAU,GAAG,EAAE,EAAE;AACjE,IAAA,KAAK,CAAC3V,IAAI,EAAE0V,UAAU,EAAEC,UAAU,CAAC,CAAA;IACnC,IAAI,CAAChK,IAAI,GAAG,IAAI,CAAA;IAChB,IAAI,CAACC,MAAM,GAAG,IAAI,CAAA;AACnB,GAAA;;AAEA;AACD;AACA;EACC,CAAE6b,mBAAmBA,GAAG;AACvB,IAAA,OAAQ,IAAI,CAACvR,oBAAoB,CAAC,WAAW,CAAC,CAAA;AAC/C,GAAA;;AAEA;AACD;AACA;EACC,CAAEwR,kBAAkBA,GAAG;AACtB,IAAA,OAAQ,IAAI,CAACC,gBAAgB,EAAE,CAAA;AAC/B,IAAA,OAAQ,IAAI,CAACC,kBAAkB,EAAE,CAAA;AACjC,IAAA,OAAQ,IAAI,CAACC,eAAe,EAAE,CAAA;AAC/B,GAAA;;AAEA;AACD;AACA;EACC,CAAEF,gBAAgBA,GAAG;AACpB,IAAA,OAAQ,IAAI,CAACzR,oBAAoB,CAAC,QAAQ,CAAC,CAAA;AAC5C,GAAA;;AAEA;AACD;AACA;EACC,CAAE4R,mBAAmBA,GAAG;AACvB,IAAA,OAAQ,IAAI,CAAC5R,oBAAoB,CAAC,WAAW,CAAC,CAAA;AAC/C,GAAA;;AAEA;AACD;AACA;EACC,CAAE0R,kBAAkBA,GAAG;AACtB,IAAA,OAAQ,IAAI,CAAC1R,oBAAoB,CAAC,UAAU,CAAC,CAAA;AAC9C,GAAA;;AAEA;AACD;AACA;EACC,CAAE2R,eAAeA,GAAG;AACnB,IAAA,OAAQ,IAAI,CAAC3R,oBAAoB,CAAC,OAAO,CAAC,CAAA;AAC3C,GAAA;;AAEA;AACD;AACA;EACC,OAAOuB,+BAA+BA,CAACpV,aAAa,EAAE;IACrD,OAAOye,8BAA8B,CAACze,aAAa,CAAC,CAAA;AACrD,GAAA;;AAEA;AACD;AACA;AACA;AACA;AACA;AACCqkB,EAAAA,KAAKA,CAACqB,gBAAgB,GAAG,IAAI,EAAE;IAC9B,KAAK,MAAMC,OAAO,IAAI,IAAI,CAACN,kBAAkB,EAAE,EAAE;MAChDM,OAAO,CAAClD,SAAS,EAAE,CAAA;AACpB,KAAA;AAEA,IAAA,MAAMmD,QAAQ,GAAG,IAAI,CAAC/jB,QAAQ,EAAE,CAAA;AAChC,IAAA,IAAI6jB,gBAAgB,EAAE;AACrBzlB,MAAAA,IAAI,CAACsX,OAAO,CAACsO,eAAe,CAACD,QAAQ,CAAC,CAAA;AACvC,KAAA;AACA,IAAA,OAAOA,QAAQ,CAACjW,QAAQ,EAAE,CAAA;AAC3B,GAAA;;AAEA;AACD;AACA;AACA;AACA;AACA;AACC,EAAA,OAAOiR,SAASA,CAACkF,eAAe,GAAG,EAAE,EAAE;AACtC,IAAA,OAAO,IAAI,IAAI,CAAC,WAAW,EAAE,CAC5B,CAAC,QAAQ,EAAEjmB,SAAS,CAAC,QAAQ,EAAE,wCAAwC,CAAC,CAAC,EACzE,CAAC,UAAU,EAAE,WAAW,CAAC,EACzB,CAAC,SAAS,EAAE,KAAK,CAAC,CAClB,CAACkmB,MAAM,CAACD,eAAe,CAAC,CAAC,CAAA;AAC3B,GAAA;;AAEA;AACD;AACA;AACA;AACA;AACA;EACC,OAAOE,UAAUA,CAACC,MAAM,EAAE;IACzB,OAAO,IAAI,CAACrF,SAAS,CAAC,CAAC,CAAC,QAAQ,EAAEqF,MAAM,CAAC,CAAC,CAAC,CAAA;AAC5C,GAAA;;AAEA;AACD;AACA;EACC,OAAO7jB,UAAUA,CAACT,SAAS,EAAE;AAC5B,IAAA,MAAM2T,IAAI,GAAG,KAAK,CAAClT,UAAU,CAACT,SAAS,CAAC,CAAA;IACxC2T,IAAI,CAAChM,IAAI,GAAGgM,IAAI,CAAA;AAEhB,IAAA,OAAOA,IAAI,CAAA;AACZ,GAAA;AAED,CAAA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACAE,iCAAiC,CAAC2P,iBAAiB,CAACtnB,SAAS,EAAE;AAC9DF,EAAAA,IAAI,EAAE,WAAW;AACjBiY,EAAAA,aAAa,EAAE,QAAA;AAChB,CAAC,CAAC,CAAA;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEAJ,iCAAiC,CAAC2P,iBAAiB,CAACtnB,SAAS,EAAE;AAC9DF,EAAAA,IAAI,EAAE,SAAA;AACP,CAAC,CAAC,CAAA;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA6X,iCAAiC,CAAC2P,iBAAiB,CAACtnB,SAAS,EAAE;AAC9DF,EAAAA,IAAI,EAAE,eAAe;AACrBiY,EAAAA,aAAa,EAAE,UAAU;AACzBhY,EAAAA,YAAY,EAAE,WAAA;AACf,CAAC,CAAC,CAAA;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA4X,iCAAiC,CAAC2P,iBAAiB,CAACtnB,SAAS,EAAE;AAC9DF,EAAAA,IAAI,EAAE,QAAA;AACP,CAAC,CAAC;;AClNF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACe,MAAMuoB,kBAAkB,CAAC;AAEvC;AACD;AACA;AACC3qB,EAAAA,WAAWA,GAAG;AACb,IAAA,IAAIE,GAAG,CAACC,MAAM,KAAKwqB,kBAAkB,EAAE;AACtC,MAAA,MAAM,IAAIvqB,SAAS,CAAC,sDAAsD,CAAC,CAAA;AAC5E,KAAA;AACD,GAAA;;AAEA;AACD;AACA;EACCwqB,MAAMA,CAACC,KAAK,EAAE;AACb,IAAA,MAAM,IAAIzqB,SAAS,CAAC,6CAA6C,CAAC,CAAA;AACnE,GAAA;;AAEA;AACD;AACA;EACC,OAAO0qB,QAAQA,GAAG;AACjB,IAAA,OAAO,CAAC,CAAA;AACT,GAAA;AAED;;ACnDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAIA;AACA;AACA;AACe,MAAMC,gCAAgC,SAASJ,kBAAkB,CAAC;AAEhF;AACD;AACA;AACA;AACA;EACCC,MAAMA,CAAChJ,GAAG,EAAE;AACX,IAAA,OAAOA,GAAG,CACRoJ,OAAO,CAAC,yHAAyH,EAAE,CAACC,KAAK,EAAEC,WAAW,EAAEC,YAAY,KAAK;AACzK,MAAA,OAAO,QAAQ,GAAGD,WAAW,GAAG,MAAM,GACnC,MAAM,GAAG/F,EAAI,EAAE,GACfgG,YAAY,GACZ,MAAM,GAAGD,WAAW,GAAG,MAAM,CAAA;AACjC,KAAC,CAAC,CAAA;AACJ,GAAA;AAED;;AC5CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAGA;AACA;AACA;AACe,MAAME,iDAAiD,SAAST,kBAAkB,CAAC;AAEjG;AACD;AACA;AACA;AACA;EACCC,MAAMA,CAAChJ,GAAG,EAAE;AACX,IAAA,OAAOA,GAAG,CACRoJ,OAAO,CAAC,yCAAyC,EAAE,CAACC,KAAK,EAAErT,QAAQ,EAAE9J,UAAU,EAAEud,IAAI,KAAK;AAC1F,MAAA,OAAOzT,QAAQ,GAAG,cAAc,GAAGyT,IAAI,CAAA;AACxC,KAAC,CAAC,CAAA;AACJ,GAAA;AAED;;ACxCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAGA;AACA;AACA;AACe,MAAMC,sCAAsC,SAASX,kBAAkB,CAAC;AAEtF;AACD;AACA;AACA;AACA;EACCC,MAAMA,CAAChJ,GAAG,EAAE;AACX,IAAA,OAAOA,GAAG,CACRoJ,OAAO,CAAC,2DAA2D,EAAE,CAACC,KAAK,EAAErT,QAAQ,EAAE9J,UAAU,EAAEyd,CAAC,EAAEF,IAAI,KAAK;AAC/G,MAAA,OAAOzT,QAAQ,GAAG9J,UAAU,GAAG,cAAc,GAAGud,IAAI,CAAA;AACrD,KAAC,CAAC,CAAA;AACJ,GAAA;AAED;;ACxCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAGA;AACA;AACA;AACA;AACe,MAAMG,+BAA+B,SAASb,kBAAkB,CAAC;AAE/E;AACD;AACA;AACA;AACA;EACCC,MAAMA,CAAChJ,GAAG,EAAE;AACX,IAAA,OAAOA,GAAG,CACRoJ,OAAO,CAAC,eAAe,EAAE,aAAa,CAAC,CACvCA,OAAO,CAAC,gBAAgB,EAAE,aAAa,CAAC,CAAA;AAC3C,GAAA;AAED;;ACxCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGe,MAAMS,iCAAiC,SAASd,kBAAkB,CAAC;AAEjF;AACD;AACA;AACA;AACA;EACCC,MAAMA,CAAChJ,GAAG,EAAE;AACX,IAAA,OAAOA,GAAG,CACRoJ,OAAO,CAAC,8BAA8B,EAAE,0BAA0B,CAAC,CAAA;AACtE,GAAA;AAED;;ACnCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAIA;AACA;AACA;AACA;AACe,MAAMU,0CAA0C,SAASf,kBAAkB,CAAC;AAE1F;AACD;AACA;AACA;AACA;EACCC,MAAMA,CAAChJ,GAAG,EAAE;IACX,IAAI+J,cAAc,GAAG,KAAK,CAAA;IAC1B,IAAIC,eAAe,GAAG,KAAK,CAAA;IAC3B,IAAIC,gBAAgB,GAAG,KAAK,CAAA;AAC5B,IAAA,MAAMC,iBAAiB,GAAG,IAAIC,GAAG,EAAE,CAAA;AAEnC,IAAA,OAAOnK,GAAG,CACRoJ,OAAO,CAAC,4DAA4D,EAAE,EAAE,CAAC,CACzEA,OAAO,CAAC,mBAAmB,EAAGC,KAAK,IAAK;AACxC,MAAA,IAAIU,cAAc,EAAE;AACnB,QAAA,OAAO,EAAE,CAAA;AACV,OAAA;AAEAA,MAAAA,cAAc,GAAG,IAAI,CAAA;AACrB,MAAA,OAAOV,KAAK,CAAA;AACb,KAAC,CAAC,CACDD,OAAO,CAAC,oBAAoB,EAAGC,KAAK,IAAK;AACzC,MAAA,IAAIW,eAAe,EAAE;AACpB,QAAA,OAAO,EAAE,CAAA;AACV,OAAA;AAEAA,MAAAA,eAAe,GAAG,IAAI,CAAA;AACtB,MAAA,OAAOX,KAAK,CAAA;AACb,KAAC,CAAC,CACDD,OAAO,CAAC,qBAAqB,EAAGC,KAAK,IAAK;AAC1C,MAAA,IAAIY,gBAAgB,EAAE;AACrB,QAAA,OAAO,EAAE,CAAA;AACV,OAAA;AAEAA,MAAAA,gBAAgB,GAAG,IAAI,CAAA;AACvB,MAAA,OAAOZ,KAAK,CAAA;AACb,KAAC,CAAC,CACDD,OAAO,CAAC,oEAAoE,EAAGC,KAAK,IAAK;AACzF,MAAA,MAAMe,WAAW,GAAGf,KAAK,CAACA,KAAK,CAAC,eAAe,CAAC,CAAA;;AAEhD;AACA;MACA,IAAIe,WAAW,KAAK,IAAI,EAAE;AACzB,QAAA,OAAO,EAAE,CAAA;AACV,OAAA;AAEA,MAAA,MAAMpjB,IAAI,GAAGnF,EAAE,CAACuoB,WAAW,CAAC,CAAC,CAAC,CAAC/pB,KAAK,CAAC,CAAC,CAAC,CAAC,CAAA;AACxC,MAAA,IAAI6pB,iBAAiB,CAAC/c,GAAG,CAACnG,IAAI,CAAC,EAAE;AAChC;AACA,QAAA,OAAO,EAAE,CAAA;AACV,OAAA;AAEAkjB,MAAAA,iBAAiB,CAACG,GAAG,CAACrjB,IAAI,CAAC,CAAA;AAC3B,MAAA,OAAOqiB,KAAK,CAAA;AACb,KAAC,CAAC,CAAA;AACJ,GAAA;AAED;;ACvFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAGA;AACA;AACA;AACA;AACe,MAAMiB,mCAAmC,SAASvB,kBAAkB,CAAC;AAEnF;AACD;AACA;AACA;AACA;EACCC,MAAMA,CAAChJ,GAAG,EAAE;AACX,IAAA,OAAOA,GAAG,CACRoJ,OAAO,CAAC,mCAAmC,EAAE,MAAM,CAAC,CAAA;AACvD,GAAA;AAED;;ACvCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AASA;AACA;AACA;AACO,UAAWmB,cAAcA,GAAG;AAClC,EAAA,MAAMpB,gCAAgC,CAAA;AACtC,EAAA,MAAMK,iDAAiD,CAAA;AACvD,EAAA,MAAME,sCAAsC,CAAA;AAC5C,EAAA,MAAME,+BAA+B,CAAA;AACrC,EAAA,MAAMC,iCAAiC,CAAA;AACvC,EAAA,MAAMC,0CAA0C,CAAA;AAChD,EAAA,MAAMQ,mCAAmC,CAAA;AAC1C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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"}